module.exports=[282287,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(928503),e=a.i(539524);a.i(501786);var f=a.i(58812),g=a.i(757215),h=a.i(184394),i=a.i(144351),j=a.i(478788),k=a.i(452308),l=a.i(613749),m=a.i(50522);let n=(0,a.i(170106).default)("folder-kanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]]);var o=a.i(452495),p=a.i(915618),q=a.i(296101),r=a.i(781560),s=a.i(741616),t=a.i(957064),u=a.i(50944);a.i(511241);var v=a.i(296373),w=a.i(130487),x=a.i(564361),y=a.i(272266),z=a.i(892984),A=a.i(700760);let B=a=>{switch(a){case"completed":return"default";case"in-progress":return"secondary";case"cancelled":return"destructive";default:return"outline"}},C=[{id:"planned",name:"Planned",description:"Projects queued up"},{id:"in-progress",name:"In Progress",description:"Currently active work"},{id:"completed",name:"Completed",description:"Recently wrapped up"},{id:"cancelled",name:"Cancelled",description:"Parked or cancelled"}],D=a=>{switch(a){case"in-progress":return"In Progress";case"completed":return"Completed";case"cancelled":return"Cancelled";case"planned":return"Planned";default:return a}},E=a=>a?new Date(a).toLocaleDateString():"Not set",F=(a,c)=>[{accessorKey:"title",header:"Project",cell:({row:a})=>(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium text-foreground",children:a.original.title}),(0,b.jsxs)("span",{className:"text-muted-foreground text-xs",children:["Client: ",a.original.client?.companyName||"Unknown Client"]})]})},{accessorKey:"projectType",header:"Type",cell:({row:a})=>(0,b.jsx)("span",{className:"text-foreground capitalize",children:a.original.projectType})},{accessorKey:"status",header:"Status",cell:({row:a})=>(0,b.jsx)(f.StyledBadge,{variant:B(a.original.status),children:D(a.original.status)})},{accessorKey:"startDate",header:"Start Date",cell:({row:a})=>{let c=a.original.startDate;if(!c)return(0,b.jsx)("span",{className:"text-muted-foreground",children:"Not set"});let d=new Date(c);return(0,b.jsx)("span",{className:"text-foreground",children:d.toLocaleDateString()})}},{accessorKey:"_creationTime",header:"Created",cell:({row:a})=>{let c=new Date(a.original._creationTime);return(0,b.jsx)("span",{className:"text-foreground",children:c.toLocaleDateString()})}},{id:"actions",header:"",cell:({row:d})=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Button,{intent:"outline",size:"sq-sm",onPress:()=>a.push(`/projects/${d.original._id}`),"aria-label":`View project ${d.original.title}`,children:(0,b.jsx)(o.ExternalLink,{className:"size-4"})}),(0,b.jsx)(e.Button,{intent:"outline",size:"sq-sm",onPress:()=>c(d.original._id,d.original.title),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950","aria-label":`Delete project ${d.original.title}`,children:(0,b.jsx)(r.Trash2,{className:"size-4"})})]})}];function G(){let a=(0,u.useRouter)(),[r,G]=(0,c.useState)("table"),[H,I]=c.default.useState([]),[J,K]=c.default.useState([]),[L,M]=c.default.useState(""),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(null),R=(0,v.useMutation)(w.api.projects.remove),S=(0,v.useMutation)(w.api.projects.update),[T,U]=(0,c.useState)([]),V=(0,v.useQuery)(w.api.projects.list,{}),W=(0,v.useQuery)(w.api.clients.list,{}),X=(0,v.useQuery)(w.api.projects.getStats,{}),Y=c.default.useMemo(()=>V&&W?V.map(a=>({...a,client:W.find(b=>b._id===a.clientId)})):[],[V,W]),Z=c.default.useMemo(()=>{let a=new Map;return Y.forEach(b=>a.set(b._id,b.status)),a},[Y]);c.default.useEffect(()=>{Y&&0!==Y.length?U(Y.map(a=>({id:a._id,name:a.title,column:a.status,status:a.status,clientName:a.client?.companyName,projectType:a.projectType,startDate:a.startDate,endDate:a.endDate,projectNumber:a.projectNumber??null}))):U([])},[Y]);let $=void 0===V||void 0===W,_=!$&&0===Y.length,aa=(a,b)=>{Q({id:a,name:b}),O(!0)},ab=async()=>{if(P)try{await R({id:P.id}),O(!1),Q(null)}catch(a){console.error("Failed to delete project:",a)}},ac=(0,j.useReactTable)({data:Y,columns:F(a,aa),state:{sorting:H,columnFilters:J,globalFilter:L,pagination:{pageIndex:0,pageSize:10}},onSortingChange:I,onColumnFiltersChange:K,onGlobalFilterChange:M,globalFilterFn:(a,b,c)=>{if(!c||""===c.trim())return!0;let d=c.toLowerCase().trim(),e=a.original;return!!(e.title&&e.title.toLowerCase().includes(d)||e.projectType&&e.projectType.toLowerCase().includes(d)||e.status&&e.status.toLowerCase().includes(d)||e.client?.companyName&&e.client.companyName.toLowerCase().includes(d))},getCoreRowModel:(0,k.getCoreRowModel)(),getSortedRowModel:(0,k.getSortedRowModel)(),getFilteredRowModel:(0,k.getFilteredRowModel)(),getPaginationRowModel:(0,k.getPaginationRowModel)()});c.default.useEffect(()=>{ac.setPageSize(10)},[10,ac]);let ad=c.default.useCallback(a=>{U(a);let b=a.find(a=>{let b=Z.get(a.id);return b&&b!==a.column});b&&S({id:b.id,status:b.column}).catch(a=>{console.error("Failed to update project status:",a)})},[Z,S]);return(0,b.jsxs)("div",{className:"relative p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-1.5 h-6 bg-linear-to-b from-primary to-primary/60 rounded-full"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Projects"}),(0,b.jsx)("p",{className:"text-muted-foreground text-sm",children:"Overview of your projects"})]})]}),(0,b.jsx)(g.StyledButton,{intent:"primary",icon:(0,b.jsx)(p.Plus,{className:"h-4 w-4"}),label:"Create Project",onClick:()=>a.push("/projects/new")})]}),$?(0,b.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[void 0,void 0,void 0].map((a,c)=>(0,b.jsxs)(h.StyledCard,{children:[(0,b.jsxs)(h.StyledCardHeader,{children:[(0,b.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-24"}),(0,b.jsx)("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-32"})]}),(0,b.jsx)(h.StyledCardContent,{children:(0,b.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-16"})})]},c))}):(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)(h.StyledCard,{children:[(0,b.jsxs)(h.StyledCardHeader,{children:[(0,b.jsxs)(h.StyledCardTitle,{className:"flex items-center gap-2 text-base",children:[(0,b.jsx)(n,{className:"size-4"})," Total Projects"]}),(0,b.jsx)(h.StyledCardDescription,{children:"All projects in your workspace"})]}),(0,b.jsx)(h.StyledCardContent,{children:(0,b.jsx)("div",{className:"text-3xl font-semibold",children:X?.total||Y.length})})]}),(0,b.jsxs)(h.StyledCard,{children:[(0,b.jsxs)(h.StyledCardHeader,{children:[(0,b.jsx)(h.StyledCardTitle,{className:"text-base",children:"In Progress"}),(0,b.jsx)(h.StyledCardDescription,{children:"Currently active projects"})]}),(0,b.jsx)(h.StyledCardContent,{children:(0,b.jsx)("div",{className:"text-3xl font-semibold",children:X?.byStatus["in-progress"]||Y.filter(a=>"in-progress"===a.status).length})})]}),(0,b.jsxs)(h.StyledCard,{children:[(0,b.jsxs)(h.StyledCardHeader,{children:[(0,b.jsx)(h.StyledCardTitle,{className:"text-base",children:"Completed"}),(0,b.jsx)(h.StyledCardDescription,{children:"Finished projects"})]}),(0,b.jsx)(h.StyledCardContent,{children:(0,b.jsx)("div",{className:"text-3xl font-semibold",children:X?.byStatus.completed||Y.filter(a=>"completed"===a.status).length})})]})]}),(0,b.jsxs)(h.StyledCard,{children:[(0,b.jsxs)(h.StyledCardHeader,{className:"flex flex-col gap-3 border-b",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.StyledCardTitle,{children:"Projects"}),(0,b.jsx)(h.StyledCardDescription,{children:"Search, sort, and browse your projects"})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,b.jsx)(d.Input,{placeholder:"Search projects, clients, or status...",value:L,onChange:a=>M(a.target.value),className:"w-full md:w-96"}),(0,b.jsxs)(z.ButtonGroup,{children:[(0,b.jsxs)("button",{onClick:()=>G("table"),"aria-pressed":"table"===r,"aria-label":"Table view",className:(0,A.cn)("inline-flex items-center gap-2 font-semibold transition-all duration-200 text-xs px-3 py-1.5 ring-1 shadow-sm hover:shadow-md backdrop-blur-sm","table"===r?"text-primary hover:text-primary/80 bg-primary/10 hover:bg-primary/15 ring-primary/30 hover:ring-primary/40":"text-gray-600 hover:text-gray-700 bg-transparent hover:bg-gray-50 ring-transparent hover:ring-gray-200 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-800 dark:hover:ring-gray-700"),children:[(0,b.jsx)(s.TableProperties,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Table"})]}),(0,b.jsxs)("button",{onClick:()=>G("kanban"),"aria-pressed":"kanban"===r,"aria-label":"Kanban view",className:(0,A.cn)("inline-flex items-center gap-2 font-semibold transition-all duration-200 text-xs px-3 py-1.5 ring-1 shadow-sm hover:shadow-md backdrop-blur-sm","kanban"===r?"text-primary hover:text-primary/80 bg-primary/10 hover:bg-primary/15 ring-primary/30 hover:ring-primary/40":"text-gray-600 hover:text-gray-700 bg-transparent hover:bg-gray-50 ring-transparent hover:ring-gray-200 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-800 dark:hover:ring-gray-700"),children:[(0,b.jsx)(t.LayoutGrid,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Kanban"})]})]})]})]}),(0,b.jsx)(h.StyledCardContent,{className:"relative px-0",children:$?(0,b.jsx)("div",{className:"px-6",children:(0,b.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center space-x-4 p-4",children:[(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-2/3"}),(0,b.jsx)("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-1/2"})]}),(0,b.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-16"}),(0,b.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-20"}),(0,b.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-24"}),(0,b.jsx)("div",{className:"h-8 w-8 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"})]},c))})}):_?(0,b.jsxs)("div",{className:"px-6 py-12 text-center",children:[(0,b.jsx)("div",{className:"mx-auto w-24 h-24 mb-4 flex items-center justify-center rounded-full bg-muted",children:(0,b.jsx)(q.FolderOpen,{className:"h-12 w-12 text-muted-foreground"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No projects yet"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-6 max-w-sm mx-auto",children:"Get started by creating your first project. Projects help you organize work and track progress."}),(0,b.jsx)(g.StyledButton,{intent:"primary",icon:(0,b.jsx)(p.Plus,{className:"h-4 w-4"}),label:"Create Your First Project",onClick:()=>a.push("/projects/new")})]}):"table"===r?(0,b.jsxs)("div",{className:"px-6",children:[(0,b.jsx)("div",{className:"overflow-hidden rounded-lg border",children:(0,b.jsxs)(i.StyledTable,{children:[(0,b.jsx)(i.StyledTableHeader,{children:ac.getHeaderGroups().map(a=>(0,b.jsx)(i.StyledTableRow,{children:a.headers.map(a=>(0,b.jsx)(i.StyledTableHead,{children:a.isPlaceholder?null:(0,j.flexRender)(a.column.columnDef.header,a.getContext())},a.id))},a.id))}),(0,b.jsx)(i.StyledTableBody,{children:ac.getRowModel().rows?.length?ac.getRowModel().rows.map(a=>(0,b.jsx)(i.StyledTableRow,{"data-state":a.getIsSelected()&&"selected",children:a.getVisibleCells().map(a=>(0,b.jsx)(i.StyledTableCell,{children:(0,j.flexRender)(a.column.columnDef.cell,a.getContext())},a.id))},a.id)):(0,b.jsx)(i.StyledTableRow,{children:(0,b.jsx)(i.StyledTableCell,{colSpan:F(a,aa).length,className:"h-24 text-center",children:"No projects match your search."})})})]})}),(0,b.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,b.jsxs)("div",{className:"text-muted-foreground text-sm",children:[ac.getFilteredRowModel().rows.length," of ",Y.length," ","projects"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Button,{intent:"outline",size:"sq-sm",onPress:()=>ac.previousPage(),isDisabled:!ac.getCanPreviousPage(),"aria-label":"Previous page",children:(0,b.jsx)(l.ChevronLeft,{className:"size-4"})}),(0,b.jsxs)("div",{className:"text-sm font-medium",children:["Page ",ac.getState().pagination?.pageIndex+1," of"," ",ac.getPageCount()]}),(0,b.jsx)(e.Button,{intent:"outline",size:"sq-sm",onPress:()=>ac.nextPage(),isDisabled:!ac.getCanNextPage(),"aria-label":"Next page",children:(0,b.jsx)(m.ChevronRight,{className:"size-4"})})]})]})]}):(0,b.jsx)("div",{className:"px-2 py-6 h-[calc(100vh-28rem)]",children:(0,b.jsx)(y.KanbanProvider,{columns:C,data:T,onDataChange:ad,children:c=>{let d=T.filter(a=>a.column===c.id);return(0,b.jsxs)(y.KanbanBoard,{id:c.id,className:"bg-card/60 flex flex-col",children:[(0,b.jsxs)(y.KanbanHeader,{className:"flex items-center justify-between border-b bg-muted/30 shrink-0",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-sm text-foreground",children:c.name}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:c.description})]}),(0,b.jsx)(f.StyledBadge,{variant:"outline",children:d.length})]}),(0,b.jsx)(y.KanbanCards,{id:c.id,children:c=>(0,b.jsx)(y.KanbanCard,{id:c.id,name:c.name,column:c.column,children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-foreground",children:c.name}),(0,b.jsx)(f.StyledBadge,{variant:"outline",className:"capitalize",children:c.projectType})]}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Client: ",c.clientName||"Unknown Client"]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,b.jsxs)("span",{children:["Start: ",E(c.startDate)]}),(0,b.jsxs)("span",{children:["Due: ",E(c.endDate)]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:c.projectNumber?`Project #${c.projectNumber}`:"No project number"}),(0,b.jsx)(f.StyledBadge,{variant:B(c.column),children:D(c.column)})]}),(0,b.jsx)("div",{className:"pt-2 border-t border-border/50",children:(0,b.jsx)(g.StyledButton,{intent:"outline",size:"sm",icon:(0,b.jsx)(o.ExternalLink,{className:"h-3.5 w-3.5"}),label:"View Project",showArrow:!1,onClick:b=>{b?.stopPropagation(),a.push(`/projects/${c.id}`)},className:"w-full justify-center"})})]})},c.id)})]},c.id)}})})})]}),P&&(0,b.jsx)(x.default,{isOpen:N,onClose:()=>O(!1),onConfirm:ab,title:"Delete Project",itemName:P.name,itemType:"Project"})]})}a.s(["default",()=>G],282287)}];

//# sourceMappingURL=apps_web_src_app_%28workspace%29_projects_page_tsx_96cafd04._.js.map