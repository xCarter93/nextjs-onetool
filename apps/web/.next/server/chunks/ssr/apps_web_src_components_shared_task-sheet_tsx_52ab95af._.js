module.exports=[770137,394183,a=>{"use strict";var b=a.i(187924),c=a.i(572131);a.i(511241);var d=a.i(296373),e=a.i(130487),f=a.i(700760),g=a.i(757215),h=a.i(994845),i=a.i(547885),j=a.i(539524),k=a.i(762537),l=a.i(928503),m=a.i(658547),n=a.i(165004),o=a.i(145432),p=a.i(629353),q=a.i(730769),r=a.i(546842),s=a.i(170106);let t=(0,s.default)("flag",[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]]);a.s(["Flag",()=>t],394183);var u=a.i(267900),v=a.i(296101);let w=(0,s.default)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),x=[{value:"low",label:"Low",color:"text-gray-600"},{value:"medium",label:"Medium",color:"text-blue-600"},{value:"high",label:"High",color:"text-amber-600"},{value:"urgent",label:"Urgent",color:"text-red-600"}],y=[{value:"pending",label:"Pending",color:"text-gray-600"},{value:"in-progress",label:"In Progress",color:"text-blue-600"},{value:"completed",label:"Completed",color:"text-green-600"},{value:"cancelled",label:"Cancelled",color:"text-red-600"}],z=[{value:"none",label:"No repeat"},{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}];function A({task:a,onOpenChange:s,trigger:A,mode:B,isOpen:C,initialValues:D}){let{success:E,error:F}=(0,p.useToast)(),[G,H]=(0,c.useState)({title:"",description:"",type:"external",clientId:"",projectId:"",date:void 0,assigneeUserId:"",status:"pending",priority:"medium",repeat:"none",repeatUntil:void 0}),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(!1),Q=(0,d.useQuery)(e.api.clients.list,{}),R=(0,d.useQuery)(e.api.projects.list,G.clientId?{clientId:G.clientId}:{}),S=(0,d.useQuery)(e.api.users.listByOrg),T=(0,d.useMutation)(e.api.tasks.create),U=(0,d.useMutation)(e.api.tasks.update),V="edit"===B||!!a,W="create"===B||!a;(0,c.useEffect)(()=>{if(V&&a){let b=new Date(a.date);H({title:a.title,description:a.description||"",type:a.type||"external",clientId:a.clientId||"",projectId:a.projectId||"",date:b,assigneeUserId:a.assigneeUserId||"",status:a.status,priority:a.priority||"medium",repeat:a.repeat||"none",repeatUntil:a.repeatUntil?new Date(a.repeatUntil):void 0})}else if(W){let a=new Date;a.setHours(0,0,0,0),H({title:"",description:"",type:"external",clientId:D?.clientId||"",projectId:D?.projectId||"",date:a,assigneeUserId:"",status:"pending",priority:"medium",repeat:"none",repeatUntil:void 0})}},[a,V,W,D,B]);let X=(a,b)=>{H(c=>({...c,[a]:b})),"clientId"===a&&H(a=>({...a,projectId:""}))},Y=async b=>{if(b?.preventDefault(),!G.title.trim())return void F("Error","Task title is required");if("external"===G.type&&!G.clientId)return void F("Error","Please select a client for external tasks");if(!G.date)return void F("Error","Please select a date");if(G.repeat&&"none"!==G.repeat&&!G.repeatUntil)return void F("Error","Please select an end date for recurring tasks");J(!0);try{let b=a=>{let b=new Date(a),c=b.getFullYear(),d=b.getMonth(),e=b.getDate();return Date.UTC(c,d,e)},c=b(G.date),d=G.repeatUntil?b(G.repeatUntil):void 0,e={title:G.title.trim(),description:G.description.trim()||void 0,type:G.type,clientId:G.clientId?G.clientId:void 0,projectId:G.projectId?G.projectId:void 0,date:c,assigneeUserId:G.assigneeUserId?G.assigneeUserId:void 0,status:G.status,priority:G.priority,repeat:G.repeat,repeatUntil:d};V&&a?(await U({id:a._id,...e}),E("Success","Task updated successfully!")):(await T(e),E("Success","Task created successfully!")),A?P(!1):s&&s(!1)}catch(a){console.error("Error saving task:",a),F("Error",a instanceof Error?a.message:"Failed to save task")}finally{J(!1)}},Z=(0,b.jsx)(o.SheetContent,{side:"right",className:"w-full sm:max-w-xl bg-background!",children:(0,b.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",children:[(0,b.jsxs)(o.SheetHeader,{className:"border-b border-border pb-4 shrink-0",children:[(0,b.jsx)(o.SheetTitle,{className:"flex items-center gap-2 text-2xl font-semibold",children:V?"Edit Task":"Create New Task"}),(0,b.jsx)(o.SheetDescription,{className:"text-muted-foreground",children:V?"Update the task details below.":"Add a new task to your schedule. Fill in the details below."})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto pt-6 px-6",children:(0,b.jsxs)("form",{onSubmit:Y,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2.5",children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-foreground",children:"Task Type"}),(0,b.jsxs)(h.StyledSelect,{value:G.type,onValueChange:a=>X("type",a),children:[(0,b.jsx)(h.StyledSelectTrigger,{className:"w-full",children:(0,b.jsx)(i.SelectValue,{})}),(0,b.jsxs)(h.StyledSelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"external",children:"External (Client Task)"}),(0,b.jsx)(i.SelectItem,{value:"internal",children:"Internal (Team Task)"})]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"external"===G.type?"External tasks require a client and can be linked to projects":"Internal tasks are for your team and don't require a client"})]}),(0,b.jsxs)("div",{className:"space-y-2.5",children:[(0,b.jsxs)("label",{className:"text-sm font-semibold text-foreground flex items-center gap-1.5",children:["Task Title ",(0,b.jsx)("span",{className:"text-danger",children:"*"})]}),(0,b.jsx)(l.Input,{value:G.title,onChange:a=>X("title",a.target.value),placeholder:"Enter task title...",className:"w-full transition-all duration-200 hover:border-primary/50 focus:border-primary"})]}),(0,b.jsxs)("div",{className:"space-y-2.5",children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-foreground",children:"Description"}),(0,b.jsx)("textarea",{value:G.description,onChange:a=>X("description",a.target.value),placeholder:"Add task description...",className:(0,f.cn)("flex min-h-[100px] w-full rounded-md border border-input bg-transparent px-3 py-2.5 text-sm","placeholder:text-muted-foreground","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:cursor-not-allowed disabled:opacity-50","transition-all duration-200 hover:border-primary/50 focus:border-primary","resize-none"),rows:4})]}),"external"===G.type&&(0,b.jsxs)("div",{className:"space-y-2.5",children:[(0,b.jsxs)("label",{className:"text-sm font-semibold text-foreground flex items-center gap-2",children:[(0,b.jsx)(u.Building2,{className:"h-4 w-4 text-primary"}),"Client ",(0,b.jsx)("span",{className:"text-danger",children:"*"})]}),(0,b.jsxs)(h.StyledSelect,{value:G.clientId,onValueChange:a=>X("clientId",a),children:[(0,b.jsx)(h.StyledSelectTrigger,{className:"w-full",children:(0,b.jsx)(i.SelectValue,{placeholder:"Select a client..."})}),(0,b.jsx)(h.StyledSelectContent,{children:Q?.map(a=>(0,b.jsx)(i.SelectItem,{value:a._id,children:a.companyName},a._id))})]})]}),"external"===G.type&&(0,b.jsxs)("div",{className:"space-y-2.5",children:[(0,b.jsxs)("label",{className:"text-sm font-semibold text-foreground flex items-center gap-2",children:[(0,b.jsx)(v.FolderOpen,{className:"h-4 w-4 text-primary"}),"Project"," ",(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,b.jsxs)(h.StyledSelect,{value:G.projectId,onValueChange:a=>X("projectId",a),disabled:!G.clientId,children:[(0,b.jsx)(h.StyledSelectTrigger,{className:"w-full",disabled:!G.clientId,children:(0,b.jsx)(i.SelectValue,{placeholder:"No project selected"})}),(0,b.jsx)(h.StyledSelectContent,{children:R?.map(a=>(0,b.jsx)(i.SelectItem,{value:a._id,children:a.title},a._id))})]}),!G.clientId&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Select a client first to choose a project"})]}),(0,b.jsxs)("div",{className:"space-y-2.5",children:[(0,b.jsxs)("label",{className:"text-sm font-semibold text-foreground flex items-center gap-2",children:[(0,b.jsx)(q.CalendarIcon,{className:"h-4 w-4 text-primary"}),"Date ",(0,b.jsx)("span",{className:"text-danger",children:"*"})]}),(0,b.jsxs)(n.Popover,{open:K,onOpenChange:L,children:[(0,b.jsx)(n.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(j.Button,{intent:"outline",id:"date-picker",className:"w-full justify-start font-normal",children:[(0,b.jsx)(q.CalendarIcon,{className:"mr-2 h-4 w-4"}),G.date?G.date.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Select date"]})}),(0,b.jsx)(n.PopoverContent,{className:"w-auto p-0 bg-white dark:bg-gray-950",align:"start",children:(0,b.jsx)(k.Calendar,{mode:"single",selected:G.date,onSelect:a=>{a&&(H(b=>({...b,date:a})),L(!1))},className:"bg-white! dark:bg-gray-950!"})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2.5",children:[(0,b.jsxs)("label",{className:"text-sm font-semibold text-foreground flex items-center gap-2",children:[(0,b.jsx)(w,{className:"h-4 w-4 text-primary"}),"Status"]}),(0,b.jsxs)(h.StyledSelect,{value:G.status,onValueChange:a=>X("status",a),children:[(0,b.jsx)(h.StyledSelectTrigger,{className:"w-full",children:(0,b.jsx)(i.SelectValue,{})}),(0,b.jsx)(h.StyledSelectContent,{children:y.map(a=>(0,b.jsx)(i.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{className:"space-y-2.5",children:[(0,b.jsxs)("label",{className:"text-sm font-semibold text-foreground flex items-center gap-2",children:[(0,b.jsx)(t,{className:"h-4 w-4 text-primary"}),"Priority"]}),(0,b.jsxs)(h.StyledSelect,{value:G.priority,onValueChange:a=>X("priority",a),children:[(0,b.jsx)(h.StyledSelectTrigger,{className:"w-full",children:(0,b.jsx)(i.SelectValue,{})}),(0,b.jsx)(h.StyledSelectContent,{children:x.map(a=>(0,b.jsx)(i.SelectItem,{value:a.value,children:a.label},a.value))})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2.5",children:[(0,b.jsxs)("label",{className:"text-sm font-semibold text-foreground flex items-center gap-2",children:[(0,b.jsx)(r.User,{className:"h-4 w-4 text-primary"}),"Assign To"]}),(0,b.jsxs)(h.StyledSelect,{value:G.assigneeUserId||void 0,onValueChange:a=>X("assigneeUserId",a),children:[(0,b.jsx)(h.StyledSelectTrigger,{className:"w-full",children:(0,b.jsx)(i.SelectValue,{placeholder:"Unassigned"})}),(0,b.jsx)(h.StyledSelectContent,{children:S?.map(a=>(0,b.jsx)(i.SelectItem,{value:a._id,children:a.name||a.email},a._id))})]})]}),(0,b.jsxs)("div",{className:"space-y-4 p-4 rounded-lg bg-muted/30 border border-border/50",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Recurrence"}),(0,b.jsxs)("div",{className:"space-y-2.5",children:[(0,b.jsx)("label",{className:"text-xs font-medium text-foreground",children:"Repeat"}),(0,b.jsxs)(h.StyledSelect,{value:G.repeat,onValueChange:a=>X("repeat",a),children:[(0,b.jsx)(h.StyledSelectTrigger,{className:"w-full",children:(0,b.jsx)(i.SelectValue,{})}),(0,b.jsx)(h.StyledSelectContent,{children:z.map(a=>(0,b.jsx)(i.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),"none"!==G.repeat&&(0,b.jsxs)("div",{className:"flex flex-col gap-2 animate-in fade-in-50 slide-in-from-top-2 duration-200",children:[(0,b.jsxs)(m.Label,{htmlFor:"repeat-until-picker",className:"text-xs font-medium text-foreground flex items-center gap-1",children:["Repeat Until ",(0,b.jsx)("span",{className:"text-danger",children:"*"})]}),(0,b.jsxs)(n.Popover,{open:M,onOpenChange:N,children:[(0,b.jsx)(n.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(j.Button,{intent:"outline",id:"repeat-until-picker",className:"w-full justify-start font-normal",children:[(0,b.jsx)(q.CalendarIcon,{className:"mr-2 h-4 w-4"}),G.repeatUntil?G.repeatUntil.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Select end date"]})}),(0,b.jsx)(n.PopoverContent,{className:"w-auto p-0 bg-white dark:bg-gray-950",align:"start",children:(0,b.jsx)(k.Calendar,{mode:"single",selected:G.repeatUntil,onSelect:a=>{a&&(H(b=>({...b,repeatUntil:a})),N(!1))},disabled:a=>{if(!G.date)return!1;let b=new Date(G.date);b.setHours(0,0,0,0);let c=new Date(a);return c.setHours(0,0,0,0),c<b},className:"bg-white! dark:bg-gray-950!"})})]})]})]})]})}),(0,b.jsxs)(o.SheetFooter,{className:"flex flex-row justify-end gap-3 border-t border-border shrink-0",children:[(0,b.jsx)(g.StyledButton,{type:"button",intent:"outline",onClick:()=>{A?P(!1):s&&s(!1)},disabled:I,label:"Cancel",showArrow:!1}),(0,b.jsx)(g.StyledButton,{type:"button",intent:"primary",onClick:()=>Y(),isLoading:I,disabled:I||!G.title.trim()||"external"===G.type&&!G.clientId||"none"!==G.repeat&&!G.repeatUntil,label:I?V?"Updating...":"Creating...":V?"Update Task":"Create Task",className:"min-w-[120px]",showArrow:!1})]})]})});return A?(0,b.jsxs)(o.Sheet,{open:O,onOpenChange:P,children:[(0,b.jsx)(o.SheetTrigger,{asChild:!0,children:A}),Z]}):(0,b.jsx)(o.Sheet,{open:C,onOpenChange:s,children:Z})}a.s(["TaskSheet",()=>A],770137)}];

//# sourceMappingURL=apps_web_src_components_shared_task-sheet_tsx_52ab95af._.js.map