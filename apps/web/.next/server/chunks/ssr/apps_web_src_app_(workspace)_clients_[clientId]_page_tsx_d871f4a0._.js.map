{"version":3,"sources":["../../../../../../node_modules/%40heroicons/react/24/outline/esm/ExclamationTriangleIcon.js","../../../../../../apps/web/src/app/%28workspace%29/clients/components/property-table.tsx","../../../../../../apps/web/src/app/%28workspace%29/clients/components/contact-table.tsx","../../../../../../apps/web/src/app/%28workspace%29/clients/components/email-thread-sheet.tsx","../../../../../../apps/web/src/app/%28workspace%29/clients/components/email-thread-list-popover.tsx","../../../../../../apps/web/src/app/%28workspace%29/clients/components/client-header.tsx","../../../../../../apps/web/src/app/%28workspace%29/clients/components/client-details-card.tsx","../../../../../../apps/web/src/app/%28workspace%29/clients/components/client-sidebar.tsx","../../../../../../apps/web/src/app/%28workspace%29/clients/components/client-notes-card.tsx","../../../../../../apps/web/src/app/%28workspace%29/clients/components/client-tags-services-card.tsx","../../../../../../apps/web/src/app/%28workspace%29/clients/%5BclientId%5D/page.tsx","../../../../../../node_modules/%40heroicons/react/24/outline/esm/EnvelopeIcon.js","../../../../../../node_modules/%40heroicons/react/24/outline/esm/BuildingOffice2Icon.js","../../../../../../node_modules/%40heroicons/react/24/outline/esm/PlusIcon.js","../../../../../../node_modules/%40heroicons/react/24/solid/esm/StarIcon.js","../../../../../../node_modules/dompurify/src/utils.ts","../../../../../../node_modules/lucide-react/src/icons/mail-open.ts","../../../../../../node_modules/dompurify/src/tags.ts","../../../../../../node_modules/dompurify/src/attrs.ts","../../../../../../node_modules/dompurify/src/regexp.ts","../../../../../../node_modules/dompurify/src/purify.ts"],"sourcesContent":["import * as React from \"react\";\nfunction ExclamationTriangleIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(ExclamationTriangleIcon);\nexport default ForwardRef;","\"use client\";\n\nimport React, { useState, useMemo } from \"react\";\nimport { useMutation } from \"convex/react\";\nimport { api } from \"@onetool/backend/convex/_generated/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Id, Doc } from \"@onetool/backend/convex/_generated/dataModel\";\nimport {\n\tStyledCard,\n\tStyledCardContent,\n\tStyledCardHeader,\n\tStyledCardTitle,\n} from \"@/components/ui/styled\";\nimport {\n\tTable,\n\tTableBody,\n\tTableCell,\n\tTableHead,\n\tTableHeader,\n\tTableRow,\n} from \"@/components/ui/table\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport {\n\tBuildingOffice2Icon,\n\tPlusIcon,\n\tPencilIcon,\n\tTrashIcon,\n\tCheckIcon,\n\tXMarkIcon,\n} from \"@heroicons/react/24/outline\";\nimport { StarIcon as StarFilledIcon } from \"@heroicons/react/24/solid\";\n\ntype Property = {\n\t_id: Id<\"clientProperties\"> | string; // Allow temp IDs for new items\n\tstreetAddress: string;\n\tcity: string;\n\tstate: string;\n\tzipCode: string;\n\tcountry?: string;\n\tdescription?: string;\n\tisPrimary: boolean;\n\tisNew?: boolean; // Track if this is a new item not yet saved\n};\n\ninterface PropertyTableProps {\n\tclientId: Id<\"clients\">;\n\tproperties: Doc<\"clientProperties\">[];\n\tonChange?: () => void;\n}\n\nexport function PropertyTable({\n\tclientId,\n\tproperties,\n\tonChange,\n}: PropertyTableProps) {\n\tconst toast = useToast();\n\tconst createProperty = useMutation(api.clientProperties.create);\n\tconst updateProperty = useMutation(api.clientProperties.update);\n\tconst deleteProperty = useMutation(api.clientProperties.remove);\n\n\t// Local state\n\tconst [editingId, setEditingId] = useState<\n\t\tId<\"clientProperties\"> | string | null\n\t>(null);\n\tconst [localProperties, setLocalProperties] = useState<Property[]>([]);\n\tconst [nextTempId, setNextTempId] = useState(1);\n\n\t// Combine saved properties with local ones\n\tconst allProperties = useMemo(() => {\n\t\t// Convert saved items to our Property type\n\t\tconst savedItems: Property[] = properties.map((item) => ({\n\t\t\t...item,\n\t\t\tisNew: false,\n\t\t}));\n\n\t\tconsole.log(\"allProperties useMemo:\", {\n\t\t\tsavedItems: savedItems.map((p) => ({\n\t\t\t\tid: p._id,\n\t\t\t\tname: p.streetAddress,\n\t\t\t\tisNew: p.isNew,\n\t\t\t})),\n\t\t\tlocalProperties: localProperties.map((p) => ({\n\t\t\t\tid: p._id,\n\t\t\t\tname: p.streetAddress,\n\t\t\t\tisNew: p.isNew,\n\t\t\t})),\n\t\t});\n\n\t\t// Combine and sort by creation time (newest first)\n\t\treturn [...savedItems, ...localProperties];\n\t}, [properties, localProperties]);\n\n\tconst handleAddProperty = () => {\n\t\tconst tempId = `temp-${nextTempId}`;\n\n\t\tconst newProperty: Property = {\n\t\t\t_id: tempId,\n\t\t\tstreetAddress: \"\",\n\t\t\tcity: \"\",\n\t\t\tstate: \"\",\n\t\t\tzipCode: \"\",\n\t\t\tcountry: \"\",\n\t\t\tdescription: \"\",\n\t\t\tisPrimary: false,\n\t\t\tisNew: true,\n\t\t};\n\n\t\tsetLocalProperties((prev) => [...prev, newProperty]);\n\t\tsetEditingId(tempId);\n\t\tsetNextTempId((prev) => prev + 1);\n\t};\n\n\tconst handleEditProperty = (id: Id<\"clientProperties\"> | string) => {\n\t\tconsole.log(\"handleEditProperty called with:\", {\n\t\t\tid,\n\t\t\tidType: typeof id,\n\t\t\tproperty: allProperties.find((p) => p._id === id),\n\t\t});\n\t\tsetEditingId(id);\n\t};\n\n\tconst handleSaveProperty = async (property: Property) => {\n\t\tconsole.log(\"handleSaveProperty called with:\", {\n\t\t\tpropertyId: property._id,\n\t\t\tpropertyIdType: typeof property._id,\n\t\t\tisNew: property.isNew,\n\t\t});\n\n\t\t// Check if this is a new property by looking at the isNew flag or if it's a temporary ID\n\t\tconst isNewProperty =\n\t\t\tproperty.isNew ||\n\t\t\t(typeof property._id === \"string\" && property._id.startsWith(\"temp-\"));\n\n\t\tif (isNewProperty) {\n\t\t\t// Save new property directly to database\n\t\t\tconsole.log(\"Creating new property...\");\n\t\t\ttry {\n\t\t\t\tawait createProperty({\n\t\t\t\t\tclientId,\n\t\t\t\t\tstreetAddress: property.streetAddress || \"Address Required\",\n\t\t\t\t\tcity: property.city || \"City Required\",\n\t\t\t\t\tstate: property.state || \"State Required\",\n\t\t\t\t\tzipCode: property.zipCode || \"ZIP Required\",\n\t\t\t\t\tcountry: property.country,\n\t\t\t\t\tdescription: property.description,\n\t\t\t\t\tisPrimary: property.isPrimary,\n\t\t\t\t});\n\n\t\t\t\t// Remove from local items\n\t\t\t\tsetLocalProperties((prev) =>\n\t\t\t\t\tprev.filter((item) => item._id !== property._id)\n\t\t\t\t);\n\t\t\t\tsetEditingId(null);\n\t\t\t\tonChange?.();\n\t\t\t\ttoast.success(\n\t\t\t\t\t\"Property Saved\",\n\t\t\t\t\t\"Property has been successfully saved!\"\n\t\t\t\t);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\"Failed to save property:\", error);\n\t\t\t\ttoast.error(\"Error\", \"Failed to save property. Please try again.\");\n\t\t\t}\n\t\t} else {\n\t\t\t// Update existing item in database\n\t\t\tconsole.log(\"Updating existing property with ID:\", property._id);\n\t\t\ttry {\n\t\t\t\tawait updateProperty({\n\t\t\t\t\tid: property._id as Id<\"clientProperties\">,\n\t\t\t\t\tstreetAddress: property.streetAddress,\n\t\t\t\t\tcity: property.city,\n\t\t\t\t\tstate: property.state,\n\t\t\t\t\tzipCode: property.zipCode,\n\t\t\t\t\tcountry: property.country,\n\t\t\t\t\tdescription: property.description,\n\t\t\t\t\tisPrimary: property.isPrimary,\n\t\t\t\t});\n\t\t\t\tsetEditingId(null);\n\t\t\t\tonChange?.();\n\t\t\t\ttoast.success(\n\t\t\t\t\t\"Property Updated\",\n\t\t\t\t\t\"Property has been successfully updated!\"\n\t\t\t\t);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\"Failed to save property:\", error);\n\t\t\t\ttoast.error(\"Error\", \"Failed to save property. Please try again.\");\n\t\t\t}\n\t\t}\n\t};\n\n\tconst handleDeleteProperty = async (id: Id<\"clientProperties\"> | string) => {\n\t\t// Check if this is a temporary ID (new item not yet saved)\n\t\tif (typeof id === \"string\" && id.startsWith(\"temp-\")) {\n\t\t\t// Remove local item\n\t\t\tsetLocalProperties((prev) => prev.filter((item) => item._id !== id));\n\t\t\tif (editingId === id) {\n\t\t\t\tsetEditingId(null);\n\t\t\t}\n\t\t\ttoast.success(\"Property Deleted\", \"Unsaved property has been removed.\");\n\t\t} else {\n\t\t\t// Delete from database\n\t\t\ttry {\n\t\t\t\tawait deleteProperty({ id: id as Id<\"clientProperties\"> });\n\t\t\t\tonChange?.();\n\t\t\t\ttoast.success(\n\t\t\t\t\t\"Property Deleted\",\n\t\t\t\t\t\"Property has been successfully deleted.\"\n\t\t\t\t);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\"Failed to delete property:\", error);\n\t\t\t\ttoast.error(\"Error\", \"Failed to delete property. Please try again.\");\n\t\t\t}\n\t\t}\n\t};\n\n\treturn (\n\t\t<StyledCard>\n\t\t\t<StyledCardHeader className=\"flex flex-row items-center justify-between pb-6\">\n\t\t\t\t<StyledCardTitle className=\"text-xl\">Properties</StyledCardTitle>\n\t\t\t\t<Button intent=\"outline\" size=\"sm\" onPress={handleAddProperty}>\n\t\t\t\t\t<PlusIcon className=\"h-4 w-4 mr-2\" />\n\t\t\t\t\tNew Property\n\t\t\t\t</Button>\n\t\t\t</StyledCardHeader>\n\t\t\t<StyledCardContent>\n\t\t\t\t{allProperties && allProperties.length > 0 ? (\n\t\t\t\t\t<div className=\"overflow-hidden rounded-lg border\">\n\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t<TableHead className=\"w-[40%]\">Address</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead className=\"w-[20%]\">City</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead className=\"w-[15%]\">State</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead className=\"w-[15%]\">ZIP</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead className=\"w-[5%]\">Primary</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead className=\"w-[5%]\">Actions</TableHead>\n\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t{allProperties.map((property) => (\n\t\t\t\t\t\t\t\t\t<PropertyRow\n\t\t\t\t\t\t\t\t\t\tkey={property._id}\n\t\t\t\t\t\t\t\t\t\tproperty={property}\n\t\t\t\t\t\t\t\t\t\tisEditing={editingId === property._id}\n\t\t\t\t\t\t\t\t\t\tonEdit={() => handleEditProperty(property._id)}\n\t\t\t\t\t\t\t\t\t\tonSave={handleSaveProperty}\n\t\t\t\t\t\t\t\t\t\tonCancel={() => setEditingId(null)}\n\t\t\t\t\t\t\t\t\t\tonDelete={() => handleDeleteProperty(property._id)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t</Table>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"flex flex-col items-center justify-center py-12 text-center\">\n\t\t\t\t\t\t<div className=\"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center mb-4\">\n\t\t\t\t\t\t\t<BuildingOffice2Icon className=\"h-8 w-8 text-gray-400\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\n\t\t\t\t\t\t\tNo properties\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<p className=\"text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\tNo properties have been added for this client yet.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</StyledCardContent>\n\t\t</StyledCard>\n\t);\n}\n\n// PropertyRow Component for inline editing\nfunction PropertyRow({\n\tproperty,\n\tisEditing,\n\tonEdit,\n\tonSave,\n\tonCancel,\n\tonDelete,\n}: {\n\tproperty: Property;\n\tisEditing: boolean;\n\tonEdit: () => void;\n\tonSave: (property: Property) => void;\n\tonCancel: () => void;\n\tonDelete: () => void;\n}) {\n\tconst [editedProperty, setEditedProperty] = useState<Property>(property);\n\n\tReact.useEffect(() => {\n\t\tif (isEditing) {\n\t\t\tsetEditedProperty(property);\n\t\t}\n\t}, [isEditing, property]);\n\n\tconst handleFieldChange = (\n\t\tfield: keyof Property,\n\t\tvalue: string | number | boolean | undefined\n\t) => {\n\t\tsetEditedProperty((prev) => ({\n\t\t\t...prev,\n\t\t\t[field]: value,\n\t\t}));\n\t};\n\n\tconst handleSave = () => {\n\t\tconsole.log(\"PropertyRow handleSave called with:\", {\n\t\t\tpropertyId: editedProperty._id,\n\t\t\tpropertyIdType: typeof editedProperty._id,\n\t\t\tisNew: editedProperty.isNew,\n\t\t\toriginalPropertyId: property._id,\n\t\t\toriginalPropertyIdType: typeof property._id,\n\t\t});\n\t\tonSave(editedProperty);\n\t};\n\n\tif (isEditing) {\n\t\treturn (\n\t\t\t<TableRow\n\t\t\t\tclassName={`bg-blue-50/50 dark:bg-blue-900/10 border-l-4 border-l-blue-500 ${property.isNew ? \"bg-yellow-50/50 dark:bg-yellow-900/10\" : \"\"}`}\n\t\t\t>\n\t\t\t\t<TableCell>\n\t\t\t\t\t<Input\n\t\t\t\t\t\tvalue={editedProperty.streetAddress}\n\t\t\t\t\t\tonChange={(e) => handleFieldChange(\"streetAddress\", e.target.value)}\n\t\t\t\t\t\tplaceholder=\"Street address...\"\n\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t/>\n\t\t\t\t</TableCell>\n\t\t\t\t<TableCell>\n\t\t\t\t\t<Input\n\t\t\t\t\t\tvalue={editedProperty.city}\n\t\t\t\t\t\tonChange={(e) => handleFieldChange(\"city\", e.target.value)}\n\t\t\t\t\t\tplaceholder=\"City...\"\n\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t/>\n\t\t\t\t</TableCell>\n\t\t\t\t<TableCell>\n\t\t\t\t\t<Input\n\t\t\t\t\t\tvalue={editedProperty.state}\n\t\t\t\t\t\tonChange={(e) => handleFieldChange(\"state\", e.target.value)}\n\t\t\t\t\t\tplaceholder=\"State...\"\n\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t/>\n\t\t\t\t</TableCell>\n\t\t\t\t<TableCell>\n\t\t\t\t\t<Input\n\t\t\t\t\t\tvalue={editedProperty.zipCode}\n\t\t\t\t\t\tonChange={(e) => handleFieldChange(\"zipCode\", e.target.value)}\n\t\t\t\t\t\tplaceholder=\"ZIP...\"\n\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t/>\n\t\t\t\t</TableCell>\n\t\t\t\t<TableCell>\n\t\t\t\t\t<Checkbox\n\t\t\t\t\t\tchecked={editedProperty.isPrimary}\n\t\t\t\t\t\tonCheckedChange={(checked) =>\n\t\t\t\t\t\t\thandleFieldChange(\"isPrimary\", !!checked)\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</TableCell>\n\t\t\t\t<TableCell>\n\t\t\t\t\t<div className=\"flex gap-1\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tintent=\"outline\"\n\t\t\t\t\t\t\tsize=\"sq-sm\"\n\t\t\t\t\t\t\tonPress={handleSave}\n\t\t\t\t\t\t\taria-label=\"Save\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<CheckIcon className=\"h-3 w-3\" />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tintent=\"outline\"\n\t\t\t\t\t\t\tsize=\"sq-sm\"\n\t\t\t\t\t\t\tonPress={onCancel}\n\t\t\t\t\t\t\taria-label=\"Cancel\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<XMarkIcon className=\"h-3 w-3\" />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</TableCell>\n\t\t\t</TableRow>\n\t\t);\n\t}\n\n\treturn (\n\t\t<TableRow\n\t\t\tclassName={`hover:bg-muted/50 ${property.isNew ? \"bg-yellow-50/30 dark:bg-yellow-900/20 border-l-4 border-l-yellow-400\" : \"\"}`}\n\t\t>\n\t\t\t<TableCell className=\"font-medium\">\n\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t<span>{property.streetAddress}</span>\n\t\t\t\t\t{property.isNew && (\n\t\t\t\t\t\t<span className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300\">\n\t\t\t\t\t\t\tUnsaved\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</TableCell>\n\t\t\t<TableCell>{property.city}</TableCell>\n\t\t\t<TableCell>{property.state}</TableCell>\n\t\t\t<TableCell>{property.zipCode}</TableCell>\n\t\t\t<TableCell>\n\t\t\t\t{property.isPrimary && (\n\t\t\t\t\t<StarFilledIcon className=\"h-4 w-4 text-yellow-400\" />\n\t\t\t\t)}\n\t\t\t</TableCell>\n\t\t\t<TableCell>\n\t\t\t\t<div className=\"flex gap-1\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tintent=\"outline\"\n\t\t\t\t\t\tsize=\"sq-sm\"\n\t\t\t\t\t\tonPress={onEdit}\n\t\t\t\t\t\taria-label=\"Edit\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<PencilIcon className=\"h-3 w-3\" />\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tintent=\"outline\"\n\t\t\t\t\t\tsize=\"sq-sm\"\n\t\t\t\t\t\tonPress={onDelete}\n\t\t\t\t\t\taria-label=\"Delete\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<TrashIcon className=\"h-3 w-3\" />\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</TableCell>\n\t\t</TableRow>\n\t);\n}\n","\"use client\";\n\nimport React, { useState, useMemo } from \"react\";\nimport { useMutation } from \"convex/react\";\nimport { api } from \"@onetool/backend/convex/_generated/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Id, Doc } from \"@onetool/backend/convex/_generated/dataModel\";\nimport {\n\tStyledCard,\n\tStyledCardContent,\n\tStyledCardHeader,\n\tStyledCardTitle,\n} from \"@/components/ui/styled\";\nimport {\n\tTable,\n\tTableBody,\n\tTableCell,\n\tTableHead,\n\tTableHeader,\n\tTableRow,\n} from \"@/components/ui/table\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport {\n\tEnvelopeIcon,\n\tPlusIcon,\n\tPencilIcon,\n\tTrashIcon,\n\tCheckIcon,\n\tXMarkIcon,\n} from \"@heroicons/react/24/outline\";\nimport { StarIcon as StarFilledIcon } from \"@heroicons/react/24/solid\";\n\ntype Contact = {\n\t_id: Id<\"clientContacts\"> | string; // Allow temp IDs for new items\n\tfirstName: string;\n\tlastName: string;\n\temail?: string;\n\tphone?: string;\n\tjobTitle?: string;\n\trole?: string;\n\tisPrimary: boolean;\n\tisNew?: boolean; // Track if this is a new item not yet saved\n};\n\ninterface ContactTableProps {\n\tclientId: Id<\"clients\">;\n\tcontacts: Doc<\"clientContacts\">[];\n\tonChange?: () => void;\n}\n\nexport function ContactTable({\n\tclientId,\n\tcontacts,\n\tonChange,\n}: ContactTableProps) {\n\tconst toast = useToast();\n\tconst createContact = useMutation(api.clientContacts.create);\n\tconst updateContact = useMutation(api.clientContacts.update);\n\tconst deleteContact = useMutation(api.clientContacts.remove);\n\n\t// Local state\n\tconst [editingId, setEditingId] = useState<\n\t\tId<\"clientContacts\"> | string | null\n\t>(null);\n\tconst [localContacts, setLocalContacts] = useState<Contact[]>([]);\n\tconst [nextTempId, setNextTempId] = useState(1);\n\n\t// Combine saved contacts with local ones\n\tconst allContacts = useMemo(() => {\n\t\t// Convert saved items to our Contact type\n\t\tconst savedItems: Contact[] = contacts.map((item) => ({\n\t\t\t...item,\n\t\t\tisNew: false,\n\t\t}));\n\n\t\tconsole.log(\"allContacts useMemo:\", {\n\t\t\tsavedItems: savedItems.map((c) => ({\n\t\t\t\tid: c._id,\n\t\t\t\tname: `${c.firstName} ${c.lastName}`,\n\t\t\t\tisNew: c.isNew,\n\t\t\t})),\n\t\t\tlocalContacts: localContacts.map((c) => ({\n\t\t\t\tid: c._id,\n\t\t\t\tname: `${c.firstName} ${c.lastName}`,\n\t\t\t\tisNew: c.isNew,\n\t\t\t})),\n\t\t});\n\n\t\t// Combine and sort by creation time (newest first)\n\t\treturn [...savedItems, ...localContacts];\n\t}, [contacts, localContacts]);\n\n\tconst handleAddContact = () => {\n\t\tconst tempId = `temp-${nextTempId}`;\n\n\t\tconst newContact: Contact = {\n\t\t\t_id: tempId,\n\t\t\tfirstName: \"\",\n\t\t\tlastName: \"\",\n\t\t\temail: \"\",\n\t\t\tphone: \"\",\n\t\t\tjobTitle: \"\",\n\t\t\trole: \"\",\n\t\t\tisPrimary: false,\n\t\t\tisNew: true,\n\t\t};\n\n\t\tsetLocalContacts((prev) => [...prev, newContact]);\n\t\tsetEditingId(tempId);\n\t\tsetNextTempId((prev) => prev + 1);\n\t};\n\n\tconst handleEditContact = (id: Id<\"clientContacts\"> | string) => {\n\t\tconsole.log(\"handleEditContact called with:\", {\n\t\t\tid,\n\t\t\tidType: typeof id,\n\t\t\tcontact: allContacts.find((c) => c._id === id),\n\t\t});\n\t\tsetEditingId(id);\n\t};\n\n\tconst handleSaveContact = async (contact: Contact) => {\n\t\tconsole.log(\"handleSaveContact called with:\", {\n\t\t\tcontactId: contact._id,\n\t\t\tcontactIdType: typeof contact._id,\n\t\t\tisNew: contact.isNew,\n\t\t\tcontactName: `${contact.firstName} ${contact.lastName}`,\n\t\t});\n\n\t\t// Check if this is a new contact by looking at the isNew flag or if it's a temporary ID\n\t\tconst isNewContact =\n\t\t\tcontact.isNew ||\n\t\t\t(typeof contact._id === \"string\" && contact._id.startsWith(\"temp-\"));\n\n\t\tif (isNewContact) {\n\t\t\t// Save new contact directly to database\n\t\t\tconsole.log(\"Creating new contact...\");\n\t\t\ttry {\n\t\t\t\tawait createContact({\n\t\t\t\t\tclientId,\n\t\t\t\t\tfirstName: contact.firstName || \"First Name Required\",\n\t\t\t\t\tlastName: contact.lastName || \"Last Name Required\",\n\t\t\t\t\temail: contact.email,\n\t\t\t\t\tphone: contact.phone,\n\t\t\t\t\tjobTitle: contact.jobTitle,\n\t\t\t\t\trole: contact.role,\n\t\t\t\t\tisPrimary: contact.isPrimary,\n\t\t\t\t});\n\n\t\t\t\t// Remove from local items\n\t\t\t\tsetLocalContacts((prev) =>\n\t\t\t\t\tprev.filter((item) => item._id !== contact._id)\n\t\t\t\t);\n\t\t\t\tsetEditingId(null);\n\t\t\t\tonChange?.();\n\t\t\t\ttoast.success(\"Contact Saved\", \"Contact has been successfully saved!\");\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\"Failed to save contact:\", error);\n\t\t\t\ttoast.error(\"Error\", \"Failed to save contact. Please try again.\");\n\t\t\t}\n\t\t} else {\n\t\t\t// Update existing item in database\n\t\t\tconsole.log(\"Updating existing contact with ID:\", contact._id);\n\t\t\ttry {\n\t\t\t\tawait updateContact({\n\t\t\t\t\tid: contact._id as Id<\"clientContacts\">,\n\t\t\t\t\tfirstName: contact.firstName,\n\t\t\t\t\tlastName: contact.lastName,\n\t\t\t\t\temail: contact.email,\n\t\t\t\t\tphone: contact.phone,\n\t\t\t\t\tjobTitle: contact.jobTitle,\n\t\t\t\t\trole: contact.role,\n\t\t\t\t\tisPrimary: contact.isPrimary,\n\t\t\t\t});\n\t\t\t\tsetEditingId(null);\n\t\t\t\tonChange?.();\n\t\t\t\ttoast.success(\n\t\t\t\t\t\"Contact Updated\",\n\t\t\t\t\t\"Contact has been successfully updated!\"\n\t\t\t\t);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\"Failed to save contact:\", error);\n\t\t\t\ttoast.error(\"Error\", \"Failed to save contact. Please try again.\");\n\t\t\t}\n\t\t}\n\t};\n\n\tconst handleDeleteContact = async (id: Id<\"clientContacts\"> | string) => {\n\t\t// Check if this is a temporary ID (new item not yet saved)\n\t\tif (typeof id === \"string\" && id.startsWith(\"temp-\")) {\n\t\t\t// Remove local item\n\t\t\tsetLocalContacts((prev) => prev.filter((item) => item._id !== id));\n\t\t\tif (editingId === id) {\n\t\t\t\tsetEditingId(null);\n\t\t\t}\n\t\t\ttoast.success(\"Contact Deleted\", \"Unsaved contact has been removed.\");\n\t\t} else {\n\t\t\t// Delete from database\n\t\t\ttry {\n\t\t\t\tawait deleteContact({ id: id as Id<\"clientContacts\"> });\n\t\t\t\tonChange?.();\n\t\t\t\ttoast.success(\n\t\t\t\t\t\"Contact Deleted\",\n\t\t\t\t\t\"Contact has been successfully deleted.\"\n\t\t\t\t);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\"Failed to delete contact:\", error);\n\t\t\t\ttoast.error(\"Error\", \"Failed to delete contact. Please try again.\");\n\t\t\t}\n\t\t}\n\t};\n\n\treturn (\n\t\t<StyledCard>\n\t\t\t<StyledCardHeader className=\"flex flex-row items-center justify-between pb-6\">\n\t\t\t\t<StyledCardTitle className=\"text-xl\">Contacts</StyledCardTitle>\n\t\t\t\t<Button intent=\"outline\" size=\"sm\" onPress={handleAddContact}>\n\t\t\t\t\t<PlusIcon className=\"h-4 w-4 mr-2\" />\n\t\t\t\t\tNew Contact\n\t\t\t\t</Button>\n\t\t\t</StyledCardHeader>\n\t\t\t<StyledCardContent>\n\t\t\t\t{allContacts && allContacts.length > 0 ? (\n\t\t\t\t\t<div className=\"overflow-hidden rounded-lg border\">\n\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t<TableHead className=\"w-[25%]\">Name</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead className=\"w-[25%]\">Job Title</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead className=\"w-[20%]\">Phone</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead className=\"w-[20%]\">Email</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead className=\"w-[5%]\">Primary</TableHead>\n\t\t\t\t\t\t\t\t\t<TableHead className=\"w-[5%]\">Actions</TableHead>\n\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t{allContacts.map((contact) => (\n\t\t\t\t\t\t\t\t\t<ContactRow\n\t\t\t\t\t\t\t\t\t\tkey={contact._id}\n\t\t\t\t\t\t\t\t\t\tcontact={contact}\n\t\t\t\t\t\t\t\t\t\tisEditing={editingId === contact._id}\n\t\t\t\t\t\t\t\t\t\tonEdit={() => handleEditContact(contact._id)}\n\t\t\t\t\t\t\t\t\t\tonSave={handleSaveContact}\n\t\t\t\t\t\t\t\t\t\tonCancel={() => setEditingId(null)}\n\t\t\t\t\t\t\t\t\t\tonDelete={() => handleDeleteContact(contact._id)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t</Table>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"flex flex-col items-center justify-center py-12 text-center\">\n\t\t\t\t\t\t<div className=\"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center mb-4\">\n\t\t\t\t\t\t\t<EnvelopeIcon className=\"h-8 w-8 text-gray-400\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\n\t\t\t\t\t\t\tNo contacts\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<p className=\"text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\tNo contacts have been added for this client yet.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</StyledCardContent>\n\t\t</StyledCard>\n\t);\n}\n\n// ContactRow Component for inline editing\nfunction ContactRow({\n\tcontact,\n\tisEditing,\n\tonEdit,\n\tonSave,\n\tonCancel,\n\tonDelete,\n}: {\n\tcontact: Contact;\n\tisEditing: boolean;\n\tonEdit: () => void;\n\tonSave: (contact: Contact) => void;\n\tonCancel: () => void;\n\tonDelete: () => void;\n}) {\n\tconst [editedContact, setEditedContact] = useState<Contact>(contact);\n\n\tReact.useEffect(() => {\n\t\tif (isEditing) {\n\t\t\tsetEditedContact(contact);\n\t\t}\n\t}, [isEditing, contact]);\n\n\tconst handleFieldChange = (field: keyof Contact, value: string | boolean) => {\n\t\tsetEditedContact((prev) => ({\n\t\t\t...prev,\n\t\t\t[field]: value,\n\t\t}));\n\t};\n\n\tconst handleSave = () => {\n\t\tconsole.log(\"ContactRow handleSave called with:\", {\n\t\t\tcontactId: editedContact._id,\n\t\t\tcontactIdType: typeof editedContact._id,\n\t\t\tisNew: editedContact.isNew,\n\t\t\toriginalContactId: contact._id,\n\t\t\toriginalContactIdType: typeof contact._id,\n\t\t});\n\t\tonSave(editedContact);\n\t};\n\n\tif (isEditing) {\n\t\treturn (\n\t\t\t<TableRow\n\t\t\t\tclassName={`bg-blue-50/50 dark:bg-blue-900/10 border-l-4 border-l-blue-500 ${contact.isNew ? \"bg-yellow-50/50 dark:bg-yellow-900/10\" : \"\"}`}\n\t\t\t>\n\t\t\t\t<TableCell>\n\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tvalue={editedContact.firstName}\n\t\t\t\t\t\t\tonChange={(e) => handleFieldChange(\"firstName\", e.target.value)}\n\t\t\t\t\t\t\tplaceholder=\"First name...\"\n\t\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tvalue={editedContact.lastName}\n\t\t\t\t\t\t\tonChange={(e) => handleFieldChange(\"lastName\", e.target.value)}\n\t\t\t\t\t\t\tplaceholder=\"Last name...\"\n\t\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</TableCell>\n\t\t\t\t<TableCell>\n\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tvalue={editedContact.jobTitle || \"\"}\n\t\t\t\t\t\t\tonChange={(e) => handleFieldChange(\"jobTitle\", e.target.value)}\n\t\t\t\t\t\t\tplaceholder=\"Job title...\"\n\t\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</TableCell>\n\t\t\t\t<TableCell>\n\t\t\t\t\t<Input\n\t\t\t\t\t\tvalue={editedContact.phone || \"\"}\n\t\t\t\t\t\tonChange={(e) => handleFieldChange(\"phone\", e.target.value)}\n\t\t\t\t\t\tplaceholder=\"Phone...\"\n\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t/>\n\t\t\t\t</TableCell>\n\t\t\t\t<TableCell>\n\t\t\t\t\t<Input\n\t\t\t\t\t\tvalue={editedContact.email || \"\"}\n\t\t\t\t\t\tonChange={(e) => handleFieldChange(\"email\", e.target.value)}\n\t\t\t\t\t\tplaceholder=\"Email...\"\n\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t/>\n\t\t\t\t</TableCell>\n\t\t\t\t<TableCell>\n\t\t\t\t\t<Checkbox\n\t\t\t\t\t\tchecked={editedContact.isPrimary}\n\t\t\t\t\t\tonCheckedChange={(checked) =>\n\t\t\t\t\t\t\thandleFieldChange(\"isPrimary\", !!checked)\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</TableCell>\n\t\t\t\t<TableCell>\n\t\t\t\t\t<div className=\"flex gap-1\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tintent=\"outline\"\n\t\t\t\t\t\t\tsize=\"sq-sm\"\n\t\t\t\t\t\t\tonPress={handleSave}\n\t\t\t\t\t\t\taria-label=\"Save\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<CheckIcon className=\"h-3 w-3\" />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tintent=\"outline\"\n\t\t\t\t\t\t\tsize=\"sq-sm\"\n\t\t\t\t\t\t\tonPress={onCancel}\n\t\t\t\t\t\t\taria-label=\"Cancel\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<XMarkIcon className=\"h-3 w-3\" />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</TableCell>\n\t\t\t</TableRow>\n\t\t);\n\t}\n\n\treturn (\n\t\t<TableRow\n\t\t\tclassName={`hover:bg-muted/50 ${contact.isNew ? \"bg-yellow-50/30 dark:bg-yellow-900/20 border-l-4 border-l-yellow-400\" : \"\"}`}\n\t\t>\n\t\t\t<TableCell className=\"font-medium\">\n\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{contact.firstName} {contact.lastName}\n\t\t\t\t\t</span>\n\t\t\t\t\t{contact.isNew && (\n\t\t\t\t\t\t<span className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300\">\n\t\t\t\t\t\t\tUnsaved\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</TableCell>\n\t\t\t<TableCell>\n\t\t\t\t<div>\n\t\t\t\t\t{contact.jobTitle && (\n\t\t\t\t\t\t<p className=\"font-medium\">{contact.jobTitle}</p>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</TableCell>\n\t\t\t<TableCell>{contact.phone || \"—\"}</TableCell>\n\t\t\t<TableCell>{contact.email || \"—\"}</TableCell>\n\t\t\t<TableCell>\n\t\t\t\t{contact.isPrimary && (\n\t\t\t\t\t<StarFilledIcon className=\"h-4 w-4 text-yellow-400\" />\n\t\t\t\t)}\n\t\t\t</TableCell>\n\t\t\t<TableCell>\n\t\t\t\t<div className=\"flex gap-1\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tintent=\"outline\"\n\t\t\t\t\t\tsize=\"sq-sm\"\n\t\t\t\t\t\tonPress={onEdit}\n\t\t\t\t\t\taria-label=\"Edit\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<PencilIcon className=\"h-3 w-3\" />\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tintent=\"outline\"\n\t\t\t\t\t\tsize=\"sq-sm\"\n\t\t\t\t\t\tonPress={onDelete}\n\t\t\t\t\t\taria-label=\"Delete\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<TrashIcon className=\"h-3 w-3\" />\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</TableCell>\n\t\t</TableRow>\n\t);\n}\n","\"use client\";\n\nimport { useState, useEffect, useRef } from \"react\";\nimport { useQuery, useMutation } from \"convex/react\";\nimport { api } from \"@onetool/backend/convex/_generated/api\";\nimport type { Id } from \"@onetool/backend/convex/_generated/dataModel\";\nimport DOMPurify from \"dompurify\";\nimport {\n\tSheet,\n\tSheetContent,\n\tSheetHeader,\n\tSheetTitle,\n\tSheetDescription,\n} from \"@/components/ui/sheet\";\nimport { StyledButton } from \"@/components/ui/styled/styled-button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { StyledInput } from \"@/components/ui/styled\";\nimport {\n\tStyledSelect,\n\tStyledSelectTrigger,\n\tStyledSelectContent,\n\tSelectValue,\n\tSelectItem,\n} from \"@/components/ui/styled/styled-select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Send, Paperclip, Download } from \"lucide-react\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { cn } from \"@/lib/utils\";\n\ninterface EmailThreadSheetProps {\n\tisOpen: boolean;\n\tonOpenChange: (open: boolean) => void;\n\tclientId: Id<\"clients\">;\n\tthreadId?: string;\n\tonComplete?: () => void;\n\tmode?: \"new\" | \"reply\"; // New prop to determine if composing new or replying\n}\n\nexport function EmailThreadSheet({\n\tisOpen,\n\tonOpenChange,\n\tclientId,\n\tthreadId,\n\tonComplete,\n\tmode = \"reply\",\n}: EmailThreadSheetProps) {\n\tconst toast = useToast();\n\tconst [subject, setSubject] = useState(\"\");\n\tconst [replyBody, setReplyBody] = useState(\"\");\n\tconst [isSending, setIsSending] = useState(false);\n\tconst [selectedContactId, setSelectedContactId] =\n\t\tuseState<Id<\"clientContacts\"> | null>(null);\n\tconst messagesEndRef = useRef<HTMLDivElement>(null);\n\n\t// Fetch thread messages (only if threadId provided)\n\tconst thread = useQuery(\n\t\tapi.emailMessages.getEmailThread,\n\t\tthreadId ? { threadId } : \"skip\"\n\t);\n\n\t// Fetch client info\n\tconst client = useQuery(api.clients.get, { id: clientId });\n\n\t// Fetch all contacts for the client\n\tconst allContacts = useQuery(api.clientContacts.listByClient, { clientId });\n\n\t// Fetch primary contact for new emails\n\tconst primaryContact = useQuery(api.clientContacts.getPrimaryContact, {\n\t\tclientId,\n\t});\n\n\t// Fetch current user for signature preview\n\tconst currentUser = useQuery(api.users.current, {});\n\n\t// Fetch organization for signature preview\n\tconst organization = useQuery(api.organizations.get, {});\n\n\tconst replyToEmail = useMutation(api.resend.replyToEmail);\n\tconst sendClientEmail = useMutation(api.resend.sendClientEmail);\n\n\t// Get the selected contact or default to primary\n\tconst selectedContact = selectedContactId\n\t\t? allContacts?.find((c) => c._id === selectedContactId)\n\t\t: primaryContact;\n\n\t// Set default selected contact to primary when contacts load\n\tuseEffect(() => {\n\t\tif (primaryContact && !selectedContactId) {\n\t\t\tsetSelectedContactId(primaryContact._id);\n\t\t}\n\t}, [primaryContact, selectedContactId]);\n\n\t// Auto-scroll to bottom when thread updates\n\tuseEffect(() => {\n\t\tif (thread && thread.length > 0) {\n\t\t\tmessagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n\t\t}\n\t}, [thread]);\n\n\t// Reset form when sheet closes\n\tuseEffect(() => {\n\t\tif (!isOpen) {\n\t\t\tsetSubject(\"\");\n\t\t\tsetReplyBody(\"\");\n\t\t\tsetSelectedContactId(null);\n\t\t}\n\t}, [isOpen]);\n\n\tconst handleSendEmail = async () => {\n\t\t// Validate inputs\n\t\tif (!replyBody.trim()) {\n\t\t\ttoast.error(\"Empty Message\", \"Please enter a message to send\");\n\t\t\treturn;\n\t\t}\n\n\t\tconst isNewEmail = mode === \"new\" || !thread || thread.length === 0;\n\n\t\tif (isNewEmail && !subject.trim()) {\n\t\t\ttoast.error(\"Subject Required\", \"Please enter a subject for the email\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (!selectedContact?.email) {\n\t\t\ttoast.error(\n\t\t\t\t\"No Email\",\n\t\t\t\t\"The selected contact doesn't have an email address\"\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tsetIsSending(true);\n\t\ttry {\n\t\t\tif (isNewEmail) {\n\t\t\t\t// Send new email\n\t\t\t\tawait sendClientEmail({\n\t\t\t\t\tclientId,\n\t\t\t\t\tsubject: subject.trim(),\n\t\t\t\t\tmessageBody: replyBody.trim(),\n\t\t\t\t});\n\t\t\t\ttoast.success(\"Email Sent\", \"Your email has been sent successfully\");\n\t\t\t} else {\n\t\t\t\t// Reply to existing thread\n\t\t\t\tconst latestMessage = thread[thread.length - 1];\n\t\t\t\tawait replyToEmail({\n\t\t\t\t\temailMessageId: latestMessage._id,\n\t\t\t\t\tmessageBody: replyBody.trim(),\n\t\t\t\t});\n\t\t\t\ttoast.success(\"Reply Sent\", \"Your reply has been sent successfully\");\n\t\t\t}\n\n\t\t\tsetSubject(\"\");\n\t\t\tsetReplyBody(\"\");\n\t\t\tsetSelectedContactId(null);\n\t\t\tonComplete?.();\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Error sending email:\", error);\n\t\t\ttoast.error(\n\t\t\t\t\"Send Failed\",\n\t\t\t\terror instanceof Error ? error.message : \"Failed to send email\"\n\t\t\t);\n\t\t} finally {\n\t\t\tsetIsSending(false);\n\t\t}\n\t};\n\n\tconst handleClose = () => {\n\t\tsetSubject(\"\");\n\t\tsetReplyBody(\"\");\n\t\tsetSelectedContactId(null);\n\t\tonOpenChange(false);\n\t};\n\n\tconst isNewEmail = mode === \"new\" || !thread || thread.length === 0;\n\tconst showSubjectField = isNewEmail;\n\n\t// Build email preview with auto-added content\n\tconst getEmailPreview = () => {\n\t\tif (!replyBody.trim()) return \"\";\n\n\t\tconst contactName = selectedContact\n\t\t\t? `${selectedContact.firstName || \"\"} ${\n\t\t\t\t\tselectedContact.lastName || \"\"\n\t\t\t  }`.trim() || \"Client Name\"\n\t\t\t: \"Client Name\";\n\t\tconst senderName = currentUser?.name || \"Your Name\";\n\t\tconst orgName = organization?.name || \"Organization\";\n\n\t\treturn `Hi ${contactName},\\n\\n${replyBody}\\n\\nBest regards,\\n${senderName}\\n${orgName}`;\n\t};\n\n\treturn (\n\t\t<Sheet open={isOpen} onOpenChange={onOpenChange}>\n\t\t\t<SheetContent side=\"right\" className=\"w-full sm:max-w-3xl bg-background\">\n\t\t\t\t<div className=\"flex flex-col h-full overflow-hidden\">\n\t\t\t\t\t{/* Header */}\n\t\t\t\t\t<SheetHeader className=\"border-b border-border pb-4 shrink-0\">\n\t\t\t\t\t\t<SheetTitle className=\"text-2xl font-semibold\">\n\t\t\t\t\t\t\t{thread && thread.length > 0 ? thread[0].subject : \"New Email\"}\n\t\t\t\t\t\t</SheetTitle>\n\t\t\t\t\t\t<SheetDescription className=\"text-muted-foreground\">\n\t\t\t\t\t\t\t{client\n\t\t\t\t\t\t\t\t? `Conversation with ${client.companyName}`\n\t\t\t\t\t\t\t\t: \"Loading...\"}\n\t\t\t\t\t\t\t{selectedContact && (\n\t\t\t\t\t\t\t\t<span className=\"block text-xs mt-1\">\n\t\t\t\t\t\t\t\t\tTo: {selectedContact.email}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</SheetDescription>\n\t\t\t\t\t</SheetHeader>\n\n\t\t\t\t\t{/* Thread Display - Scrollable (only show if there are messages) */}\n\t\t\t\t\t{thread && thread.length > 0 && (\n\t\t\t\t\t\t<div className=\"flex-1 overflow-y-auto py-6 px-6\">\n\t\t\t\t\t\t\t<div className=\"space-y-6\">\n\t\t\t\t\t\t\t\t{thread.map((message) => (\n\t\t\t\t\t\t\t\t\t<EmailMessageBubble key={message._id} message={message} />\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t<div ref={messagesEndRef} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{/* Empty state for new emails */}\n\t\t\t\t\t{(!thread || thread.length === 0) && (\n\t\t\t\t\t\t<div className=\"flex-1 flex items-center justify-center text-muted-foreground py-6\">\n\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t<Send className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n\t\t\t\t\t\t\t\t<p className=\"text-sm\">Start a new conversation</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{/* Compose/Reply Section - Sticky Footer */}\n\t\t\t\t\t<div className=\"border-t border-border shrink-0 bg-background\">\n\t\t\t\t\t\t<div className=\"p-6 space-y-4\">\n\t\t\t\t\t\t\t{/* Contact Selector (only for new emails) */}\n\t\t\t\t\t\t\t{showSubjectField && allContacts && allContacts.length > 0 && (\n\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\t\t\thtmlFor=\"contact-select\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium text-foreground\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\tSend To\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t<StyledSelect\n\t\t\t\t\t\t\t\t\t\tvalue={selectedContactId || \"\"}\n\t\t\t\t\t\t\t\t\t\tonValueChange={(value) =>\n\t\t\t\t\t\t\t\t\t\t\tsetSelectedContactId(value as Id<\"clientContacts\">)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<StyledSelectTrigger id=\"contact-select\">\n\t\t\t\t\t\t\t\t\t\t\t<SelectValue placeholder=\"Select a contact\" />\n\t\t\t\t\t\t\t\t\t\t</StyledSelectTrigger>\n\t\t\t\t\t\t\t\t\t\t<StyledSelectContent>\n\t\t\t\t\t\t\t\t\t\t\t{allContacts.map((contact) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<SelectItem key={contact._id} value={contact._id}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{contact.firstName} {contact.lastName}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{contact.isPrimary && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-primary\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(Primary)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{contact.email}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</SelectItem>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</StyledSelectContent>\n\t\t\t\t\t\t\t\t\t</StyledSelect>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t{/* Subject field (only for new emails) */}\n\t\t\t\t\t\t\t{showSubjectField && (\n\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\t\t\thtmlFor=\"email-subject\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium text-foreground\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\tSubject\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t<StyledInput\n\t\t\t\t\t\t\t\t\t\tid=\"email-subject\"\n\t\t\t\t\t\t\t\t\t\tvalue={subject}\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => setSubject(e.target.value)}\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Enter email subject...\"\n\t\t\t\t\t\t\t\t\t\tdisabled={isSending}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t{/* Message body */}\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\t\thtmlFor=\"reply-body\"\n\t\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium text-foreground\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{isNewEmail ? \"Message\" : \"Reply to this thread\"}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\t\tid=\"reply-body\"\n\t\t\t\t\t\t\t\t\tvalue={replyBody}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setReplyBody(e.target.value)}\n\t\t\t\t\t\t\t\t\tplaceholder=\"Type your message here...\"\n\t\t\t\t\t\t\t\t\tclassName=\"min-h-[120px] resize-none\"\n\t\t\t\t\t\t\t\t\tdisabled={isSending}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<div className=\"flex justify-between items-center text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t<span>{replyBody.length} characters</span>\n\t\t\t\t\t\t\t\t\t{/* Future: Attachment button */}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t{/* Email Preview */}\n\t\t\t\t\t\t\t\t{replyBody.trim() && (\n\t\t\t\t\t\t\t\t\t<div className=\"mt-4 p-4 rounded-lg bg-muted/50 border border-border\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-start gap-2 mb-2\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide\">\n\t\t\t\t\t\t\t\t\t\t\t\tEmail Preview\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div className=\"text-sm text-foreground/80 whitespace-pre-wrap font-mono\">\n\t\t\t\t\t\t\t\t\t\t\t{getEmailPreview()}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div className=\"mt-2 text-xs text-muted-foreground italic\">\n\t\t\t\t\t\t\t\t\t\t\tThis shows what your recipient will see (greeting and\n\t\t\t\t\t\t\t\t\t\t\tsignature are auto-added)\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"flex justify-end gap-3\">\n\t\t\t\t\t\t\t\t<StyledButton\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\tintent=\"outline\"\n\t\t\t\t\t\t\t\t\tonClick={handleClose}\n\t\t\t\t\t\t\t\t\tlabel=\"Close\"\n\t\t\t\t\t\t\t\t\tshowArrow={false}\n\t\t\t\t\t\t\t\t\tdisabled={isSending}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<StyledButton\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\tintent=\"primary\"\n\t\t\t\t\t\t\t\t\tonClick={handleSendEmail}\n\t\t\t\t\t\t\t\t\tisLoading={isSending}\n\t\t\t\t\t\t\t\t\tdisabled={\n\t\t\t\t\t\t\t\t\t\t!replyBody.trim() ||\n\t\t\t\t\t\t\t\t\t\t(showSubjectField && !subject.trim()) ||\n\t\t\t\t\t\t\t\t\t\tisSending\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t\t\t\tisSending\n\t\t\t\t\t\t\t\t\t\t\t? \"Sending...\"\n\t\t\t\t\t\t\t\t\t\t\t: isNewEmail\n\t\t\t\t\t\t\t\t\t\t\t? \"Send Email\"\n\t\t\t\t\t\t\t\t\t\t\t: \"Send Reply\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ticon={!isSending && <Send className=\"w-4 h-4\" />}\n\t\t\t\t\t\t\t\t\tshowArrow={false}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</SheetContent>\n\t\t</Sheet>\n\t);\n}\n\n// Message Bubble Component\ninterface EmailMessageBubbleProps {\n\tmessage: {\n\t\t_id: Id<\"emailMessages\">;\n\t\tdirection: \"inbound\" | \"outbound\";\n\t\tfromName: string;\n\t\tmessageBody: string;\n\t\thtmlBody?: string;\n\t\ttextBody?: string;\n\t\tsentAt: number;\n\t\tstatus: string;\n\t\tsenderName?: string;\n\t\tsenderAvatar?: string | null;\n\t\thasAttachments?: boolean;\n\t};\n}\n\nfunction EmailMessageBubble({ message }: EmailMessageBubbleProps) {\n\tconst isInbound = message.direction === \"inbound\";\n\n\t// Get attachments if any\n\tconst attachments = useQuery(\n\t\tapi.emailAttachments.listByEmail,\n\t\tmessage.hasAttachments ? { emailMessageId: message._id } : \"skip\"\n\t);\n\n\treturn (\n\t\t<div\n\t\t\tclassName={cn(\"flex gap-3\", isInbound ? \"flex-row\" : \"flex-row-reverse\")}\n\t\t>\n\t\t\t{/* Avatar */}\n\t\t\t<Avatar className=\"w-10 h-10 shrink-0\">\n\t\t\t\t<AvatarImage src={message.senderAvatar || undefined} />\n\t\t\t\t<AvatarFallback\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\tisInbound\n\t\t\t\t\t\t\t? \"bg-blue-100 text-blue-700\"\n\t\t\t\t\t\t\t: \"bg-purple-100 text-purple-700\"\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t{message.senderName?.[0] || message.fromName[0]}\n\t\t\t\t</AvatarFallback>\n\t\t\t</Avatar>\n\n\t\t\t{/* Message Content */}\n\t\t\t<div className={cn(\"flex-1 max-w-[85%] space-y-1\")}>\n\t\t\t\t<div\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"flex items-baseline gap-2\",\n\t\t\t\t\t\tisInbound ? \"flex-row\" : \"flex-row-reverse\"\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t<span className=\"text-sm font-medium\">\n\t\t\t\t\t\t{message.senderName || message.fromName}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t{formatDistanceToNow(new Date(message.sentAt), { addSuffix: true })}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"rounded-lg px-4 py-3 text-sm\",\n\t\t\t\t\t\tisInbound\n\t\t\t\t\t\t\t? \"bg-muted text-foreground\"\n\t\t\t\t\t\t\t: \"bg-primary/10 text-primary ring-1 ring-primary/20 backdrop-blur-sm shadow-sm\"\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t{/* Render HTML content if available, otherwise plain text */}\n\t\t\t\t\t{message.htmlBody ? (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"prose prose-sm max-w-none dark:prose-invert [&>*:last-child]:mb-0\"\n\t\t\t\t\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t\t\t\t\t__html: sanitizeHtml(\n\t\t\t\t\t\t\t\t\textractNewMessageContent(message.htmlBody, true)\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"whitespace-pre-wrap [&>*:last-child]:mb-0\">\n\t\t\t\t\t\t\t{extractNewMessageContent(message.messageBody, false)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{/* Attachments */}\n\t\t\t\t\t{message.hasAttachments && attachments && attachments.length > 0 && (\n\t\t\t\t\t\t<div className=\"mt-3 pt-3 border-t border-border/50 space-y-2\">\n\t\t\t\t\t\t\t{attachments.map((attachment) => (\n\t\t\t\t\t\t\t\t<AttachmentCard key={attachment._id} attachment={attachment} />\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t{/* Status indicator for outbound messages */}\n\t\t\t\t{!isInbound && (\n\t\t\t\t\t<div className=\"text-xs text-muted-foreground text-right\">\n\t\t\t\t\t\t{message.status === \"delivered\" && \"✓ Delivered\"}\n\t\t\t\t\t\t{message.status === \"opened\" && \"✓✓ Opened\"}\n\t\t\t\t\t\t{message.status === \"sent\" && \"✓ Sent\"}\n\t\t\t\t\t\t{message.status === \"bounced\" && \"⚠ Bounced\"}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\n// Attachment Card Component\ninterface AttachmentData {\n\t_id: Id<\"emailAttachments\">;\n\tfilename: string;\n\tsize: number;\n\tcontentType: string;\n}\n\nfunction AttachmentCard({ attachment }: { attachment: AttachmentData }) {\n\tconst downloadUrl = useQuery(api.emailAttachments.getDownloadUrl, {\n\t\tattachmentId: attachment._id,\n\t});\n\n\treturn (\n\t\t<a\n\t\t\thref={downloadUrl || \"#\"}\n\t\t\tdownload={attachment.filename}\n\t\t\tclassName={cn(\n\t\t\t\t\"flex items-center gap-2 p-2 rounded bg-background/50 hover:bg-background/80 transition-colors\",\n\t\t\t\t!downloadUrl && \"opacity-50 cursor-not-allowed\"\n\t\t\t)}\n\t\t\tonClick={(e) => {\n\t\t\t\tif (!downloadUrl) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}}\n\t\t>\n\t\t\t<Paperclip className=\"w-4 h-4\" />\n\t\t\t<div className=\"flex-1 min-w-0\">\n\t\t\t\t<p className=\"text-sm font-medium truncate\">{attachment.filename}</p>\n\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t{formatBytes(attachment.size)}\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<Download className=\"w-4 h-4 shrink-0\" />\n\t\t</a>\n\t);\n}\n\n// Helper functions\nfunction sanitizeHtml(html: string): string {\n\treturn DOMPurify.sanitize(html, {\n\t\tALLOWED_TAGS: [\n\t\t\t\"p\",\n\t\t\t\"br\",\n\t\t\t\"b\",\n\t\t\t\"i\",\n\t\t\t\"u\",\n\t\t\t\"strong\",\n\t\t\t\"em\",\n\t\t\t\"a\",\n\t\t\t\"ul\",\n\t\t\t\"ol\",\n\t\t\t\"li\",\n\t\t\t\"span\",\n\t\t\t\"div\",\n\t\t],\n\t\tALLOWED_ATTR: [\"href\", \"target\", \"rel\", \"class\"],\n\t});\n}\n\n/**\n * Extract the new message content from an email body, removing quoted text\n * Handles both plain text (>) and Gmail-style quotes\n */\nfunction extractNewMessageContent(\n\tbody: string,\n\tisHtml: boolean = false\n): string {\n\tif (isHtml) {\n\t\t// For HTML, remove Gmail quote blocks\n\t\tlet cleaned = body;\n\n\t\t// Remove Gmail quote blocks (everything after and including the quote)\n\t\tcleaned = cleaned.replace(\n\t\t\t/<div class=\"gmail_quote[^>]*\">[\\s\\S]*?<\\/div>/gi,\n\t\t\t\"\"\n\t\t);\n\t\tcleaned = cleaned.replace(\n\t\t\t/<blockquote[^>]*class=\"gmail_quote\"[^>]*>[\\s\\S]*?<\\/blockquote>/gi,\n\t\t\t\"\"\n\t\t);\n\n\t\t// Remove \"On ... wrote:\" lines\n\t\tcleaned = cleaned.replace(\n\t\t\t/<div[^>]*class=\"gmail_attr\"[^>]*>[\\s\\S]*?<\\/div>/gi,\n\t\t\t\"\"\n\t\t);\n\n\t\t// Remove signature divs\n\t\tcleaned = cleaned.replace(\n\t\t\t/<div[^>]*class=\"gmail_signature\"[^>]*>[\\s\\S]*?<\\/div>/gi,\n\t\t\t\"\"\n\t\t);\n\n\t\treturn cleaned.trim();\n\t} else {\n\t\t// For plain text, split by common quote indicators\n\t\tconst lines = body.split(\"\\n\");\n\t\tconst newContent: string[] = [];\n\t\tlet inQuote = false;\n\n\t\tfor (const line of lines) {\n\t\t\t// Check if this line starts a quote section\n\t\t\tif (\n\t\t\t\tline.trim().startsWith(\">\") ||\n\t\t\t\tline.match(/^On .+? wrote:$/i) ||\n\t\t\t\tline.match(/^-{3,}/) // Separator lines\n\t\t\t) {\n\t\t\t\tinQuote = true;\n\t\t\t\tbreak; // Stop collecting lines once we hit the quote\n\t\t\t}\n\n\t\t\t// Skip signature markers\n\t\t\tif (line.trim() === \"--\" || line.match(/^[-_]{2,}$/)) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (!inQuote) {\n\t\t\t\tnewContent.push(line);\n\t\t\t}\n\t\t}\n\n\t\treturn newContent.join(\"\\n\").trim();\n\t}\n}\n\nfunction formatBytes(bytes: number): string {\n\tif (bytes === 0) return \"0 Bytes\";\n\tconst k = 1024;\n\tconst sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\"];\n\tconst i = Math.floor(Math.log(bytes) / Math.log(k));\n\treturn Math.round((bytes / Math.pow(k, i)) * 100) / 100 + \" \" + sizes[i];\n}\n\nexport default EmailThreadSheet;\n","\"use client\";\n\nimport { useState } from \"react\";\nimport { useQuery } from \"convex/react\";\nimport { api } from \"@onetool/backend/convex/_generated/api\";\nimport type { Id } from \"@onetool/backend/convex/_generated/dataModel\";\nimport {\n\tPopover,\n\tPopoverContent,\n\tPopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { Mail, MailOpen, MessageSquare, Loader2 } from \"lucide-react\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { cn } from \"@/lib/utils\";\nimport { EmailThreadSheet } from \"./email-thread-sheet\";\n\ninterface EmailThreadListPopoverProps {\n\tclientId: Id<\"clients\">;\n\tchildren: React.ReactNode;\n}\n\nexport function EmailThreadListPopover({\n\tclientId,\n\tchildren,\n}: EmailThreadListPopoverProps) {\n\tconst [popoverOpen, setPopoverOpen] = useState(false);\n\tconst [sheetOpen, setSheetOpen] = useState(false);\n\tconst [selectedThreadId, setSelectedThreadId] = useState<\n\t\tstring | undefined\n\t>();\n\n\t// Fetch all email threads for this client\n\tconst threads = useQuery(api.emailMessages.listThreadsByClient, { clientId });\n\n\tconst handleThreadClick = (threadId: string) => {\n\t\tsetSelectedThreadId(threadId);\n\t\tsetPopoverOpen(false);\n\t\tsetSheetOpen(true);\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<Popover open={popoverOpen} onOpenChange={setPopoverOpen}>\n\t\t\t\t<PopoverTrigger asChild>{children}</PopoverTrigger>\n\t\t\t\t<PopoverContent\n\t\t\t\t\tclassName=\"w-96 p-0 bg-background! backdrop-blur-xl border-border shadow-xl\"\n\t\t\t\t\talign=\"end\"\n\t\t\t\t>\n\t\t\t\t\t<div className=\"flex flex-col max-h-[500px]\">\n\t\t\t\t\t\t{/* Header */}\n\t\t\t\t\t\t<div className=\"px-4 py-3 border-b border-border bg-background\">\n\t\t\t\t\t\t\t<h3 className=\"font-semibold text-sm\">Email Threads</h3>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Thread List */}\n\t\t\t\t\t\t<div className=\"overflow-y-auto bg-background\">\n\t\t\t\t\t\t\t{threads === undefined ? (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName=\"px-4 py-8 flex flex-col items-center justify-center gap-3\"\n\t\t\t\t\t\t\t\t\taria-busy=\"true\"\n\t\t\t\t\t\t\t\t\taria-live=\"polite\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\tLoading email threads...\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<span className=\"sr-only\">\n\t\t\t\t\t\t\t\t\t\tLoading email threads, please wait\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : threads.length === 0 ? (\n\t\t\t\t\t\t\t\t<div className=\"px-4 py-8 text-center text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t<MessageSquare className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n\t\t\t\t\t\t\t\t\t<p>No email threads yet</p>\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs mt-1\">\n\t\t\t\t\t\t\t\t\t\tSend an email to start a conversation\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<div className=\"divide-y divide-border\">\n\t\t\t\t\t\t\t\t\t{threads.map((thread) => (\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tkey={thread.threadId}\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleThreadClick(thread.threadId)}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full px-4 py-3 text-left hover:bg-accent transition-colors\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-start gap-3\">\n\t\t\t\t\t\t\t\t\t\t\t\t{/* Icon */}\n\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"mt-0.5\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthread.hasUnread\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"text-primary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"text-muted-foreground\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{thread.hasUnread ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Mail className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<MailOpen className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t{/* Content */}\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-baseline justify-between gap-2 mb-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<h4\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"text-sm truncate\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthread.hasUnread\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"font-semibold\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"font-medium\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{thread.subject}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-muted-foreground shrink-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatDistanceToNow(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnew Date(thread.latestMessageAt),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taddSuffix: true,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground line-clamp-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{thread.latestMessage}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 mt-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{thread.messageCount}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{thread.messageCount === 1\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"message\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"messages\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{thread.hasUnread && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs font-medium text-primary\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t• New\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</PopoverContent>\n\t\t\t</Popover>\n\n\t\t\t{/* Email Thread Sheet */}\n\t\t\t<EmailThreadSheet\n\t\t\t\tisOpen={sheetOpen}\n\t\t\t\tonOpenChange={setSheetOpen}\n\t\t\t\tclientId={clientId}\n\t\t\t\tthreadId={selectedThreadId}\n\t\t\t\tmode={selectedThreadId ? \"reply\" : \"new\"}\n\t\t\t\tonComplete={() => {\n\t\t\t\t\tsetSheetOpen(false);\n\t\t\t\t}}\n\t\t\t/>\n\t\t</>\n\t);\n}\n","\"use client\";\n\nimport { Id, Doc } from \"@onetool/backend/convex/_generated/dataModel\";\nimport { BuildingOffice2Icon, PencilIcon } from \"@heroicons/react/24/outline\";\nimport { ProminentStatusBadge } from \"@/components/shared/prominent-status-badge\";\nimport {\n\tStyledSelect,\n\tStyledSelectTrigger,\n\tStyledSelectContent,\n\tSelectValue,\n\tSelectItem,\n} from \"@/components/ui/styled\";\nimport { EmailThreadListPopover } from \"./email-thread-list-popover\";\nimport { Popover, PopoverTrigger, PopoverContent } from \"@/components/ui/popover\";\nimport { Plus, FolderOpen, Receipt, FileText, ClipboardList } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { useRouter } from \"next/navigation\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst STATUS_OPTIONS = [\n\t\"lead\",\n\t\"prospect\",\n\t\"active\",\n\t\"inactive\",\n\t\"archived\",\n] as const;\n\nfunction formatStatus(status: string): string {\n\treturn status.charAt(0).toUpperCase() + status.slice(1);\n}\n\nfunction formatDate(timestamp?: number) {\n\tif (!timestamp) return \"Not set\";\n\treturn new Date(timestamp).toLocaleDateString(\"en-US\", {\n\t\tyear: \"numeric\",\n\t\tmonth: \"long\",\n\t\tday: \"numeric\",\n\t});\n}\n\nfunction getStatusColor(status: string) {\n\tswitch (status) {\n\t\tcase \"lead\":\n\t\tcase \"prospect\":\n\t\t\treturn \"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400\";\n\t\tcase \"active\":\n\t\tcase \"paid\":\n\t\tcase \"approved\":\n\t\tcase \"completed\":\n\t\t\treturn \"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400\";\n\t\tcase \"sent\":\n\t\tcase \"pending\":\n\t\tcase \"in-progress\":\n\t\t\treturn \"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400\";\n\t\tcase \"inactive\":\n\t\tcase \"cancelled\":\n\t\tcase \"overdue\":\n\t\t\treturn \"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400\";\n\t\tcase \"draft\":\n\t\t\treturn \"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400\";\n\t\tdefault:\n\t\t\treturn \"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400\";\n\t}\n}\n\ninterface ClientHeaderProps {\n\tclient: Doc<\"clients\">;\n\tclientId: string;\n\tisEditing: boolean;\n\tonEditClick: () => void;\n\tstatusValue: string;\n\tonStatusChange: (value: string) => void;\n\temailCount: number;\n\tprojects: Doc<\"projects\">[] | undefined;\n\tquotes: Doc<\"quotes\">[] | undefined;\n\tinvoices: Doc<\"invoices\">[] | undefined;\n\ttasks: Doc<\"tasks\">[] | undefined;\n\tonTaskSheetOpen: () => void;\n}\n\nexport function ClientHeader({\n\tclient,\n\tclientId,\n\tisEditing,\n\tonEditClick,\n\tstatusValue,\n\tonStatusChange,\n\temailCount,\n\tprojects,\n\tquotes,\n\tinvoices,\n\ttasks,\n\tonTaskSheetOpen,\n}: ClientHeaderProps) {\n\tconst router = useRouter();\n\tconst toast = useToast();\n\n\treturn (\n\t\t<div className=\"mb-8\">\n\t\t\t<div className=\"flex items-start justify-between gap-6 mb-6\">\n\t\t\t\t<div className=\"flex items-start gap-6\">\n\t\t\t\t\t<div className=\"flex items-center justify-center w-16 h-16 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 dark:from-blue-600 dark:to-blue-700 shrink-0 shadow-md\">\n\t\t\t\t\t\t<BuildingOffice2Icon className=\"h-8 w-8 text-white\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"flex-1 min-w-0\">\n\t\t\t\t\t\t<div className=\"flex items-center gap-3 flex-wrap mb-2\">\n\t\t\t\t\t\t\t<h1 className=\"text-3xl font-bold text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t{client.companyName}\n\t\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t\t{isEditing ? (\n\t\t\t\t\t\t\t\t<StyledSelect value={statusValue} onValueChange={onStatusChange}>\n\t\t\t\t\t\t\t\t\t<StyledSelectTrigger className=\"w-auto\">\n\t\t\t\t\t\t\t\t\t\t<SelectValue />\n\t\t\t\t\t\t\t\t\t</StyledSelectTrigger>\n\t\t\t\t\t\t\t\t\t<StyledSelectContent>\n\t\t\t\t\t\t\t\t\t\t{STATUS_OPTIONS.map((status) => (\n\t\t\t\t\t\t\t\t\t\t\t<SelectItem key={status} value={status}>\n\t\t\t\t\t\t\t\t\t\t\t\t{formatStatus(status)}\n\t\t\t\t\t\t\t\t\t\t\t</SelectItem>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</StyledSelectContent>\n\t\t\t\t\t\t\t\t</StyledSelect>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<ProminentStatusBadge\n\t\t\t\t\t\t\t\t\tstatus={client.status}\n\t\t\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\t\t\tshowIcon={true}\n\t\t\t\t\t\t\t\t\tentityType=\"client\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{!isEditing && (\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tonClick={onEditClick}\n\t\t\t\t\t\t\t\tclassName=\"inline-flex items-center gap-2 text-sm text-primary hover:text-primary/80 font-medium transition-colors\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<PencilIcon className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\tEdit Details\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Related Items Quick Links - Salesforce inspired */}\n\t\t\t<div className=\"grid grid-cols-2 md:grid-cols-5 gap-3\">\n\t\t\t\t{/* Messages */}\n\t\t\t\t<EmailThreadListPopover clientId={clientId as Id<\"clients\">}>\n\t\t\t\t\t<button className=\"flex flex-col items-center justify-center p-4 rounded-lg border border-gray-300 dark:border-white/20 bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all\">\n\t\t\t\t\t\t<div className=\"flex items-center gap-2 mb-1\">\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\tclassName=\"w-5 h-5 text-indigo-600 dark:text-indigo-400\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\t\t\td=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<span className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t{emailCount}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span className=\"text-xs font-medium text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\tMessages\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t</EmailThreadListPopover>\n\n\t\t\t\t{/* Projects */}\n\t\t\t\t<Popover>\n\t\t\t\t\t<PopoverTrigger asChild>\n\t\t\t\t\t\t<button className=\"flex flex-col items-center justify-center p-4 rounded-lg border border-gray-300 dark:border-white/20 bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all\">\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 mb-1\">\n\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\tclassName=\"w-5 h-5 text-purple-600 dark:text-purple-400\"\n\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\t\t\t\td=\"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<span className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t{projects?.length || 0}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span className=\"text-xs font-medium text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\tProjects\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</PopoverTrigger>\n\t\t\t\t\t<PopoverContent\n\t\t\t\t\t\tclassName=\"w-96 p-0 bg-white dark:bg-gray-900\"\n\t\t\t\t\t\talign=\"start\"\n\t\t\t\t\t\tside=\"bottom\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"p-4 border-b border-gray-200 dark:border-white/10\">\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<h3 className=\"font-semibold text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\tProjects\n\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tintent=\"outline\"\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\tonPress={() =>\n\t\t\t\t\t\t\t\t\t\trouter.push(`/projects/new?clientId=${clientId}`)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Plus className=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t\t\t\t\tNew\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"max-h-96 overflow-y-auto\">\n\t\t\t\t\t\t\t{projects && projects.length > 0 ? (\n\t\t\t\t\t\t\t\t<div className=\"p-2\">\n\t\t\t\t\t\t\t\t\t{projects.map((project: Doc<\"projects\">) => (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tkey={project._id}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-white/5 rounded-lg transition-colors cursor-pointer\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => router.push(`/projects/${project._id}`)}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`w-2 h-2 rounded-full shrink-0 ${\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tproject.status === \"completed\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-green-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: project.status === \"in-progress\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-yellow-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"bg-blue-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium text-sm text-gray-900 dark:text-white truncate\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{project.title}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{project.description && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{project.description}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={getStatusColor(project.status)}\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{formatStatus(project.status)}\n\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<div className=\"p-8 text-center\">\n\t\t\t\t\t\t\t\t\t<FolderOpen className=\"h-12 w-12 text-gray-400 dark:text-gray-600 mx-auto mb-3\" />\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-500 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\t\tNo projects yet\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</PopoverContent>\n\t\t\t\t</Popover>\n\n\t\t\t\t{/* Quotes */}\n\t\t\t\t<Popover>\n\t\t\t\t\t<PopoverTrigger asChild>\n\t\t\t\t\t\t<button className=\"flex flex-col items-center justify-center p-4 rounded-lg border border-gray-300 dark:border-white/20 bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all\">\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 mb-1\">\n\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\tclassName=\"w-5 h-5 text-green-600 dark:text-green-400\"\n\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\t\t\t\td=\"M9 14l6-6m-5.5.5h.01m4.99 5h.01M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16l3.5-2 3.5 2 3.5-2 3.5 2z\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<span className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t{quotes?.length || 0}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span className=\"text-xs font-medium text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\tQuotes\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</PopoverTrigger>\n\t\t\t\t\t<PopoverContent\n\t\t\t\t\t\tclassName=\"w-96 p-0 bg-white dark:bg-gray-900\"\n\t\t\t\t\t\talign=\"start\"\n\t\t\t\t\t\tside=\"bottom\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"p-4 border-b border-gray-200 dark:border-white/10\">\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<h3 className=\"font-semibold text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\tQuotes\n\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tintent=\"outline\"\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\tonPress={() => router.push(`/quotes/new?clientId=${clientId}`)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Plus className=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t\t\t\t\tNew\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"max-h-96 overflow-y-auto\">\n\t\t\t\t\t\t\t{quotes && quotes.length > 0 ? (\n\t\t\t\t\t\t\t\t<div className=\"p-2\">\n\t\t\t\t\t\t\t\t\t{quotes.map((quote: Doc<\"quotes\">) => (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tkey={quote._id}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-white/5 rounded-lg transition-colors cursor-pointer\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => router.push(`/quotes/${quote._id}`)}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-2 h-2 rounded-full bg-blue-500 shrink-0\" />\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium text-sm text-gray-900 dark:text-white truncate\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tQuote #{quote.quoteNumber}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{quote.title && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{quote.title}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-right shrink-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t{quote.total && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium text-sm text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t${quote.total.toLocaleString()}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={getStatusColor(quote.status || \"draft\")}\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{quote.status || \"draft\"}\n\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<div className=\"p-8 text-center\">\n\t\t\t\t\t\t\t\t\t<Receipt className=\"h-12 w-12 text-gray-400 dark:text-gray-600 mx-auto mb-3\" />\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-500 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\t\tNo quotes yet\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</PopoverContent>\n\t\t\t\t</Popover>\n\n\t\t\t\t{/* Invoices */}\n\t\t\t\t<Popover>\n\t\t\t\t\t<PopoverTrigger asChild>\n\t\t\t\t\t\t<button className=\"flex flex-col items-center justify-center p-4 rounded-lg border border-gray-300 dark:border-white/20 bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all\">\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 mb-1\">\n\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\tclassName=\"w-5 h-5 text-orange-600 dark:text-orange-400\"\n\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\t\t\t\td=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<span className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t{invoices?.length || 0}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span className=\"text-xs font-medium text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\tInvoices\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</PopoverTrigger>\n\t\t\t\t\t<PopoverContent\n\t\t\t\t\t\tclassName=\"w-96 p-0 bg-white dark:bg-gray-900\"\n\t\t\t\t\t\talign=\"start\"\n\t\t\t\t\t\tside=\"bottom\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"p-4 border-b border-gray-200 dark:border-white/10\">\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<h3 className=\"font-semibold text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\tInvoices\n\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tintent=\"outline\"\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\tonPress={() =>\n\t\t\t\t\t\t\t\t\t\ttoast.info(\n\t\t\t\t\t\t\t\t\t\t\t\"Create Invoice\",\n\t\t\t\t\t\t\t\t\t\t\t\"Invoice creation functionality coming soon!\"\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Plus className=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t\t\t\t\tNew\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"max-h-96 overflow-y-auto\">\n\t\t\t\t\t\t\t{invoices && invoices.length > 0 ? (\n\t\t\t\t\t\t\t\t<div className=\"p-2\">\n\t\t\t\t\t\t\t\t\t{invoices.map((invoice: Doc<\"invoices\">) => (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tkey={invoice._id}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-white/5 rounded-lg transition-colors cursor-pointer\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\t\t\t\t\ttoast.info(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"View Invoice\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"Invoice detail page coming soon!\"\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`w-2 h-2 rounded-full shrink-0 ${\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tinvoice.status === \"paid\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-green-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: invoice.status === \"sent\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-yellow-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"bg-red-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium text-sm text-gray-900 dark:text-white truncate\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tInvoice #{invoice.invoiceNumber}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-500 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatDate(invoice._creationTime)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-right shrink-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t{invoice.total && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium text-sm text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t${invoice.total.toLocaleString()}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={getStatusColor(invoice.status)}\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{invoice.status}\n\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<div className=\"p-8 text-center\">\n\t\t\t\t\t\t\t\t\t<FileText className=\"h-12 w-12 text-gray-400 dark:text-gray-600 mx-auto mb-3\" />\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-500 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\t\tNo invoices yet\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</PopoverContent>\n\t\t\t\t</Popover>\n\n\t\t\t\t{/* Tasks */}\n\t\t\t\t<Popover>\n\t\t\t\t\t<PopoverTrigger asChild>\n\t\t\t\t\t\t<button className=\"flex flex-col items-center justify-center p-4 rounded-lg border border-gray-300 dark:border-white/20 bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all\">\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 mb-1\">\n\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\tclassName=\"w-5 h-5 text-blue-600 dark:text-blue-400\"\n\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\t\t\t\td=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<span className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t{tasks?.length || 0}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span className=\"text-xs font-medium text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\tTasks\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</PopoverTrigger>\n\t\t\t\t\t<PopoverContent\n\t\t\t\t\t\tclassName=\"w-96 p-0 bg-white dark:bg-gray-900\"\n\t\t\t\t\t\talign=\"end\"\n\t\t\t\t\t\tside=\"bottom\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"p-4 border-b border-gray-200 dark:border-white/10\">\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<h3 className=\"font-semibold text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\tTasks\n\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t<Button intent=\"outline\" size=\"sm\" onPress={onTaskSheetOpen}>\n\t\t\t\t\t\t\t\t\t<Plus className=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t\t\t\t\tNew\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"max-h-96 overflow-y-auto\">\n\t\t\t\t\t\t\t{tasks && tasks.length > 0 ? (\n\t\t\t\t\t\t\t\t<div className=\"p-2\">\n\t\t\t\t\t\t\t\t\t{tasks.map((task: Doc<\"tasks\">) => (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tkey={task._id}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-white/5 rounded-lg transition-colors\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`w-2 h-2 rounded-full shrink-0 ${\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttask.status === \"completed\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-green-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: task.status === \"cancelled\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-red-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"bg-yellow-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium text-sm text-gray-900 dark:text-white truncate\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{task.title}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{task.date && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-500 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatDate(task.date)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={getStatusColor(task.status)}\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{task.status}\n\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<div className=\"p-8 text-center\">\n\t\t\t\t\t\t\t\t\t<ClipboardList className=\"h-12 w-12 text-gray-400 dark:text-gray-600 mx-auto mb-3\" />\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-500 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\t\tNo tasks yet\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</PopoverContent>\n\t\t\t\t</Popover>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\n","\"use client\";\n\nimport { Doc } from \"@onetool/backend/convex/_generated/dataModel\";\nimport {\n\tStyledCard,\n\tStyledCardHeader,\n\tStyledCardTitle,\n\tStyledCardContent,\n\tStyledInput,\n} from \"@/components/ui/styled\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\n\n// Helper function to format lead source for display\nfunction formatLeadSource(leadSource?: string): string {\n\tif (!leadSource) return \"Not specified\";\n\treturn leadSource\n\t\t.split(\"-\")\n\t\t.map((word) => word.charAt(0).toUpperCase() + word.slice(1))\n\t\t.join(\" \");\n}\n\n// Helper function to format category for display\nfunction formatCategory(category?: string): string {\n\tif (!category) return \"Not specified\";\n\treturn category.charAt(0).toUpperCase() + category.slice(1);\n}\n\ninterface ClientDetailsCardProps {\n\tclient: Doc<\"clients\">;\n\tisEditing: boolean;\n\tform: {\n\t\tindustry: string;\n\t\tcompanyDescription: string;\n\t\tcategory: string;\n\t\tclientSize: string;\n\t\tpriorityLevel: string;\n\t\tprojectDimensions: string;\n\t};\n\tonFormChange: (field: string, value: string) => void;\n}\n\nexport function ClientDetailsCard({\n\tclient,\n\tisEditing,\n\tform,\n\tonFormChange,\n}: ClientDetailsCardProps) {\n\treturn (\n\t\t<StyledCard>\n\t\t\t<StyledCardHeader>\n\t\t\t\t<StyledCardTitle className=\"text-xl\">About</StyledCardTitle>\n\t\t\t</StyledCardHeader>\n\t\t\t<StyledCardContent>\n\t\t\t\t<div className=\"space-y-6\">\n\t\t\t\t\t{/* Two Column Grid for Fields */}\n\t\t\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6\">\n\t\t\t\t\t\t{/* Industry */}\n\t\t\t\t\t\t{(client.industry || isEditing) && (\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label className=\"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block\">\n\t\t\t\t\t\t\t\t\tIndustry\n\t\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t\t{isEditing ? (\n\t\t\t\t\t\t\t\t\t<StyledInput\n\t\t\t\t\t\t\t\t\t\tvalue={form.industry}\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => onFormChange(\"industry\", e.target.value)}\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"e.g., Technology, Healthcare\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t{client.industry}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{/* Lead Source */}\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label className=\"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block\">\n\t\t\t\t\t\t\t\tLead Source\n\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t<p className=\"text-sm text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t{formatLeadSource(client.leadSource)}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Category */}\n\t\t\t\t\t\t{(client.category || isEditing) && (\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label className=\"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block\">\n\t\t\t\t\t\t\t\t\tCategory\n\t\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t\t{isEditing ? (\n\t\t\t\t\t\t\t\t\t<StyledInput\n\t\t\t\t\t\t\t\t\t\tvalue={form.category}\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => onFormChange(\"category\", e.target.value)}\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"e.g., Enterprise, SMB\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t{formatCategory(client.category)}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{/* Client Size */}\n\t\t\t\t\t\t{(client.clientSize || isEditing) && (\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label className=\"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block\">\n\t\t\t\t\t\t\t\t\tSize\n\t\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t\t{isEditing ? (\n\t\t\t\t\t\t\t\t\t<StyledInput\n\t\t\t\t\t\t\t\t\t\tvalue={form.clientSize}\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => onFormChange(\"clientSize\", e.target.value)}\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"e.g., 1-10, 50-200\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t{formatCategory(client.clientSize)}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{/* Priority Level */}\n\t\t\t\t\t\t{(client.priorityLevel || isEditing) && (\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label className=\"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block\">\n\t\t\t\t\t\t\t\t\tPriority\n\t\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t\t{isEditing ? (\n\t\t\t\t\t\t\t\t\t<StyledInput\n\t\t\t\t\t\t\t\t\t\tvalue={form.priorityLevel}\n\t\t\t\t\t\t\t\t\t\tonChange={(e) =>\n\t\t\t\t\t\t\t\t\t\t\tonFormChange(\"priorityLevel\", e.target.value)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"e.g., High, Medium, Low\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t{formatCategory(client.priorityLevel)}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{/* Project Dimensions */}\n\t\t\t\t\t\t{(client.projectDimensions || isEditing) && (\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label className=\"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block\">\n\t\t\t\t\t\t\t\t\tProject Dimensions\n\t\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t\t{isEditing ? (\n\t\t\t\t\t\t\t\t\t<StyledInput\n\t\t\t\t\t\t\t\t\t\tvalue={form.projectDimensions}\n\t\t\t\t\t\t\t\t\t\tonChange={(e) =>\n\t\t\t\t\t\t\t\t\t\t\tonFormChange(\"projectDimensions\", e.target.value)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Enter dimensions\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t{client.projectDimensions}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Company Description - Full Width */}\n\t\t\t\t\t{(client.companyDescription || isEditing) && (\n\t\t\t\t\t\t<div className=\"pt-4 border-t border-gray-200 dark:border-white/10\">\n\t\t\t\t\t\t\t<Label className=\"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block\">\n\t\t\t\t\t\t\t\tCompany Description\n\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t{isEditing ? (\n\t\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\t\tvalue={form.companyDescription}\n\t\t\t\t\t\t\t\t\tonChange={(e) =>\n\t\t\t\t\t\t\t\t\t\tonFormChange(\"companyDescription\", e.target.value)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tplaceholder=\"Brief description of the company and what they do...\"\n\t\t\t\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t\t\t\t\trows={3}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-900 dark:text-white whitespace-pre-wrap\">\n\t\t\t\t\t\t\t\t\t{client.companyDescription}\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</StyledCardContent>\n\t\t</StyledCard>\n\t);\n}\n\n","\"use client\";\n\nimport { Doc } from \"@onetool/backend/convex/_generated/dataModel\";\nimport { Id } from \"@onetool/backend/convex/_generated/dataModel\";\nimport {\n\tStyledCard,\n\tStyledCardHeader,\n\tStyledCardTitle,\n\tStyledCardContent,\n\tStyledSelect,\n\tStyledSelectTrigger,\n\tStyledSelectContent,\n\tSelectValue,\n\tSelectItem,\n} from \"@/components/ui/styled\";\nimport { EnvelopeIcon } from \"@heroicons/react/24/outline\";\nimport { StarIcon as StarSolidIcon } from \"@heroicons/react/24/solid\";\nimport { ChevronDown, ChevronUp } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useState } from \"react\";\n\n// Helper function to format phone number for display\nfunction formatPhoneNumber(phone?: string): string {\n\tif (!phone) return \"\";\n\treturn phone;\n}\n\n// Helper function to format communication preference\nfunction formatCommunicationPreference(pref?: string): string {\n\tif (!pref) return \"Not specified\";\n\tswitch (pref) {\n\t\tcase \"email\":\n\t\t\treturn \"Email only\";\n\t\tcase \"phone\":\n\t\t\treturn \"Phone calls for urgent matters\";\n\t\tcase \"both\":\n\t\t\treturn \"Both email and phone\";\n\t\tdefault:\n\t\t\treturn pref;\n\t}\n}\n\ninterface ClientSidebarProps {\n\tclient: Doc<\"clients\">;\n\tprimaryContact: Doc<\"clientContacts\"> | null | undefined;\n\tisEditing: boolean;\n\tform: {\n\t\tcommunicationPreference: \"email\" | \"phone\" | \"both\" | \"\";\n\t};\n\tonFormChange: (field: string, value: string) => void;\n\tclientEmails: Doc<\"emailMessages\">[] | undefined;\n\tinvoices: Doc<\"invoices\">[] | undefined;\n}\n\nexport function ClientSidebar({\n\tclient,\n\tprimaryContact,\n\tisEditing,\n\tform,\n\tonFormChange,\n\tclientEmails,\n\tinvoices,\n}: ClientSidebarProps) {\n\tconst toast = useToast();\n\tconst [isLastEmailExpanded, setIsLastEmailExpanded] = useState(false);\n\n\treturn (\n\t\t<div className=\"space-y-6\">\n\t\t\t{/* Contact Info Card */}\n\t\t\t<StyledCard>\n\t\t\t\t<StyledCardHeader>\n\t\t\t\t\t<StyledCardTitle className=\"text-lg\">Contact Info</StyledCardTitle>\n\t\t\t\t</StyledCardHeader>\n\t\t\t\t<StyledCardContent className=\"space-y-4\">\n\t\t\t\t\t{primaryContact ? (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t\t\t<div className=\"flex items-start justify-between\">\n\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\t\tPrimary contact\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t\t{primaryContact.firstName} {primaryContact.lastName}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<StarSolidIcon className=\"h-4 w-4 text-yellow-400\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{primaryContact.jobTitle && (\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-start justify-between\">\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\t\t\tJob Title\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-900 dark:text-white text-right\">\n\t\t\t\t\t\t\t\t\t\t\t{primaryContact.jobTitle}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{primaryContact.phone && (\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-start justify-between\">\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\t\t\tPhone\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t\t{formatPhoneNumber(primaryContact.phone)}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{primaryContact.email && (\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-start justify-between\">\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\t\t\tEmail\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-900 dark:text-white text-right break-all\">\n\t\t\t\t\t\t\t\t\t\t\t{primaryContact.email}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/* Communication Preference */}\n\t\t\t\t\t\t\t<div className=\"pt-4 border-t border-gray-200 dark:border-white/10\">\n\t\t\t\t\t\t\t\t<div className=\"flex items-start justify-between gap-3\">\n\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\t\tCommunication Preference\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t{isEditing ? (\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 max-w-[180px]\">\n\t\t\t\t\t\t\t\t\t\t\t<StyledSelect\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={form.communicationPreference}\n\t\t\t\t\t\t\t\t\t\t\t\tonValueChange={(value) =>\n\t\t\t\t\t\t\t\t\t\t\t\t\tonFormChange(\"communicationPreference\", value)\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<StyledSelectTrigger className=\"h-8\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<SelectValue placeholder=\"Select\" />\n\t\t\t\t\t\t\t\t\t\t\t\t</StyledSelectTrigger>\n\t\t\t\t\t\t\t\t\t\t\t\t<StyledSelectContent>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<SelectItem value=\"email\">Email only</SelectItem>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<SelectItem value=\"phone\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tPhone calls for urgent matters\n\t\t\t\t\t\t\t\t\t\t\t\t\t</SelectItem>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<SelectItem value=\"both\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBoth email and phone\n\t\t\t\t\t\t\t\t\t\t\t\t\t</SelectItem>\n\t\t\t\t\t\t\t\t\t\t\t\t</StyledSelectContent>\n\t\t\t\t\t\t\t\t\t\t\t</StyledSelect>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-900 dark:text-white text-right\">\n\t\t\t\t\t\t\t\t\t\t\t{formatCommunicationPreference(\n\t\t\t\t\t\t\t\t\t\t\t\tclient.communicationPreference\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"text-center py-4\">\n\t\t\t\t\t\t\t<p className=\"text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\tNo primary contact set\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</StyledCardContent>\n\t\t\t</StyledCard>\n\n\t\t\t{/* Last Communication Card */}\n\t\t\t<StyledCard>\n\t\t\t\t<StyledCardHeader>\n\t\t\t\t\t<StyledCardTitle className=\"text-lg\">\n\t\t\t\t\t\tLast client communication\n\t\t\t\t\t</StyledCardTitle>\n\t\t\t\t</StyledCardHeader>\n\t\t\t\t<StyledCardContent>\n\t\t\t\t\t{clientEmails && clientEmails.length > 0 ? (\n\t\t\t\t\t\t(() => {\n\t\t\t\t\t\t\tconst lastEmail = clientEmails[0];\n\t\t\t\t\t\t\tconst isInbound = lastEmail.direction === \"inbound\";\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t\t\t\t{/* Email Header */}\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-start justify-between gap-2\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-start gap-2 flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={`w-2 h-2 rounded-full shrink-0 mt-1.5 ${\n\t\t\t\t\t\t\t\t\t\t\t\t\tisInbound\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-blue-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: lastEmail.status === \"delivered\" ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  lastEmail.status === \"opened\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-green-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: lastEmail.status === \"sent\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-blue-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"bg-red-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 mb-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`text-xs font-medium px-2 py-0.5 rounded ${\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisInbound\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{isInbound ? \"Inbound\" : \"Outbound\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm font-medium text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{lastEmail.subject}\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-600 dark:text-gray-400 mt-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tFrom:{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{lastEmail.fromName}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-500 dark:text-gray-400 mt-0.5\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{new Date(lastEmail.sentAt).toLocaleDateString(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"en-US\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmonth: \"short\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tday: \"numeric\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tyear: \"numeric\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thour: \"numeric\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tminute: \"2-digit\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t{/* Status Badge */}\n\t\t\t\t\t\t\t\t\t{!isInbound && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-1.5 pl-4\">\n\t\t\t\t\t\t\t\t\t\t\t{lastEmail.status === \"opened\" && (\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-purple-600 dark:text-purple-400 flex items-center gap-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-3 h-3\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\tOpened\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t{lastEmail.status === \"delivered\" && (\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-green-600 dark:text-green-400 flex items-center gap-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-3 h-3\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M5 13l4 4L19 7\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\tDelivered\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t{lastEmail.status === \"sent\" && (\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-blue-600 dark:text-blue-400 flex items-center gap-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-3 h-3\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\tSent\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t{lastEmail.status === \"bounced\" && (\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-red-600 dark:text-red-400 flex items-center gap-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-3 h-3\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\tBounced\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t{/* Expandable Message Body */}\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => setIsLastEmailExpanded(!isLastEmailExpanded)}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center gap-2 text-xs text-primary hover:text-primary/80 font-medium transition-colors w-full pl-4\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{isLastEmailExpanded ? (\n\t\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ChevronUp className=\"w-3 h-3\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\tHide message\n\t\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ChevronDown className=\"w-3 h-3\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\tShow message\n\t\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t\t{isLastEmailExpanded && (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"mt-3 pl-4\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-3 text-xs text-gray-700 dark:text-gray-300 whitespace-pre-wrap border border-gray-200 dark:border-gray-700\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{lastEmail.messageBody ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlastEmail.textBody ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlastEmail.messagePreview ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"No message content\"}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t{/* Additional emails indicator */}\n\t\t\t\t\t\t\t\t\t{clientEmails.length > 1 && (\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-500 dark:text-gray-400 italic pl-4 pt-2 border-t border-gray-200 dark:border-gray-700\">\n\t\t\t\t\t\t\t\t\t\t\t{clientEmails.length - 1} earlier message\n\t\t\t\t\t\t\t\t\t\t\t{clientEmails.length - 1 !== 1 ? \"s\" : \"\"}\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})()\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<p className=\"text-sm text-gray-600 dark:text-gray-400 italic\">\n\t\t\t\t\t\t\tYou haven&apos;t sent any client communications yet\n\t\t\t\t\t\t</p>\n\t\t\t\t\t)}\n\t\t\t\t</StyledCardContent>\n\t\t\t</StyledCard>\n\n\t\t{/* Billing Summary */}\n\t\t<StyledCard>\n\t\t\t<StyledCardHeader>\n\t\t\t\t<StyledCardTitle className=\"text-lg\">\n\t\t\t\t\tBilling summary\n\t\t\t\t</StyledCardTitle>\n\t\t\t</StyledCardHeader>\n\t\t\t\t<StyledCardContent className=\"space-y-4\">\n\t\t\t\t\t{invoices && invoices.length > 0 ? (\n\t\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t\t<div className=\"flex justify-between\">\n\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\tTotal invoices\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t{invoices.length}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex justify-between\">\n\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\tTotal billed\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t$\n\t\t\t\t\t\t\t\t\t{invoices\n\t\t\t\t\t\t\t\t\t\t.reduce(\n\t\t\t\t\t\t\t\t\t\t\t(sum: number, inv: Doc<\"invoices\">) => sum + inv.total,\n\t\t\t\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t.toLocaleString()}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex justify-between\">\n\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\t\tOutstanding\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t$\n\t\t\t\t\t\t\t\t\t{invoices\n\t\t\t\t\t\t\t\t\t\t.filter((inv: Doc<\"invoices\">) => inv.status !== \"paid\")\n\t\t\t\t\t\t\t\t\t\t.reduce(\n\t\t\t\t\t\t\t\t\t\t\t(sum: number, inv: Doc<\"invoices\">) => sum + inv.total,\n\t\t\t\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t.toLocaleString()}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"flex flex-col items-center text-center py-6\">\n\t\t\t\t\t\t\t<div className=\"w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center mb-3\">\n\t\t\t\t\t\t\t\t<EnvelopeIcon className=\"h-6 w-6 text-gray-400\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<h4 className=\"font-medium text-gray-900 dark:text-white mb-1\">\n\t\t\t\t\t\t\t\tNo billing history\n\t\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t\t<p className=\"text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t\tThis client hasn&apos;t been billed yet\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</StyledCardContent>\n\t\t\t</StyledCard>\n\t\t</div>\n\t);\n}\n\n","\"use client\";\n\nimport {\n\tStyledCard,\n\tStyledCardHeader,\n\tStyledCardTitle,\n\tStyledCardContent,\n} from \"@/components/ui/styled\";\n\ninterface ClientNotesCardProps {\n\tisEditing: boolean;\n\tnotes: string;\n\tonNotesChange: (value: string) => void;\n}\n\nexport function ClientNotesCard({\n\tisEditing,\n\tnotes,\n\tonNotesChange,\n}: ClientNotesCardProps) {\n\treturn (\n\t\t<StyledCard>\n\t\t\t<StyledCardHeader>\n\t\t\t\t<StyledCardTitle className=\"text-lg\">Client notes</StyledCardTitle>\n\t\t\t\t<p className=\"text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\tInternal notes visible only to your team\n\t\t\t\t</p>\n\t\t\t</StyledCardHeader>\n\t\t\t<StyledCardContent>\n\t\t\t\t{isEditing ? (\n\t\t\t\t\t<textarea\n\t\t\t\t\t\tclassName=\"w-full min-h-[100px] px-3 py-2 bg-gray-50 dark:bg-white/5 border border-gray-300 dark:border-white/10 rounded-md text-gray-900 dark:text-white\"\n\t\t\t\t\t\tvalue={notes}\n\t\t\t\t\t\tonChange={(e) => onNotesChange(e.target.value)}\n\t\t\t\t\t/>\n\t\t\t\t) : notes ? (\n\t\t\t\t\t<div className=\"bg-gray-50 dark:bg-gray-800/50 p-4 rounded-lg\">\n\t\t\t\t\t\t<p className=\"text-sm text-gray-900 dark:text-white whitespace-pre-wrap\">\n\t\t\t\t\t\t\t{notes}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"text-center py-6\">\n\t\t\t\t\t\t<p className=\"text-sm text-gray-600 dark:text-gray-400 italic\">\n\t\t\t\t\t\t\tNo notes added for this client yet\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</StyledCardContent>\n\t\t</StyledCard>\n\t);\n}\n\n","\"use client\";\n\nimport { Doc } from \"@onetool/backend/convex/_generated/dataModel\";\nimport {\n\tStyledCard,\n\tStyledCardHeader,\n\tStyledCardTitle,\n\tStyledCardContent,\n\tStyledTagsInput,\n} from \"@/components/ui/styled\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useState, useEffect } from \"react\";\n\ninterface ClientTagsServicesCardProps {\n\tclient: Doc<\"clients\">;\n\tisEditing: boolean;\n\ttags: string;\n\tonTagsChange: (value: string) => void;\n}\n\nexport function ClientTagsServicesCard({\n\tclient,\n\tisEditing,\n\ttags,\n\tonTagsChange,\n}: ClientTagsServicesCardProps) {\n\tconst toast = useToast();\n\tconst [tagArray, setTagArray] = useState<string[]>([]);\n\n\t// Sync the tagArray with the tags prop\n\tuseEffect(() => {\n\t\tconst parsedTags = tags\n\t\t\t? tags.split(/,\\s*/).filter(Boolean)\n\t\t\t: client.tags || [];\n\t\tsetTagArray(parsedTags);\n\t}, [tags, client.tags]);\n\n\t// Update parent when tags change\n\tconst handleTagsUpdate = (\n\t\tnewTags: string[] | ((prev: string[]) => string[])\n\t) => {\n\t\tconst resolvedTags =\n\t\t\ttypeof newTags === \"function\" ? newTags(tagArray) : newTags;\n\t\tsetTagArray(resolvedTags);\n\t\tonTagsChange(resolvedTags.join(\", \"));\n\t};\n\n\tconst handleTagAdded = (tag: string) => {\n\t\ttoast.success(\"Tag Added\", `\"${tag}\" has been added to this client.`);\n\t};\n\n\tconst handleTagRemoved = (tag: string) => {\n\t\ttoast.success(\"Tag Removed\", `\"${tag}\" has been removed from this client.`);\n\t};\n\n\treturn (\n\t\t<div className=\"space-y-6\">\n\t\t\t{/* Tags Section */}\n\t\t\t<StyledCard>\n\t\t\t\t<StyledCardHeader>\n\t\t\t\t\t<StyledCardTitle className=\"text-xl\">Tags</StyledCardTitle>\n\t\t\t\t</StyledCardHeader>\n\t\t\t\t<StyledCardContent>\n\t\t\t\t\t<StyledTagsInput\n\t\t\t\t\t\ttags={tagArray}\n\t\t\t\t\t\tsetTags={handleTagsUpdate}\n\t\t\t\t\t\tonTagAdded={handleTagAdded}\n\t\t\t\t\t\tonTagRemoved={handleTagRemoved}\n\t\t\t\t\t\tplaceholder=\"Type a tag and press Enter or comma...\"\n\t\t\t\t\t\tdisabled={!isEditing}\n\t\t\t\t\t/>\n\t\t\t\t\t{!isEditing && tagArray.length === 0 && (\n\t\t\t\t\t\t<p className=\"text-sm text-gray-600 dark:text-gray-400 italic mt-3\">\n\t\t\t\t\t\t\tThis client has no tags. Click Edit to add tags.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t)}\n\t\t\t\t</StyledCardContent>\n\t\t\t</StyledCard>\n\n\t\t\t{/* Services Needed Section */}\n\t\t\t{client.servicesNeeded && client.servicesNeeded.length > 0 && (\n\t\t\t\t<StyledCard>\n\t\t\t\t\t<StyledCardHeader>\n\t\t\t\t\t\t<StyledCardTitle className=\"text-xl\">\n\t\t\t\t\t\t\tServices needed\n\t\t\t\t\t\t</StyledCardTitle>\n\t\t\t\t\t</StyledCardHeader>\n\t\t\t\t\t<StyledCardContent>\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t{client.servicesNeeded.map((service, index) => (\n\t\t\t\t\t\t\t\t<div key={index} className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t<div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\n\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t{service}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</StyledCardContent>\n\t\t\t\t</StyledCard>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n","\"use client\";\n\nimport { useParams, useRouter } from \"next/navigation\";\nimport { useQuery, useMutation } from \"convex/react\";\nimport { api } from \"@onetool/backend/convex/_generated/api\";\nimport { Id, Doc } from \"@onetool/backend/convex/_generated/dataModel\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n\tExclamationTriangleIcon,\n\tEnvelopeIcon,\n} from \"@heroicons/react/24/outline\";\nimport { Check } from \"lucide-react\";\nimport { StickyFormFooter } from \"@/components/shared/sticky-form-footer\";\nimport { PropertyTable } from \"@/app/(workspace)/clients/components/property-table\";\nimport { ContactTable } from \"@/app/(workspace)/clients/components/contact-table\";\nimport { TaskSheet } from \"@/components/shared/task-sheet\";\nimport { MentionSection } from \"@/components/shared/mention-section\";\nimport { EmailThreadSheet } from \"@/app/(workspace)/clients/components/email-thread-sheet\";\nimport { ClientHeader } from \"@/app/(workspace)/clients/components/client-header\";\nimport { ClientDetailsCard } from \"@/app/(workspace)/clients/components/client-details-card\";\nimport { ClientSidebar } from \"@/app/(workspace)/clients/components/client-sidebar\";\nimport { ClientNotesCard } from \"@/app/(workspace)/clients/components/client-notes-card\";\nimport { ClientTagsServicesCard } from \"@/app/(workspace)/clients/components/client-tags-services-card\";\nimport {\n\tStyledTabs,\n\tStyledTabsList,\n\tStyledTabsTrigger,\n\tStyledTabsContent,\n} from \"@/components/ui/styled\";\nimport { useEffect, useMemo, useState } from \"react\";\n\nexport default function ClientDetailPage() {\n\tconst params = useParams();\n\tconst router = useRouter();\n\tconst clientId = params.clientId as string;\n\tconst toast = useToast();\n\tconst updateClient = useMutation(api.clients.update);\n\tconst [isEditing, setIsEditing] = useState(false);\n\tconst [isTaskSheetOpen, setIsTaskSheetOpen] = useState(false);\n\tconst [isEmailSheetOpen, setIsEmailSheetOpen] = useState(false);\n\tconst [emailSheetMode, setEmailSheetMode] = useState<\"new\" | \"reply\">(\"new\");\n\tconst [activeTab, setActiveTab] = useState(\"details\");\n\tconst [form, setForm] = useState({\n\t\tindustry: \"\",\n\t\tcompanyDescription: \"\",\n\t\tstatus: \"lead\",\n\t\tcategory: \"\",\n\t\tclientSize: \"\",\n\t\tpriorityLevel: \"\",\n\t\tprojectDimensions: \"\",\n\t\tcommunicationPreference: \"\" as \"email\" | \"phone\" | \"both\" | \"\",\n\t\ttags: \"\",\n\t\tnotes: \"\",\n\t});\n\n\t// Fetch client data\n\tconst client = useQuery(api.clients.get, { id: clientId as Id<\"clients\"> });\n\tconst clientContacts = useQuery(api.clientContacts.listByClient, {\n\t\tclientId: clientId as Id<\"clients\">,\n\t});\n\tconst clientProperties = useQuery(api.clientProperties.listByClient, {\n\t\tclientId: clientId as Id<\"clients\">,\n\t});\n\tconst primaryContact = useQuery(api.clientContacts.getPrimaryContact, {\n\t\tclientId: clientId as Id<\"clients\">,\n\t});\n\n\t// Fetch related data for tabs\n\tconst quotes = useQuery(api.quotes.list, {\n\t\tclientId: clientId as Id<\"clients\">,\n\t});\n\tconst projects = useQuery(api.projects.list, {\n\t\tclientId: clientId as Id<\"clients\">,\n\t});\n\tconst invoices = useQuery(api.invoices.list, {\n\t\tclientId: clientId as Id<\"clients\">,\n\t});\n\tconst clientTasks = useQuery(api.tasks.list, {\n\t\tclientId: clientId as Id<\"clients\">,\n\t});\n\n\t// Fetch email messages for this client\n\tconst clientEmails = useQuery(api.emailMessages.listByClient, {\n\t\tclientId: clientId as Id<\"clients\">,\n\t});\n\n\tuseEffect(() => {\n\t\tif (client) {\n\t\t\tsetForm({\n\t\t\t\tindustry: client.industry || \"\",\n\t\t\t\tcompanyDescription: client.companyDescription || \"\",\n\t\t\t\tstatus: client.status,\n\t\t\t\tcategory: client.category || \"\",\n\t\t\t\tclientSize: client.clientSize || \"\",\n\t\t\t\tpriorityLevel: client.priorityLevel || \"\",\n\t\t\t\tprojectDimensions: client.projectDimensions || \"\",\n\t\t\t\tcommunicationPreference: client.communicationPreference || \"\",\n\t\t\t\ttags: (client.tags || []).join(\", \"),\n\t\t\t\tnotes: client.notes || \"\",\n\t\t\t});\n\t\t}\n\t}, [client]);\n\n\tconst isDirty = useMemo(() => {\n\t\tif (!client) return false;\n\t\treturn (\n\t\t\t(form.industry || \"\") !== (client.industry || \"\") ||\n\t\t\t(form.companyDescription || \"\") !== (client.companyDescription || \"\") ||\n\t\t\tform.status !== client.status ||\n\t\t\t(form.category || \"\") !== (client.category || \"\") ||\n\t\t\t(form.clientSize || \"\") !== (client.clientSize || \"\") ||\n\t\t\t(form.priorityLevel || \"\") !== (client.priorityLevel || \"\") ||\n\t\t\t(form.projectDimensions || \"\") !== (client.projectDimensions || \"\") ||\n\t\t\t(form.communicationPreference || \"\") !==\n\t\t\t\t(client.communicationPreference || \"\") ||\n\t\t\t(form.tags || \"\") !== (client.tags || []).join(\", \") ||\n\t\t\t(form.notes || \"\") !== (client.notes || \"\")\n\t\t);\n\t}, [form, client]);\n\n\tconst handleSave = async () => {\n\t\tif (!client) return;\n\t\tconst updates: Record<string, unknown> = {};\n\t\tif ((form.industry || \"\") !== (client.industry || \"\"))\n\t\t\tupdates.industry = form.industry || undefined;\n\t\tif ((form.companyDescription || \"\") !== (client.companyDescription || \"\"))\n\t\t\tupdates.companyDescription = form.companyDescription || undefined;\n\t\tif (form.status !== client.status)\n\t\t\tupdates.status = form.status as typeof client.status;\n\t\tif ((form.category || \"\") !== (client.category || \"\"))\n\t\t\tupdates.category = form.category || undefined;\n\t\tif ((form.clientSize || \"\") !== (client.clientSize || \"\"))\n\t\t\tupdates.clientSize = form.clientSize || undefined;\n\t\tif ((form.priorityLevel || \"\") !== (client.priorityLevel || \"\"))\n\t\t\tupdates.priorityLevel = form.priorityLevel || undefined;\n\t\tif ((form.projectDimensions || \"\") !== (client.projectDimensions || \"\"))\n\t\t\tupdates.projectDimensions = form.projectDimensions || undefined;\n\t\tif (\n\t\t\t(form.communicationPreference || \"\") !==\n\t\t\t(client.communicationPreference || \"\")\n\t\t)\n\t\t\tupdates.communicationPreference =\n\t\t\t\tform.communicationPreference || undefined;\n\t\tif ((form.tags || \"\") !== (client.tags || []).join(\", \"))\n\t\t\tupdates.tags = form.tags\n\t\t\t\t? form.tags.split(/,\\s*/).filter(Boolean)\n\t\t\t\t: undefined;\n\t\tif ((form.notes || \"\") !== (client.notes || \"\"))\n\t\t\tupdates.notes = form.notes || undefined;\n\n\t\tif (Object.keys(updates).length === 0) {\n\t\t\tsetIsEditing(false);\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tawait updateClient({\n\t\t\t\tid: clientId as Id<\"clients\">,\n\t\t\t\t...updates,\n\t\t\t});\n\t\t\ttoast.success(\"Client Updated\", \"Your changes have been saved.\");\n\t\t\tsetIsEditing(false);\n\t\t} catch (err) {\n\t\t\tconst message =\n\t\t\t\terr instanceof Error ? err.message : \"Failed to save changes\";\n\t\t\ttoast.error(\"Error\", message);\n\t\t}\n\t};\n\n\t// Create sticky footer buttons based on current state\n\tconst getFooterButtons = () => {\n\t\tconst buttons = [];\n\n\t\t// Left side buttons - Primary actions\n\t\t// Always show save button, but disable when no changes\n\t\tbuttons.push({\n\t\t\tlabel: \"Save\",\n\t\t\tonClick: handleSave,\n\t\t\tintent: \"primary\" as const,\n\t\t\tdisabled: !isDirty,\n\t\t\ticon: <Check className=\"h-4 w-4\" />,\n\t\t});\n\n\t\tif (isEditing) {\n\t\t\tbuttons.push({\n\t\t\t\tlabel: \"Cancel\",\n\t\t\t\tonClick: () => {\n\t\t\t\t\tsetIsEditing(false);\n\t\t\t\t\tsetForm({\n\t\t\t\t\t\tindustry: client?.industry || \"\",\n\t\t\t\t\t\tcompanyDescription: client?.companyDescription || \"\",\n\t\t\t\t\t\tstatus: client?.status || \"lead\",\n\t\t\t\t\t\tcategory: client?.category || \"\",\n\t\t\t\t\t\tclientSize: client?.clientSize || \"\",\n\t\t\t\t\t\tpriorityLevel: client?.priorityLevel || \"\",\n\t\t\t\t\t\tprojectDimensions: client?.projectDimensions || \"\",\n\t\t\t\t\t\tcommunicationPreference: client?.communicationPreference || \"\",\n\t\t\t\t\t\ttags: (client?.tags || []).join(\", \"),\n\t\t\t\t\t\tnotes: client?.notes || \"\",\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tintent: \"outline\" as const,\n\t\t\t});\n\t\t}\n\n\t\t// Right side button - Email action\n\t\tif (primaryContact?.email && !isEditing) {\n\t\t\tbuttons.push({\n\t\t\t\tlabel: \"Send Email\",\n\t\t\t\tonClick: () => {\n\t\t\t\t\tsetEmailSheetMode(\"new\");\n\t\t\t\t\tsetIsEmailSheetOpen(true);\n\t\t\t\t},\n\t\t\t\tintent: \"secondary\" as const,\n\t\t\t\ticon: <EnvelopeIcon className=\"h-4 w-4\" />,\n\t\t\t\tposition: \"right\" as const,\n\t\t\t});\n\t\t}\n\n\t\treturn buttons;\n\t};\n\n\t// Loading state\n\tif (\n\t\tclient === undefined ||\n\t\tclientContacts === undefined ||\n\t\tclientProperties === undefined ||\n\t\tprimaryContact === undefined ||\n\t\tquotes === undefined ||\n\t\tprojects === undefined ||\n\t\tinvoices === undefined ||\n\t\tclientTasks === undefined ||\n\t\tclientEmails === undefined\n\t) {\n\t\treturn (\n\t\t\t<div className=\"relative px-6 pt-8 pb-20\">\n\t\t\t\t<div className=\"mx-auto\">\n\t\t\t\t\t<div className=\"space-y-6\">\n\t\t\t\t\t\t<Skeleton className=\"h-12 w-64\" />\n\t\t\t\t\t\t<Skeleton className=\"h-32 w-full\" />\n\t\t\t\t\t\t<Skeleton className=\"h-64 w-full\" />\n\t\t\t\t\t\t<Skeleton className=\"h-64 w-full\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t// Error state\n\tif (!client) {\n\t\treturn (\n\t\t\t<div className=\"relative px-6 pt-8 pb-20\">\n\t\t\t\t<div className=\"mx-auto\">\n\t\t\t\t\t<div className=\"flex flex-col items-center justify-center py-12 text-center\">\n\t\t\t\t\t\t<div className=\"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-lg flex items-center justify-center mb-4\">\n\t\t\t\t\t\t\t<ExclamationTriangleIcon className=\"h-8 w-8 text-red-600 dark:text-red-400\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\n\t\t\t\t\t\t\tClient not found\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<p className=\"text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\tThe client you&apos;re looking for doesn&apos;t exist or you\n\t\t\t\t\t\t\tdon&apos;t have permission to view it.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<div className=\"relative min-h-screen p-6 pb-20\">\n\t\t\t\t<div>\n\t\t\t\t\t{/* Client Header - Salesforce inspired */}\n\t\t\t\t\t<ClientHeader\n\t\t\t\t\t\tclient={client}\n\t\t\t\t\t\tclientId={clientId}\n\t\t\t\t\t\tisEditing={isEditing}\n\t\t\t\t\t\tonEditClick={() => setIsEditing(true)}\n\t\t\t\t\t\tstatusValue={form.status}\n\t\t\t\t\t\tonStatusChange={(value) =>\n\t\t\t\t\t\t\tsetForm((prev) => ({ ...prev, status: value }))\n\t\t\t\t\t\t}\n\t\t\t\t\t\temailCount={clientEmails?.length || 0}\n\t\t\t\t\t\tprojects={projects}\n\t\t\t\t\t\tquotes={quotes}\n\t\t\t\t\t\tinvoices={invoices}\n\t\t\t\t\t\ttasks={clientTasks}\n\t\t\t\t\t\tonTaskSheetOpen={() => setIsTaskSheetOpen(true)}\n\t\t\t\t\t/>\n\n\t\t\t\t\t{/* Tabs spanning full width */}\n\t\t\t\t\t<StyledTabs value={activeTab} onValueChange={setActiveTab}>\n\t\t\t\t\t\t<StyledTabsList>\n\t\t\t\t\t\t\t<StyledTabsTrigger value=\"details\">\n\t\t\t\t\t\t\t\tClient Details\n\t\t\t\t\t\t\t</StyledTabsTrigger>\n\t\t\t\t\t\t\t<StyledTabsTrigger value=\"properties\">\n\t\t\t\t\t\t\t\tProperties & Contacts\n\t\t\t\t\t\t\t</StyledTabsTrigger>\n\t\t\t\t\t\t\t<StyledTabsTrigger value=\"communication\">\n\t\t\t\t\t\t\t\tInternal Team Communication\n\t\t\t\t\t\t\t</StyledTabsTrigger>\n\t\t\t\t\t\t</StyledTabsList>\n\n\t\t\t\t\t\t{/* Two Column Layout - Tab Content & Sidebar */}\n\t\t\t\t\t\t<div className=\"grid grid-cols-1 xl:grid-cols-4 gap-6\">\n\t\t\t\t\t\t\t{/* Main Content - Left Column */}\n\t\t\t\t\t\t\t<div className=\"xl:col-span-3\">\n\t\t\t\t\t\t\t\t{/* Client Details Tab */}\n\t\t\t\t\t\t\t\t<StyledTabsContent value=\"details\" className=\"space-y-6 mt-0\">\n\t\t\t\t\t\t\t\t\t{/* About / Client Details */}\n\t\t\t\t\t\t\t\t\t<ClientDetailsCard\n\t\t\t\t\t\t\t\t\t\tclient={client}\n\t\t\t\t\t\t\t\t\t\tisEditing={isEditing}\n\t\t\t\t\t\t\t\t\t\tform={{\n\t\t\t\t\t\t\t\t\t\t\tindustry: form.industry,\n\t\t\t\t\t\t\t\t\t\t\tcompanyDescription: form.companyDescription,\n\t\t\t\t\t\t\t\t\t\t\tcategory: form.category,\n\t\t\t\t\t\t\t\t\t\t\tclientSize: form.clientSize,\n\t\t\t\t\t\t\t\t\t\t\tpriorityLevel: form.priorityLevel,\n\t\t\t\t\t\t\t\t\t\t\tprojectDimensions: form.projectDimensions,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tonFormChange={(field, value) =>\n\t\t\t\t\t\t\t\t\t\t\tsetForm((prev) => ({ ...prev, [field]: value }))\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t{/* Tags and Services Needed */}\n\t\t\t\t\t\t\t\t\t<ClientTagsServicesCard\n\t\t\t\t\t\t\t\t\t\tclient={client}\n\t\t\t\t\t\t\t\t\t\tisEditing={isEditing}\n\t\t\t\t\t\t\t\t\t\ttags={form.tags}\n\t\t\t\t\t\t\t\t\t\tonTagsChange={(value) =>\n\t\t\t\t\t\t\t\t\t\t\tsetForm((prev) => ({ ...prev, tags: value }))\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t{/* Client Notes */}\n\t\t\t\t\t\t\t\t\t<ClientNotesCard\n\t\t\t\t\t\t\t\t\t\tisEditing={isEditing}\n\t\t\t\t\t\t\t\t\t\tnotes={form.notes}\n\t\t\t\t\t\t\t\t\t\tonNotesChange={(value) =>\n\t\t\t\t\t\t\t\t\t\t\tsetForm((prev) => ({ ...prev, notes: value }))\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</StyledTabsContent>\n\n\t\t\t\t\t\t\t\t{/* Properties & Contacts Tab */}\n\t\t\t\t\t\t\t\t<StyledTabsContent\n\t\t\t\t\t\t\t\t\tvalue=\"properties\"\n\t\t\t\t\t\t\t\t\tclassName=\"space-y-6 mt-0\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{/* Properties Section */}\n\t\t\t\t\t\t\t\t\t<PropertyTable\n\t\t\t\t\t\t\t\t\t\tclientId={clientId as Id<\"clients\">}\n\t\t\t\t\t\t\t\t\t\tproperties={clientProperties || []}\n\t\t\t\t\t\t\t\t\t\tonChange={() => {\n\t\t\t\t\t\t\t\t\t\t\t// Data will automatically refresh via Convex reactivity\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t{/* Contacts Section */}\n\t\t\t\t\t\t\t\t\t<ContactTable\n\t\t\t\t\t\t\t\t\t\tclientId={clientId as Id<\"clients\">}\n\t\t\t\t\t\t\t\t\t\tcontacts={clientContacts || []}\n\t\t\t\t\t\t\t\t\t\tonChange={() => {\n\t\t\t\t\t\t\t\t\t\t\t// Data will automatically refresh via Convex reactivity\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</StyledTabsContent>\n\n\t\t\t\t\t\t\t\t{/* Internal Team Communication Tab */}\n\t\t\t\t\t\t\t\t<StyledTabsContent value=\"communication\" className=\"mt-0\">\n\t\t\t\t\t\t\t\t\t<MentionSection\n\t\t\t\t\t\t\t\t\t\tentityType=\"client\"\n\t\t\t\t\t\t\t\t\t\tentityId={clientId}\n\t\t\t\t\t\t\t\t\t\tentityName={client.companyName}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</StyledTabsContent>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{/* Sidebar - Right Column */}\n\t\t\t\t\t\t\t<div className=\"xl:col-span-1\">\n\t\t\t\t\t\t\t\t<div className=\"sticky top-24\">\n\t\t\t\t\t\t\t\t\t<ClientSidebar\n\t\t\t\t\t\t\t\t\t\tclient={client}\n\t\t\t\t\t\t\t\t\t\tprimaryContact={primaryContact}\n\t\t\t\t\t\t\t\t\t\tisEditing={isEditing}\n\t\t\t\t\t\t\t\t\t\tform={{\n\t\t\t\t\t\t\t\t\t\t\tcommunicationPreference: form.communicationPreference,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tonFormChange={(field, value) =>\n\t\t\t\t\t\t\t\t\t\t\tsetForm((prev) => ({ ...prev, [field]: value }))\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tclientEmails={clientEmails}\n\t\t\t\t\t\t\t\t\t\tinvoices={invoices}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</StyledTabs>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Email Thread Sheet - for both new emails and replies */}\n\t\t\t<EmailThreadSheet\n\t\t\t\tisOpen={isEmailSheetOpen}\n\t\t\t\tonOpenChange={setIsEmailSheetOpen}\n\t\t\t\tclientId={clientId as Id<\"clients\">}\n\t\t\t\tmode={emailSheetMode}\n\t\t\t\tonComplete={() => {\n\t\t\t\t\tsetIsEmailSheetOpen(false);\n\t\t\t\t}}\n\t\t\t/>\n\n\t\t\t<StickyFormFooter\n\t\t\t\tbuttons={getFooterButtons()}\n\t\t\t\thasUnsavedChanges={isDirty}\n\t\t\t\tisEditing={isEditing}\n\t\t\t/>\n\t\t\t<TaskSheet\n\t\t\t\tisOpen={isTaskSheetOpen}\n\t\t\t\tonOpenChange={setIsTaskSheetOpen}\n\t\t\t\tinitialValues={{\n\t\t\t\t\tclientId: clientId as Id<\"clients\">,\n\t\t\t\t}}\n\t\t\t/>\n\t\t</>\n\t);\n}\n","import * as React from \"react\";\nfunction EnvelopeIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(EnvelopeIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction BuildingOffice2Icon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M2.25 21h19.5m-18-18v18m10.5-18v18m6-13.5V21M6.75 6.75h.75m-.75 3h.75m-.75 3h.75m3-6h.75m-.75 3h.75m-.75 3h.75M6.75 21v-3.375c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21M3 3h12m-.75 4.5H21m-3.75 3.75h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(BuildingOffice2Icon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction PlusIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M12 4.5v15m7.5-7.5h-15\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(PlusIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction StarIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 24 24\",\n    fill: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z\",\n    clipRule: \"evenodd\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(StarIcon);\nexport default ForwardRef;","const {\n  entries,\n  setPrototypeOf,\n  isFrozen,\n  getPrototypeOf,\n  getOwnPropertyDescriptor,\n} = Object;\n\nlet { freeze, seal, create } = Object; // eslint-disable-line import/no-mutable-exports\nlet { apply, construct } = typeof Reflect !== 'undefined' && Reflect;\n\nif (!freeze) {\n  freeze = function <T>(x: T): T {\n    return x;\n  };\n}\n\nif (!seal) {\n  seal = function <T>(x: T): T {\n    return x;\n  };\n}\n\nif (!apply) {\n  apply = function <T>(\n    func: (thisArg: any, ...args: any[]) => T,\n    thisArg: any,\n    ...args: any[]\n  ): T {\n    return func.apply(thisArg, args);\n  };\n}\n\nif (!construct) {\n  construct = function <T>(Func: new (...args: any[]) => T, ...args: any[]): T {\n    return new Func(...args);\n  };\n}\n\nconst arrayForEach = unapply(Array.prototype.forEach);\nconst arrayIndexOf = unapply(Array.prototype.indexOf);\nconst arrayLastIndexOf = unapply(Array.prototype.lastIndexOf);\nconst arrayPop = unapply(Array.prototype.pop);\nconst arrayPush = unapply(Array.prototype.push);\nconst arraySlice = unapply(Array.prototype.slice);\nconst arraySplice = unapply(Array.prototype.splice);\n\nconst stringToLowerCase = unapply(String.prototype.toLowerCase);\nconst stringToString = unapply(String.prototype.toString);\nconst stringMatch = unapply(String.prototype.match);\nconst stringReplace = unapply(String.prototype.replace);\nconst stringIndexOf = unapply(String.prototype.indexOf);\nconst stringTrim = unapply(String.prototype.trim);\n\nconst objectHasOwnProperty = unapply(Object.prototype.hasOwnProperty);\n\nconst regExpTest = unapply(RegExp.prototype.test);\n\nconst typeErrorCreate = unconstruct(TypeError);\n\n/**\n * Creates a new function that calls the given function with a specified thisArg and arguments.\n *\n * @param func - The function to be wrapped and called.\n * @returns A new function that calls the given function with a specified thisArg and arguments.\n */\nfunction unapply<T>(\n  func: (thisArg: any, ...args: any[]) => T\n): (thisArg: any, ...args: any[]) => T {\n  return (thisArg: any, ...args: any[]): T => {\n    if (thisArg instanceof RegExp) {\n      thisArg.lastIndex = 0;\n    }\n\n    return apply(func, thisArg, args);\n  };\n}\n\n/**\n * Creates a new function that constructs an instance of the given constructor function with the provided arguments.\n *\n * @param func - The constructor function to be wrapped and called.\n * @returns A new function that constructs an instance of the given constructor function with the provided arguments.\n */\nfunction unconstruct<T>(\n  Func: new (...args: any[]) => T\n): (...args: any[]) => T {\n  return (...args: any[]): T => construct(Func, args);\n}\n\n/**\n * Add properties to a lookup table\n *\n * @param set - The set to which elements will be added.\n * @param array - The array containing elements to be added to the set.\n * @param transformCaseFunc - An optional function to transform the case of each element before adding to the set.\n * @returns The modified set with added elements.\n */\nfunction addToSet(\n  set: Record<string, any>,\n  array: readonly any[],\n  transformCaseFunc: ReturnType<typeof unapply<string>> = stringToLowerCase\n): Record<string, any> {\n  if (setPrototypeOf) {\n    // Make 'in' and truthy checks like Boolean(set.constructor)\n    // independent of any properties defined on Object.prototype.\n    // Prevent prototype setters from intercepting set as a this value.\n    setPrototypeOf(set, null);\n  }\n\n  let l = array.length;\n  while (l--) {\n    let element = array[l];\n    if (typeof element === 'string') {\n      const lcElement = transformCaseFunc(element);\n      if (lcElement !== element) {\n        // Config presets (e.g. tags.js, attrs.js) are immutable.\n        if (!isFrozen(array)) {\n          (array as any[])[l] = lcElement;\n        }\n\n        element = lcElement;\n      }\n    }\n\n    set[element] = true;\n  }\n\n  return set;\n}\n\n/**\n * Clean up an array to harden against CSPP\n *\n * @param array - The array to be cleaned.\n * @returns The cleaned version of the array\n */\nfunction cleanArray<T>(array: T[]): Array<T | null> {\n  for (let index = 0; index < array.length; index++) {\n    const isPropertyExist = objectHasOwnProperty(array, index);\n\n    if (!isPropertyExist) {\n      array[index] = null;\n    }\n  }\n\n  return array;\n}\n\n/**\n * Shallow clone an object\n *\n * @param object - The object to be cloned.\n * @returns A new object that copies the original.\n */\nfunction clone<T extends Record<string, any>>(object: T): T {\n  const newObject = create(null);\n\n  for (const [property, value] of entries(object)) {\n    const isPropertyExist = objectHasOwnProperty(object, property);\n\n    if (isPropertyExist) {\n      if (Array.isArray(value)) {\n        newObject[property] = cleanArray(value);\n      } else if (\n        value &&\n        typeof value === 'object' &&\n        value.constructor === Object\n      ) {\n        newObject[property] = clone(value);\n      } else {\n        newObject[property] = value;\n      }\n    }\n  }\n\n  return newObject;\n}\n\n/**\n * This method automatically checks if the prop is function or getter and behaves accordingly.\n *\n * @param object - The object to look up the getter function in its prototype chain.\n * @param prop - The property name for which to find the getter function.\n * @returns The getter function found in the prototype chain or a fallback function.\n */\nfunction lookupGetter<T extends Record<string, any>>(\n  object: T,\n  prop: string\n): ReturnType<typeof unapply<any>> | (() => null) {\n  while (object !== null) {\n    const desc = getOwnPropertyDescriptor(object, prop);\n\n    if (desc) {\n      if (desc.get) {\n        return unapply(desc.get);\n      }\n\n      if (typeof desc.value === 'function') {\n        return unapply(desc.value);\n      }\n    }\n\n    object = getPrototypeOf(object);\n  }\n\n  function fallbackValue(): null {\n    return null;\n  }\n\n  return fallbackValue;\n}\n\nexport {\n  // Array\n  arrayForEach,\n  arrayIndexOf,\n  arrayLastIndexOf,\n  arrayPop,\n  arrayPush,\n  arraySlice,\n  arraySplice,\n  // Object\n  entries,\n  freeze,\n  getPrototypeOf,\n  getOwnPropertyDescriptor,\n  isFrozen,\n  setPrototypeOf,\n  seal,\n  clone,\n  create,\n  objectHasOwnProperty,\n  // RegExp\n  regExpTest,\n  // String\n  stringIndexOf,\n  stringMatch,\n  stringReplace,\n  stringToLowerCase,\n  stringToString,\n  stringTrim,\n  // Errors\n  typeErrorCreate,\n  // Other\n  lookupGetter,\n  addToSet,\n  // Reflect\n  unapply,\n  unconstruct,\n};\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z',\n      key: '1jhwl8',\n    },\n  ],\n  ['path', { d: 'm22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10', key: '1qfld7' }],\n];\n\n/**\n * @component @name MailOpen\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEuMiA4LjRjLjUuMzguOC45Ny44IDEuNnYxMGEyIDIgMCAwIDEtMiAySDRhMiAyIDAgMCAxLTItMlYxMGEyIDIgMCAwIDEgLjgtMS42bDgtNmEyIDIgMCAwIDEgMi40IDBsOCA2WiIgLz4KICA8cGF0aCBkPSJtMjIgMTAtOC45NyA1LjdhMS45NCAxLjk0IDAgMCAxLTIuMDYgMEwyIDEwIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/mail-open\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst MailOpen = createLucideIcon('mail-open', __iconNode);\n\nexport default MailOpen;\n","import { freeze } from './utils.js';\n\nexport const html = freeze([\n  'a',\n  'abbr',\n  'acronym',\n  'address',\n  'area',\n  'article',\n  'aside',\n  'audio',\n  'b',\n  'bdi',\n  'bdo',\n  'big',\n  'blink',\n  'blockquote',\n  'body',\n  'br',\n  'button',\n  'canvas',\n  'caption',\n  'center',\n  'cite',\n  'code',\n  'col',\n  'colgroup',\n  'content',\n  'data',\n  'datalist',\n  'dd',\n  'decorator',\n  'del',\n  'details',\n  'dfn',\n  'dialog',\n  'dir',\n  'div',\n  'dl',\n  'dt',\n  'element',\n  'em',\n  'fieldset',\n  'figcaption',\n  'figure',\n  'font',\n  'footer',\n  'form',\n  'h1',\n  'h2',\n  'h3',\n  'h4',\n  'h5',\n  'h6',\n  'head',\n  'header',\n  'hgroup',\n  'hr',\n  'html',\n  'i',\n  'img',\n  'input',\n  'ins',\n  'kbd',\n  'label',\n  'legend',\n  'li',\n  'main',\n  'map',\n  'mark',\n  'marquee',\n  'menu',\n  'menuitem',\n  'meter',\n  'nav',\n  'nobr',\n  'ol',\n  'optgroup',\n  'option',\n  'output',\n  'p',\n  'picture',\n  'pre',\n  'progress',\n  'q',\n  'rp',\n  'rt',\n  'ruby',\n  's',\n  'samp',\n  'search',\n  'section',\n  'select',\n  'shadow',\n  'slot',\n  'small',\n  'source',\n  'spacer',\n  'span',\n  'strike',\n  'strong',\n  'style',\n  'sub',\n  'summary',\n  'sup',\n  'table',\n  'tbody',\n  'td',\n  'template',\n  'textarea',\n  'tfoot',\n  'th',\n  'thead',\n  'time',\n  'tr',\n  'track',\n  'tt',\n  'u',\n  'ul',\n  'var',\n  'video',\n  'wbr',\n] as const);\n\nexport const svg = freeze([\n  'svg',\n  'a',\n  'altglyph',\n  'altglyphdef',\n  'altglyphitem',\n  'animatecolor',\n  'animatemotion',\n  'animatetransform',\n  'circle',\n  'clippath',\n  'defs',\n  'desc',\n  'ellipse',\n  'enterkeyhint',\n  'exportparts',\n  'filter',\n  'font',\n  'g',\n  'glyph',\n  'glyphref',\n  'hkern',\n  'image',\n  'inputmode',\n  'line',\n  'lineargradient',\n  'marker',\n  'mask',\n  'metadata',\n  'mpath',\n  'part',\n  'path',\n  'pattern',\n  'polygon',\n  'polyline',\n  'radialgradient',\n  'rect',\n  'stop',\n  'style',\n  'switch',\n  'symbol',\n  'text',\n  'textpath',\n  'title',\n  'tref',\n  'tspan',\n  'view',\n  'vkern',\n] as const);\n\nexport const svgFilters = freeze([\n  'feBlend',\n  'feColorMatrix',\n  'feComponentTransfer',\n  'feComposite',\n  'feConvolveMatrix',\n  'feDiffuseLighting',\n  'feDisplacementMap',\n  'feDistantLight',\n  'feDropShadow',\n  'feFlood',\n  'feFuncA',\n  'feFuncB',\n  'feFuncG',\n  'feFuncR',\n  'feGaussianBlur',\n  'feImage',\n  'feMerge',\n  'feMergeNode',\n  'feMorphology',\n  'feOffset',\n  'fePointLight',\n  'feSpecularLighting',\n  'feSpotLight',\n  'feTile',\n  'feTurbulence',\n] as const);\n\n// List of SVG elements that are disallowed by default.\n// We still need to know them so that we can do namespace\n// checks properly in case one wants to add them to\n// allow-list.\nexport const svgDisallowed = freeze([\n  'animate',\n  'color-profile',\n  'cursor',\n  'discard',\n  'font-face',\n  'font-face-format',\n  'font-face-name',\n  'font-face-src',\n  'font-face-uri',\n  'foreignobject',\n  'hatch',\n  'hatchpath',\n  'mesh',\n  'meshgradient',\n  'meshpatch',\n  'meshrow',\n  'missing-glyph',\n  'script',\n  'set',\n  'solidcolor',\n  'unknown',\n  'use',\n] as const);\n\nexport const mathMl = freeze([\n  'math',\n  'menclose',\n  'merror',\n  'mfenced',\n  'mfrac',\n  'mglyph',\n  'mi',\n  'mlabeledtr',\n  'mmultiscripts',\n  'mn',\n  'mo',\n  'mover',\n  'mpadded',\n  'mphantom',\n  'mroot',\n  'mrow',\n  'ms',\n  'mspace',\n  'msqrt',\n  'mstyle',\n  'msub',\n  'msup',\n  'msubsup',\n  'mtable',\n  'mtd',\n  'mtext',\n  'mtr',\n  'munder',\n  'munderover',\n  'mprescripts',\n] as const);\n\n// Similarly to SVG, we want to know all MathML elements,\n// even those that we disallow by default.\nexport const mathMlDisallowed = freeze([\n  'maction',\n  'maligngroup',\n  'malignmark',\n  'mlongdiv',\n  'mscarries',\n  'mscarry',\n  'msgroup',\n  'mstack',\n  'msline',\n  'msrow',\n  'semantics',\n  'annotation',\n  'annotation-xml',\n  'mprescripts',\n  'none',\n] as const);\n\nexport const text = freeze(['#text'] as const);\n","import { freeze } from './utils.js';\n\nexport const html = freeze([\n  'accept',\n  'action',\n  'align',\n  'alt',\n  'autocapitalize',\n  'autocomplete',\n  'autopictureinpicture',\n  'autoplay',\n  'background',\n  'bgcolor',\n  'border',\n  'capture',\n  'cellpadding',\n  'cellspacing',\n  'checked',\n  'cite',\n  'class',\n  'clear',\n  'color',\n  'cols',\n  'colspan',\n  'controls',\n  'controlslist',\n  'coords',\n  'crossorigin',\n  'datetime',\n  'decoding',\n  'default',\n  'dir',\n  'disabled',\n  'disablepictureinpicture',\n  'disableremoteplayback',\n  'download',\n  'draggable',\n  'enctype',\n  'enterkeyhint',\n  'exportparts',\n  'face',\n  'for',\n  'headers',\n  'height',\n  'hidden',\n  'high',\n  'href',\n  'hreflang',\n  'id',\n  'inert',\n  'inputmode',\n  'integrity',\n  'ismap',\n  'kind',\n  'label',\n  'lang',\n  'list',\n  'loading',\n  'loop',\n  'low',\n  'max',\n  'maxlength',\n  'media',\n  'method',\n  'min',\n  'minlength',\n  'multiple',\n  'muted',\n  'name',\n  'nonce',\n  'noshade',\n  'novalidate',\n  'nowrap',\n  'open',\n  'optimum',\n  'part',\n  'pattern',\n  'placeholder',\n  'playsinline',\n  'popover',\n  'popovertarget',\n  'popovertargetaction',\n  'poster',\n  'preload',\n  'pubdate',\n  'radiogroup',\n  'readonly',\n  'rel',\n  'required',\n  'rev',\n  'reversed',\n  'role',\n  'rows',\n  'rowspan',\n  'spellcheck',\n  'scope',\n  'selected',\n  'shape',\n  'size',\n  'sizes',\n  'slot',\n  'span',\n  'srclang',\n  'start',\n  'src',\n  'srcset',\n  'step',\n  'style',\n  'summary',\n  'tabindex',\n  'title',\n  'translate',\n  'type',\n  'usemap',\n  'valign',\n  'value',\n  'width',\n  'wrap',\n  'xmlns',\n  'slot',\n] as const);\n\nexport const svg = freeze([\n  'accent-height',\n  'accumulate',\n  'additive',\n  'alignment-baseline',\n  'amplitude',\n  'ascent',\n  'attributename',\n  'attributetype',\n  'azimuth',\n  'basefrequency',\n  'baseline-shift',\n  'begin',\n  'bias',\n  'by',\n  'class',\n  'clip',\n  'clippathunits',\n  'clip-path',\n  'clip-rule',\n  'color',\n  'color-interpolation',\n  'color-interpolation-filters',\n  'color-profile',\n  'color-rendering',\n  'cx',\n  'cy',\n  'd',\n  'dx',\n  'dy',\n  'diffuseconstant',\n  'direction',\n  'display',\n  'divisor',\n  'dur',\n  'edgemode',\n  'elevation',\n  'end',\n  'exponent',\n  'fill',\n  'fill-opacity',\n  'fill-rule',\n  'filter',\n  'filterunits',\n  'flood-color',\n  'flood-opacity',\n  'font-family',\n  'font-size',\n  'font-size-adjust',\n  'font-stretch',\n  'font-style',\n  'font-variant',\n  'font-weight',\n  'fx',\n  'fy',\n  'g1',\n  'g2',\n  'glyph-name',\n  'glyphref',\n  'gradientunits',\n  'gradienttransform',\n  'height',\n  'href',\n  'id',\n  'image-rendering',\n  'in',\n  'in2',\n  'intercept',\n  'k',\n  'k1',\n  'k2',\n  'k3',\n  'k4',\n  'kerning',\n  'keypoints',\n  'keysplines',\n  'keytimes',\n  'lang',\n  'lengthadjust',\n  'letter-spacing',\n  'kernelmatrix',\n  'kernelunitlength',\n  'lighting-color',\n  'local',\n  'marker-end',\n  'marker-mid',\n  'marker-start',\n  'markerheight',\n  'markerunits',\n  'markerwidth',\n  'maskcontentunits',\n  'maskunits',\n  'max',\n  'mask',\n  'mask-type',\n  'media',\n  'method',\n  'mode',\n  'min',\n  'name',\n  'numoctaves',\n  'offset',\n  'operator',\n  'opacity',\n  'order',\n  'orient',\n  'orientation',\n  'origin',\n  'overflow',\n  'paint-order',\n  'path',\n  'pathlength',\n  'patterncontentunits',\n  'patterntransform',\n  'patternunits',\n  'points',\n  'preservealpha',\n  'preserveaspectratio',\n  'primitiveunits',\n  'r',\n  'rx',\n  'ry',\n  'radius',\n  'refx',\n  'refy',\n  'repeatcount',\n  'repeatdur',\n  'restart',\n  'result',\n  'rotate',\n  'scale',\n  'seed',\n  'shape-rendering',\n  'slope',\n  'specularconstant',\n  'specularexponent',\n  'spreadmethod',\n  'startoffset',\n  'stddeviation',\n  'stitchtiles',\n  'stop-color',\n  'stop-opacity',\n  'stroke-dasharray',\n  'stroke-dashoffset',\n  'stroke-linecap',\n  'stroke-linejoin',\n  'stroke-miterlimit',\n  'stroke-opacity',\n  'stroke',\n  'stroke-width',\n  'style',\n  'surfacescale',\n  'systemlanguage',\n  'tabindex',\n  'tablevalues',\n  'targetx',\n  'targety',\n  'transform',\n  'transform-origin',\n  'text-anchor',\n  'text-decoration',\n  'text-rendering',\n  'textlength',\n  'type',\n  'u1',\n  'u2',\n  'unicode',\n  'values',\n  'viewbox',\n  'visibility',\n  'version',\n  'vert-adv-y',\n  'vert-origin-x',\n  'vert-origin-y',\n  'width',\n  'word-spacing',\n  'wrap',\n  'writing-mode',\n  'xchannelselector',\n  'ychannelselector',\n  'x',\n  'x1',\n  'x2',\n  'xmlns',\n  'y',\n  'y1',\n  'y2',\n  'z',\n  'zoomandpan',\n] as const);\n\nexport const mathMl = freeze([\n  'accent',\n  'accentunder',\n  'align',\n  'bevelled',\n  'close',\n  'columnsalign',\n  'columnlines',\n  'columnspan',\n  'denomalign',\n  'depth',\n  'dir',\n  'display',\n  'displaystyle',\n  'encoding',\n  'fence',\n  'frame',\n  'height',\n  'href',\n  'id',\n  'largeop',\n  'length',\n  'linethickness',\n  'lspace',\n  'lquote',\n  'mathbackground',\n  'mathcolor',\n  'mathsize',\n  'mathvariant',\n  'maxsize',\n  'minsize',\n  'movablelimits',\n  'notation',\n  'numalign',\n  'open',\n  'rowalign',\n  'rowlines',\n  'rowspacing',\n  'rowspan',\n  'rspace',\n  'rquote',\n  'scriptlevel',\n  'scriptminsize',\n  'scriptsizemultiplier',\n  'selection',\n  'separator',\n  'separators',\n  'stretchy',\n  'subscriptshift',\n  'supscriptshift',\n  'symmetric',\n  'voffset',\n  'width',\n  'xmlns',\n]);\n\nexport const xml = freeze([\n  'xlink:href',\n  'xml:id',\n  'xlink:title',\n  'xml:space',\n  'xmlns:xlink',\n] as const);\n","import { seal } from './utils.js';\n\n// eslint-disable-next-line unicorn/better-regex\nexport const MUSTACHE_EXPR = seal(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode\nexport const ERB_EXPR = seal(/<%[\\w\\W]*|[\\w\\W]*%>/gm);\nexport const TMPLIT_EXPR = seal(/\\$\\{[\\w\\W]*/gm); // eslint-disable-line unicorn/better-regex\nexport const DATA_ATTR = seal(/^data-[\\-\\w.\\u00B7-\\uFFFF]+$/); // eslint-disable-line no-useless-escape\nexport const ARIA_ATTR = seal(/^aria-[\\-\\w]+$/); // eslint-disable-line no-useless-escape\nexport const IS_ALLOWED_URI = seal(\n  /^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i // eslint-disable-line no-useless-escape\n);\nexport const IS_SCRIPT_OR_DATA = seal(/^(?:\\w+script|data):/i);\nexport const ATTR_WHITESPACE = seal(\n  /[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g // eslint-disable-line no-control-regex\n);\nexport const DOCTYPE_NAME = seal(/^html$/i);\nexport const CUSTOM_ELEMENT = seal(/^[a-z][.\\w]*(-[.\\w]+)+$/i);\n","/* eslint-disable @typescript-eslint/indent */\n\nimport type {\n  TrustedHTML,\n  TrustedTypesWindow,\n} from 'trusted-types/lib/index.js';\nimport type { Config, UseProfilesConfig } from './config';\nimport * as TAGS from './tags.js';\nimport * as ATTRS from './attrs.js';\nimport * as EXPRESSIONS from './regexp.js';\nimport {\n  addToSet,\n  clone,\n  entries,\n  freeze,\n  arrayForEach,\n  arrayLastIndexOf,\n  arrayPop,\n  arrayPush,\n  arraySplice,\n  stringMatch,\n  stringReplace,\n  stringToLowerCase,\n  stringToString,\n  stringIndexOf,\n  stringTrim,\n  regExpTest,\n  typeErrorCreate,\n  lookupGetter,\n  create,\n  objectHasOwnProperty,\n} from './utils.js';\n\nexport type { Config } from './config';\n\ndeclare const VERSION: string;\n\n// https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\nconst NODE_TYPE = {\n  element: 1,\n  attribute: 2,\n  text: 3,\n  cdataSection: 4,\n  entityReference: 5, // Deprecated\n  entityNode: 6, // Deprecated\n  progressingInstruction: 7,\n  comment: 8,\n  document: 9,\n  documentType: 10,\n  documentFragment: 11,\n  notation: 12, // Deprecated\n};\n\nconst getGlobal = function (): WindowLike {\n  return typeof window === 'undefined' ? null : window;\n};\n\n/**\n * Creates a no-op policy for internal use only.\n * Don't export this function outside this module!\n * @param trustedTypes The policy factory.\n * @param purifyHostElement The Script element used to load DOMPurify (to determine policy name suffix).\n * @return The policy created (or null, if Trusted Types\n * are not supported or creating the policy failed).\n */\nconst _createTrustedTypesPolicy = function (\n  trustedTypes: TrustedTypePolicyFactory,\n  purifyHostElement: HTMLScriptElement\n) {\n  if (\n    typeof trustedTypes !== 'object' ||\n    typeof trustedTypes.createPolicy !== 'function'\n  ) {\n    return null;\n  }\n\n  // Allow the callers to control the unique policy name\n  // by adding a data-tt-policy-suffix to the script element with the DOMPurify.\n  // Policy creation with duplicate names throws in Trusted Types.\n  let suffix = null;\n  const ATTR_NAME = 'data-tt-policy-suffix';\n  if (purifyHostElement && purifyHostElement.hasAttribute(ATTR_NAME)) {\n    suffix = purifyHostElement.getAttribute(ATTR_NAME);\n  }\n\n  const policyName = 'dompurify' + (suffix ? '#' + suffix : '');\n\n  try {\n    return trustedTypes.createPolicy(policyName, {\n      createHTML(html) {\n        return html;\n      },\n      createScriptURL(scriptUrl) {\n        return scriptUrl;\n      },\n    });\n  } catch (_) {\n    // Policy creation failed (most likely another DOMPurify script has\n    // already run). Skip creating the policy, as this will only cause errors\n    // if TT are enforced.\n    console.warn(\n      'TrustedTypes policy ' + policyName + ' could not be created.'\n    );\n    return null;\n  }\n};\n\nconst _createHooksMap = function (): HooksMap {\n  return {\n    afterSanitizeAttributes: [],\n    afterSanitizeElements: [],\n    afterSanitizeShadowDOM: [],\n    beforeSanitizeAttributes: [],\n    beforeSanitizeElements: [],\n    beforeSanitizeShadowDOM: [],\n    uponSanitizeAttribute: [],\n    uponSanitizeElement: [],\n    uponSanitizeShadowNode: [],\n  };\n};\n\nfunction createDOMPurify(window: WindowLike = getGlobal()): DOMPurify {\n  const DOMPurify: DOMPurify = (root: WindowLike) => createDOMPurify(root);\n\n  DOMPurify.version = VERSION;\n\n  DOMPurify.removed = [];\n\n  if (\n    !window ||\n    !window.document ||\n    window.document.nodeType !== NODE_TYPE.document ||\n    !window.Element\n  ) {\n    // Not running in a browser, provide a factory function\n    // so that you can pass your own Window\n    DOMPurify.isSupported = false;\n\n    return DOMPurify;\n  }\n\n  let { document } = window;\n\n  const originalDocument = document;\n  const currentScript: HTMLScriptElement =\n    originalDocument.currentScript as HTMLScriptElement;\n  const {\n    DocumentFragment,\n    HTMLTemplateElement,\n    Node,\n    Element,\n    NodeFilter,\n    NamedNodeMap = window.NamedNodeMap || (window as any).MozNamedAttrMap,\n    HTMLFormElement,\n    DOMParser,\n    trustedTypes,\n  } = window;\n\n  const ElementPrototype = Element.prototype;\n\n  const cloneNode = lookupGetter(ElementPrototype, 'cloneNode');\n  const remove = lookupGetter(ElementPrototype, 'remove');\n  const getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');\n  const getChildNodes = lookupGetter(ElementPrototype, 'childNodes');\n  const getParentNode = lookupGetter(ElementPrototype, 'parentNode');\n\n  // As per issue #47, the web-components registry is inherited by a\n  // new document created via createHTMLDocument. As per the spec\n  // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n  // a new empty registry is used when creating a template contents owner\n  // document, so we use that as our parent document to ensure nothing\n  // is inherited.\n  if (typeof HTMLTemplateElement === 'function') {\n    const template = document.createElement('template');\n    if (template.content && template.content.ownerDocument) {\n      document = template.content.ownerDocument;\n    }\n  }\n\n  let trustedTypesPolicy;\n  let emptyHTML = '';\n\n  const {\n    implementation,\n    createNodeIterator,\n    createDocumentFragment,\n    getElementsByTagName,\n  } = document;\n  const { importNode } = originalDocument;\n\n  let hooks = _createHooksMap();\n\n  /**\n   * Expose whether this browser supports running the full DOMPurify.\n   */\n  DOMPurify.isSupported =\n    typeof entries === 'function' &&\n    typeof getParentNode === 'function' &&\n    implementation &&\n    implementation.createHTMLDocument !== undefined;\n\n  const {\n    MUSTACHE_EXPR,\n    ERB_EXPR,\n    TMPLIT_EXPR,\n    DATA_ATTR,\n    ARIA_ATTR,\n    IS_SCRIPT_OR_DATA,\n    ATTR_WHITESPACE,\n    CUSTOM_ELEMENT,\n  } = EXPRESSIONS;\n\n  let { IS_ALLOWED_URI } = EXPRESSIONS;\n\n  /**\n   * We consider the elements and attributes below to be safe. Ideally\n   * don't add any new ones but feel free to remove unwanted ones.\n   */\n\n  /* allowed element names */\n  let ALLOWED_TAGS = null;\n  const DEFAULT_ALLOWED_TAGS = addToSet({}, [\n    ...TAGS.html,\n    ...TAGS.svg,\n    ...TAGS.svgFilters,\n    ...TAGS.mathMl,\n    ...TAGS.text,\n  ]);\n\n  /* Allowed attribute names */\n  let ALLOWED_ATTR = null;\n  const DEFAULT_ALLOWED_ATTR = addToSet({}, [\n    ...ATTRS.html,\n    ...ATTRS.svg,\n    ...ATTRS.mathMl,\n    ...ATTRS.xml,\n  ]);\n\n  /*\n   * Configure how DOMPurify should handle custom elements and their attributes as well as customized built-in elements.\n   * @property {RegExp|Function|null} tagNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any custom elements)\n   * @property {RegExp|Function|null} attributeNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any attributes not on the allow list)\n   * @property {boolean} allowCustomizedBuiltInElements allow custom elements derived from built-ins if they pass CUSTOM_ELEMENT_HANDLING.tagNameCheck. Default: `false`.\n   */\n  let CUSTOM_ELEMENT_HANDLING = Object.seal(\n    create(null, {\n      tagNameCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null,\n      },\n      attributeNameCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null,\n      },\n      allowCustomizedBuiltInElements: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: false,\n      },\n    })\n  );\n\n  /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n  let FORBID_TAGS = null;\n\n  /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n  let FORBID_ATTR = null;\n\n  /* Config object to store ADD_TAGS/ADD_ATTR functions (when used as functions) */\n  const EXTRA_ELEMENT_HANDLING = Object.seal(\n    create(null, {\n      tagCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null,\n      },\n      attributeCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null,\n      },\n    })\n  );\n\n  /* Decide if ARIA attributes are okay */\n  let ALLOW_ARIA_ATTR = true;\n\n  /* Decide if custom data attributes are okay */\n  let ALLOW_DATA_ATTR = true;\n\n  /* Decide if unknown protocols are okay */\n  let ALLOW_UNKNOWN_PROTOCOLS = false;\n\n  /* Decide if self-closing tags in attributes are allowed.\n   * Usually removed due to a mXSS issue in jQuery 3.0 */\n  let ALLOW_SELF_CLOSE_IN_ATTR = true;\n\n  /* Output should be safe for common template engines.\n   * This means, DOMPurify removes data attributes, mustaches and ERB\n   */\n  let SAFE_FOR_TEMPLATES = false;\n\n  /* Output should be safe even for XML used within HTML and alike.\n   * This means, DOMPurify removes comments when containing risky content.\n   */\n  let SAFE_FOR_XML = true;\n\n  /* Decide if document with <html>... should be returned */\n  let WHOLE_DOCUMENT = false;\n\n  /* Track whether config is already set on this instance of DOMPurify. */\n  let SET_CONFIG = false;\n\n  /* Decide if all elements (e.g. style, script) must be children of\n   * document.body. By default, browsers might move them to document.head */\n  let FORCE_BODY = false;\n\n  /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html\n   * string (or a TrustedHTML object if Trusted Types are supported).\n   * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n   */\n  let RETURN_DOM = false;\n\n  /* Decide if a DOM `DocumentFragment` should be returned, instead of a html\n   * string  (or a TrustedHTML object if Trusted Types are supported) */\n  let RETURN_DOM_FRAGMENT = false;\n\n  /* Try to return a Trusted Type object instead of a string, return a string in\n   * case Trusted Types are not supported  */\n  let RETURN_TRUSTED_TYPE = false;\n\n  /* Output should be free from DOM clobbering attacks?\n   * This sanitizes markups named with colliding, clobberable built-in DOM APIs.\n   */\n  let SANITIZE_DOM = true;\n\n  /* Achieve full DOM Clobbering protection by isolating the namespace of named\n   * properties and JS variables, mitigating attacks that abuse the HTML/DOM spec rules.\n   *\n   * HTML/DOM spec rules that enable DOM Clobbering:\n   *   - Named Access on Window (§7.3.3)\n   *   - DOM Tree Accessors (§3.1.5)\n   *   - Form Element Parent-Child Relations (§4.10.3)\n   *   - Iframe srcdoc / Nested WindowProxies (§4.8.5)\n   *   - HTMLCollection (§4.2.10.2)\n   *\n   * Namespace isolation is implemented by prefixing `id` and `name` attributes\n   * with a constant string, i.e., `user-content-`\n   */\n  let SANITIZE_NAMED_PROPS = false;\n  const SANITIZE_NAMED_PROPS_PREFIX = 'user-content-';\n\n  /* Keep element content when removing element? */\n  let KEEP_CONTENT = true;\n\n  /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead\n   * of importing it into a new Document and returning a sanitized copy */\n  let IN_PLACE = false;\n\n  /* Allow usage of profiles like html, svg and mathMl */\n  let USE_PROFILES: UseProfilesConfig | false = {};\n\n  /* Tags to ignore content of when KEEP_CONTENT is true */\n  let FORBID_CONTENTS = null;\n  const DEFAULT_FORBID_CONTENTS = addToSet({}, [\n    'annotation-xml',\n    'audio',\n    'colgroup',\n    'desc',\n    'foreignobject',\n    'head',\n    'iframe',\n    'math',\n    'mi',\n    'mn',\n    'mo',\n    'ms',\n    'mtext',\n    'noembed',\n    'noframes',\n    'noscript',\n    'plaintext',\n    'script',\n    'style',\n    'svg',\n    'template',\n    'thead',\n    'title',\n    'video',\n    'xmp',\n  ]);\n\n  /* Tags that are safe for data: URIs */\n  let DATA_URI_TAGS = null;\n  const DEFAULT_DATA_URI_TAGS = addToSet({}, [\n    'audio',\n    'video',\n    'img',\n    'source',\n    'image',\n    'track',\n  ]);\n\n  /* Attributes safe for values like \"javascript:\" */\n  let URI_SAFE_ATTRIBUTES = null;\n  const DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, [\n    'alt',\n    'class',\n    'for',\n    'id',\n    'label',\n    'name',\n    'pattern',\n    'placeholder',\n    'role',\n    'summary',\n    'title',\n    'value',\n    'style',\n    'xmlns',\n  ]);\n\n  const MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';\n  const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n  const HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n  /* Document namespace */\n  let NAMESPACE = HTML_NAMESPACE;\n  let IS_EMPTY_INPUT = false;\n\n  /* Allowed XHTML+XML namespaces */\n  let ALLOWED_NAMESPACES = null;\n  const DEFAULT_ALLOWED_NAMESPACES = addToSet(\n    {},\n    [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE],\n    stringToString\n  );\n\n  let MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, [\n    'mi',\n    'mo',\n    'mn',\n    'ms',\n    'mtext',\n  ]);\n\n  let HTML_INTEGRATION_POINTS = addToSet({}, ['annotation-xml']);\n\n  // Certain elements are allowed in both SVG and HTML\n  // namespace. We need to specify them explicitly\n  // so that they don't get erroneously deleted from\n  // HTML namespace.\n  const COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, [\n    'title',\n    'style',\n    'font',\n    'a',\n    'script',\n  ]);\n\n  /* Parsing of strict XHTML documents */\n  let PARSER_MEDIA_TYPE: null | DOMParserSupportedType = null;\n  const SUPPORTED_PARSER_MEDIA_TYPES = ['application/xhtml+xml', 'text/html'];\n  const DEFAULT_PARSER_MEDIA_TYPE = 'text/html';\n  let transformCaseFunc: null | Parameters<typeof addToSet>[2] = null;\n\n  /* Keep a reference to config to pass to hooks */\n  let CONFIG: Config | null = null;\n\n  /* Ideally, do not touch anything below this line */\n  /* ______________________________________________ */\n\n  const formElement = document.createElement('form');\n\n  const isRegexOrFunction = function (\n    testValue: unknown\n  ): testValue is Function | RegExp {\n    return testValue instanceof RegExp || testValue instanceof Function;\n  };\n\n  /**\n   * _parseConfig\n   *\n   * @param cfg optional config literal\n   */\n  // eslint-disable-next-line complexity\n  const _parseConfig = function (cfg: Config = {}): void {\n    if (CONFIG && CONFIG === cfg) {\n      return;\n    }\n\n    /* Shield configuration object from tampering */\n    if (!cfg || typeof cfg !== 'object') {\n      cfg = {};\n    }\n\n    /* Shield configuration object from prototype pollution */\n    cfg = clone(cfg);\n\n    PARSER_MEDIA_TYPE =\n      // eslint-disable-next-line unicorn/prefer-includes\n      SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1\n        ? DEFAULT_PARSER_MEDIA_TYPE\n        : cfg.PARSER_MEDIA_TYPE;\n\n    // HTML tags and attributes are not case-sensitive, converting to lowercase. Keeping XHTML as is.\n    transformCaseFunc =\n      PARSER_MEDIA_TYPE === 'application/xhtml+xml'\n        ? stringToString\n        : stringToLowerCase;\n\n    /* Set configuration parameters */\n    ALLOWED_TAGS = objectHasOwnProperty(cfg, 'ALLOWED_TAGS')\n      ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc)\n      : DEFAULT_ALLOWED_TAGS;\n    ALLOWED_ATTR = objectHasOwnProperty(cfg, 'ALLOWED_ATTR')\n      ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc)\n      : DEFAULT_ALLOWED_ATTR;\n    ALLOWED_NAMESPACES = objectHasOwnProperty(cfg, 'ALLOWED_NAMESPACES')\n      ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString)\n      : DEFAULT_ALLOWED_NAMESPACES;\n    URI_SAFE_ATTRIBUTES = objectHasOwnProperty(cfg, 'ADD_URI_SAFE_ATTR')\n      ? addToSet(\n          clone(DEFAULT_URI_SAFE_ATTRIBUTES),\n          cfg.ADD_URI_SAFE_ATTR,\n          transformCaseFunc\n        )\n      : DEFAULT_URI_SAFE_ATTRIBUTES;\n    DATA_URI_TAGS = objectHasOwnProperty(cfg, 'ADD_DATA_URI_TAGS')\n      ? addToSet(\n          clone(DEFAULT_DATA_URI_TAGS),\n          cfg.ADD_DATA_URI_TAGS,\n          transformCaseFunc\n        )\n      : DEFAULT_DATA_URI_TAGS;\n    FORBID_CONTENTS = objectHasOwnProperty(cfg, 'FORBID_CONTENTS')\n      ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc)\n      : DEFAULT_FORBID_CONTENTS;\n    FORBID_TAGS = objectHasOwnProperty(cfg, 'FORBID_TAGS')\n      ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc)\n      : clone({});\n    FORBID_ATTR = objectHasOwnProperty(cfg, 'FORBID_ATTR')\n      ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc)\n      : clone({});\n    USE_PROFILES = objectHasOwnProperty(cfg, 'USE_PROFILES')\n      ? cfg.USE_PROFILES\n      : false;\n    ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true\n    ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true\n    ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n    ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false; // Default true\n    SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false\n    SAFE_FOR_XML = cfg.SAFE_FOR_XML !== false; // Default true\n    WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false\n    RETURN_DOM = cfg.RETURN_DOM || false; // Default false\n    RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false\n    RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false\n    FORCE_BODY = cfg.FORCE_BODY || false; // Default false\n    SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true\n    SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false; // Default false\n    KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true\n    IN_PLACE = cfg.IN_PLACE || false; // Default false\n    IS_ALLOWED_URI = cfg.ALLOWED_URI_REGEXP || EXPRESSIONS.IS_ALLOWED_URI;\n    NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;\n    MATHML_TEXT_INTEGRATION_POINTS =\n      cfg.MATHML_TEXT_INTEGRATION_POINTS || MATHML_TEXT_INTEGRATION_POINTS;\n    HTML_INTEGRATION_POINTS =\n      cfg.HTML_INTEGRATION_POINTS || HTML_INTEGRATION_POINTS;\n\n    CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};\n    if (\n      cfg.CUSTOM_ELEMENT_HANDLING &&\n      isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)\n    ) {\n      CUSTOM_ELEMENT_HANDLING.tagNameCheck =\n        cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;\n    }\n\n    if (\n      cfg.CUSTOM_ELEMENT_HANDLING &&\n      isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)\n    ) {\n      CUSTOM_ELEMENT_HANDLING.attributeNameCheck =\n        cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;\n    }\n\n    if (\n      cfg.CUSTOM_ELEMENT_HANDLING &&\n      typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements ===\n        'boolean'\n    ) {\n      CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements =\n        cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;\n    }\n\n    if (SAFE_FOR_TEMPLATES) {\n      ALLOW_DATA_ATTR = false;\n    }\n\n    if (RETURN_DOM_FRAGMENT) {\n      RETURN_DOM = true;\n    }\n\n    /* Parse profile info */\n    if (USE_PROFILES) {\n      ALLOWED_TAGS = addToSet({}, TAGS.text);\n      ALLOWED_ATTR = [];\n      if (USE_PROFILES.html === true) {\n        addToSet(ALLOWED_TAGS, TAGS.html);\n        addToSet(ALLOWED_ATTR, ATTRS.html);\n      }\n\n      if (USE_PROFILES.svg === true) {\n        addToSet(ALLOWED_TAGS, TAGS.svg);\n        addToSet(ALLOWED_ATTR, ATTRS.svg);\n        addToSet(ALLOWED_ATTR, ATTRS.xml);\n      }\n\n      if (USE_PROFILES.svgFilters === true) {\n        addToSet(ALLOWED_TAGS, TAGS.svgFilters);\n        addToSet(ALLOWED_ATTR, ATTRS.svg);\n        addToSet(ALLOWED_ATTR, ATTRS.xml);\n      }\n\n      if (USE_PROFILES.mathMl === true) {\n        addToSet(ALLOWED_TAGS, TAGS.mathMl);\n        addToSet(ALLOWED_ATTR, ATTRS.mathMl);\n        addToSet(ALLOWED_ATTR, ATTRS.xml);\n      }\n    }\n\n    /* Merge configuration parameters */\n    if (cfg.ADD_TAGS) {\n      if (typeof cfg.ADD_TAGS === 'function') {\n        EXTRA_ELEMENT_HANDLING.tagCheck = cfg.ADD_TAGS;\n      } else {\n        if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n          ALLOWED_TAGS = clone(ALLOWED_TAGS);\n        }\n\n        addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);\n      }\n    }\n\n    if (cfg.ADD_ATTR) {\n      if (typeof cfg.ADD_ATTR === 'function') {\n        EXTRA_ELEMENT_HANDLING.attributeCheck = cfg.ADD_ATTR;\n      } else {\n        if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n          ALLOWED_ATTR = clone(ALLOWED_ATTR);\n        }\n\n        addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);\n      }\n    }\n\n    if (cfg.ADD_URI_SAFE_ATTR) {\n      addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);\n    }\n\n    if (cfg.FORBID_CONTENTS) {\n      if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n        FORBID_CONTENTS = clone(FORBID_CONTENTS);\n      }\n\n      addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);\n    }\n\n    if (cfg.ADD_FORBID_CONTENTS) {\n      if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n        FORBID_CONTENTS = clone(FORBID_CONTENTS);\n      }\n\n      addToSet(FORBID_CONTENTS, cfg.ADD_FORBID_CONTENTS, transformCaseFunc);\n    }\n\n    /* Add #text in case KEEP_CONTENT is set to true */\n    if (KEEP_CONTENT) {\n      ALLOWED_TAGS['#text'] = true;\n    }\n\n    /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */\n    if (WHOLE_DOCUMENT) {\n      addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);\n    }\n\n    /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */\n    if (ALLOWED_TAGS.table) {\n      addToSet(ALLOWED_TAGS, ['tbody']);\n      delete FORBID_TAGS.tbody;\n    }\n\n    if (cfg.TRUSTED_TYPES_POLICY) {\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createHTML !== 'function') {\n        throw typeErrorCreate(\n          'TRUSTED_TYPES_POLICY configuration option must provide a \"createHTML\" hook.'\n        );\n      }\n\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL !== 'function') {\n        throw typeErrorCreate(\n          'TRUSTED_TYPES_POLICY configuration option must provide a \"createScriptURL\" hook.'\n        );\n      }\n\n      // Overwrite existing TrustedTypes policy.\n      trustedTypesPolicy = cfg.TRUSTED_TYPES_POLICY;\n\n      // Sign local variables required by `sanitize`.\n      emptyHTML = trustedTypesPolicy.createHTML('');\n    } else {\n      // Uninitialized policy, attempt to initialize the internal dompurify policy.\n      if (trustedTypesPolicy === undefined) {\n        trustedTypesPolicy = _createTrustedTypesPolicy(\n          trustedTypes,\n          currentScript\n        );\n      }\n\n      // If creating the internal policy succeeded sign internal variables.\n      if (trustedTypesPolicy !== null && typeof emptyHTML === 'string') {\n        emptyHTML = trustedTypesPolicy.createHTML('');\n      }\n    }\n\n    // Prevent further manipulation of configuration.\n    // Not available in IE8, Safari 5, etc.\n    if (freeze) {\n      freeze(cfg);\n    }\n\n    CONFIG = cfg;\n  };\n\n  /* Keep track of all possible SVG and MathML tags\n   * so that we can perform the namespace checks\n   * correctly. */\n  const ALL_SVG_TAGS = addToSet({}, [\n    ...TAGS.svg,\n    ...TAGS.svgFilters,\n    ...TAGS.svgDisallowed,\n  ]);\n  const ALL_MATHML_TAGS = addToSet({}, [\n    ...TAGS.mathMl,\n    ...TAGS.mathMlDisallowed,\n  ]);\n\n  /**\n   * @param element a DOM element whose namespace is being checked\n   * @returns Return false if the element has a\n   *  namespace that a spec-compliant parser would never\n   *  return. Return true otherwise.\n   */\n  const _checkValidNamespace = function (element: Element): boolean {\n    let parent = getParentNode(element);\n\n    // In JSDOM, if we're inside shadow DOM, then parentNode\n    // can be null. We just simulate parent in this case.\n    if (!parent || !parent.tagName) {\n      parent = {\n        namespaceURI: NAMESPACE,\n        tagName: 'template',\n      };\n    }\n\n    const tagName = stringToLowerCase(element.tagName);\n    const parentTagName = stringToLowerCase(parent.tagName);\n\n    if (!ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return false;\n    }\n\n    if (element.namespaceURI === SVG_NAMESPACE) {\n      // The only way to switch from HTML namespace to SVG\n      // is via <svg>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'svg';\n      }\n\n      // The only way to switch from MathML to SVG is via`\n      // svg if parent is either <annotation-xml> or MathML\n      // text integration points.\n      if (parent.namespaceURI === MATHML_NAMESPACE) {\n        return (\n          tagName === 'svg' &&\n          (parentTagName === 'annotation-xml' ||\n            MATHML_TEXT_INTEGRATION_POINTS[parentTagName])\n        );\n      }\n\n      // We only allow elements that are defined in SVG\n      // spec. All others are disallowed in SVG namespace.\n      return Boolean(ALL_SVG_TAGS[tagName]);\n    }\n\n    if (element.namespaceURI === MATHML_NAMESPACE) {\n      // The only way to switch from HTML namespace to MathML\n      // is via <math>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'math';\n      }\n\n      // The only way to switch from SVG to MathML is via\n      // <math> and HTML integration points\n      if (parent.namespaceURI === SVG_NAMESPACE) {\n        return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];\n      }\n\n      // We only allow elements that are defined in MathML\n      // spec. All others are disallowed in MathML namespace.\n      return Boolean(ALL_MATHML_TAGS[tagName]);\n    }\n\n    if (element.namespaceURI === HTML_NAMESPACE) {\n      // The only way to switch from SVG to HTML is via\n      // HTML integration points, and from MathML to HTML\n      // is via MathML text integration points\n      if (\n        parent.namespaceURI === SVG_NAMESPACE &&\n        !HTML_INTEGRATION_POINTS[parentTagName]\n      ) {\n        return false;\n      }\n\n      if (\n        parent.namespaceURI === MATHML_NAMESPACE &&\n        !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]\n      ) {\n        return false;\n      }\n\n      // We disallow tags that are specific for MathML\n      // or SVG and should never appear in HTML namespace\n      return (\n        !ALL_MATHML_TAGS[tagName] &&\n        (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName])\n      );\n    }\n\n    // For XHTML and XML documents that support custom namespaces\n    if (\n      PARSER_MEDIA_TYPE === 'application/xhtml+xml' &&\n      ALLOWED_NAMESPACES[element.namespaceURI]\n    ) {\n      return true;\n    }\n\n    // The code should never reach this place (this means\n    // that the element somehow got namespace that is not\n    // HTML, SVG, MathML or allowed via ALLOWED_NAMESPACES).\n    // Return false just in case.\n    return false;\n  };\n\n  /**\n   * _forceRemove\n   *\n   * @param node a DOM node\n   */\n  const _forceRemove = function (node: Node): void {\n    arrayPush(DOMPurify.removed, { element: node });\n\n    try {\n      // eslint-disable-next-line unicorn/prefer-dom-node-remove\n      getParentNode(node).removeChild(node);\n    } catch (_) {\n      remove(node);\n    }\n  };\n\n  /**\n   * _removeAttribute\n   *\n   * @param name an Attribute name\n   * @param element a DOM node\n   */\n  const _removeAttribute = function (name: string, element: Element): void {\n    try {\n      arrayPush(DOMPurify.removed, {\n        attribute: element.getAttributeNode(name),\n        from: element,\n      });\n    } catch (_) {\n      arrayPush(DOMPurify.removed, {\n        attribute: null,\n        from: element,\n      });\n    }\n\n    element.removeAttribute(name);\n\n    // We void attribute values for unremovable \"is\" attributes\n    if (name === 'is') {\n      if (RETURN_DOM || RETURN_DOM_FRAGMENT) {\n        try {\n          _forceRemove(element);\n        } catch (_) {}\n      } else {\n        try {\n          element.setAttribute(name, '');\n        } catch (_) {}\n      }\n    }\n  };\n\n  /**\n   * _initDocument\n   *\n   * @param dirty - a string of dirty markup\n   * @return a DOM, filled with the dirty markup\n   */\n  const _initDocument = function (dirty: string): Document {\n    /* Create a HTML document */\n    let doc = null;\n    let leadingWhitespace = null;\n\n    if (FORCE_BODY) {\n      dirty = '<remove></remove>' + dirty;\n    } else {\n      /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */\n      const matches = stringMatch(dirty, /^[\\r\\n\\t ]+/);\n      leadingWhitespace = matches && matches[0];\n    }\n\n    if (\n      PARSER_MEDIA_TYPE === 'application/xhtml+xml' &&\n      NAMESPACE === HTML_NAMESPACE\n    ) {\n      // Root of XHTML doc must contain xmlns declaration (see https://www.w3.org/TR/xhtml1/normative.html#strict)\n      dirty =\n        '<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body>' +\n        dirty +\n        '</body></html>';\n    }\n\n    const dirtyPayload = trustedTypesPolicy\n      ? trustedTypesPolicy.createHTML(dirty)\n      : dirty;\n    /*\n     * Use the DOMParser API by default, fallback later if needs be\n     * DOMParser not work for svg when has multiple root element.\n     */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      try {\n        doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);\n      } catch (_) {}\n    }\n\n    /* Use createHTMLDocument in case DOMParser is not available */\n    if (!doc || !doc.documentElement) {\n      doc = implementation.createDocument(NAMESPACE, 'template', null);\n      try {\n        doc.documentElement.innerHTML = IS_EMPTY_INPUT\n          ? emptyHTML\n          : dirtyPayload;\n      } catch (_) {\n        // Syntax error if dirtyPayload is invalid xml\n      }\n    }\n\n    const body = doc.body || doc.documentElement;\n\n    if (dirty && leadingWhitespace) {\n      body.insertBefore(\n        document.createTextNode(leadingWhitespace),\n        body.childNodes[0] || null\n      );\n    }\n\n    /* Work on whole document or just its body */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      return getElementsByTagName.call(\n        doc,\n        WHOLE_DOCUMENT ? 'html' : 'body'\n      )[0];\n    }\n\n    return WHOLE_DOCUMENT ? doc.documentElement : body;\n  };\n\n  /**\n   * Creates a NodeIterator object that you can use to traverse filtered lists of nodes or elements in a document.\n   *\n   * @param root The root element or node to start traversing on.\n   * @return The created NodeIterator\n   */\n  const _createNodeIterator = function (root: Node): NodeIterator {\n    return createNodeIterator.call(\n      root.ownerDocument || root,\n      root,\n      // eslint-disable-next-line no-bitwise\n      NodeFilter.SHOW_ELEMENT |\n        NodeFilter.SHOW_COMMENT |\n        NodeFilter.SHOW_TEXT |\n        NodeFilter.SHOW_PROCESSING_INSTRUCTION |\n        NodeFilter.SHOW_CDATA_SECTION,\n      null\n    );\n  };\n\n  /**\n   * _isClobbered\n   *\n   * @param element element to check for clobbering attacks\n   * @return true if clobbered, false if safe\n   */\n  const _isClobbered = function (element: Element): boolean {\n    return (\n      element instanceof HTMLFormElement &&\n      (typeof element.nodeName !== 'string' ||\n        typeof element.textContent !== 'string' ||\n        typeof element.removeChild !== 'function' ||\n        !(element.attributes instanceof NamedNodeMap) ||\n        typeof element.removeAttribute !== 'function' ||\n        typeof element.setAttribute !== 'function' ||\n        typeof element.namespaceURI !== 'string' ||\n        typeof element.insertBefore !== 'function' ||\n        typeof element.hasChildNodes !== 'function')\n    );\n  };\n\n  /**\n   * Checks whether the given object is a DOM node.\n   *\n   * @param value object to check whether it's a DOM node\n   * @return true is object is a DOM node\n   */\n  const _isNode = function (value: unknown): value is Node {\n    return typeof Node === 'function' && value instanceof Node;\n  };\n\n  function _executeHooks<T extends HookFunction>(\n    hooks: HookFunction[],\n    currentNode: Parameters<T>[0],\n    data: Parameters<T>[1]\n  ): void {\n    arrayForEach(hooks, (hook: T) => {\n      hook.call(DOMPurify, currentNode, data, CONFIG);\n    });\n  }\n\n  /**\n   * _sanitizeElements\n   *\n   * @protect nodeName\n   * @protect textContent\n   * @protect removeChild\n   * @param currentNode to check for permission to exist\n   * @return true if node was killed, false if left alive\n   */\n  const _sanitizeElements = function (currentNode: any): boolean {\n    let content = null;\n\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeElements, currentNode, null);\n\n    /* Check if element is clobbered or can clobber */\n    if (_isClobbered(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Now let's check the element's type and name */\n    const tagName = transformCaseFunc(currentNode.nodeName);\n\n    /* Execute a hook if present */\n    _executeHooks(hooks.uponSanitizeElement, currentNode, {\n      tagName,\n      allowedTags: ALLOWED_TAGS,\n    });\n\n    /* Detect mXSS attempts abusing namespace confusion */\n    if (\n      SAFE_FOR_XML &&\n      currentNode.hasChildNodes() &&\n      !_isNode(currentNode.firstElementChild) &&\n      regExpTest(/<[/\\w!]/g, currentNode.innerHTML) &&\n      regExpTest(/<[/\\w!]/g, currentNode.textContent)\n    ) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Remove any occurrence of processing instructions */\n    if (currentNode.nodeType === NODE_TYPE.progressingInstruction) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Remove any kind of possibly harmful comments */\n    if (\n      SAFE_FOR_XML &&\n      currentNode.nodeType === NODE_TYPE.comment &&\n      regExpTest(/<[/\\w]/g, currentNode.data)\n    ) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Remove element if anything forbids its presence */\n    if (\n      !(\n        EXTRA_ELEMENT_HANDLING.tagCheck instanceof Function &&\n        EXTRA_ELEMENT_HANDLING.tagCheck(tagName)\n      ) &&\n      (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName])\n    ) {\n      /* Check if we have a custom element to handle */\n      if (!FORBID_TAGS[tagName] && _isBasicCustomElement(tagName)) {\n        if (\n          CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp &&\n          regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)\n        ) {\n          return false;\n        }\n\n        if (\n          CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function &&\n          CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)\n        ) {\n          return false;\n        }\n      }\n\n      /* Keep content except for bad-listed elements */\n      if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {\n        const parentNode = getParentNode(currentNode) || currentNode.parentNode;\n        const childNodes = getChildNodes(currentNode) || currentNode.childNodes;\n\n        if (childNodes && parentNode) {\n          const childCount = childNodes.length;\n\n          for (let i = childCount - 1; i >= 0; --i) {\n            const childClone = cloneNode(childNodes[i], true);\n            childClone.__removalCount = (currentNode.__removalCount || 0) + 1;\n            parentNode.insertBefore(childClone, getNextSibling(currentNode));\n          }\n        }\n      }\n\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Check whether element has a valid namespace */\n    if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Make sure that older browsers don't get fallback-tag mXSS */\n    if (\n      (tagName === 'noscript' ||\n        tagName === 'noembed' ||\n        tagName === 'noframes') &&\n      regExpTest(/<\\/no(script|embed|frames)/i, currentNode.innerHTML)\n    ) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Sanitize element content to be template-safe */\n    if (SAFE_FOR_TEMPLATES && currentNode.nodeType === NODE_TYPE.text) {\n      /* Get the element's text content */\n      content = currentNode.textContent;\n\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], (expr: RegExp) => {\n        content = stringReplace(content, expr, ' ');\n      });\n\n      if (currentNode.textContent !== content) {\n        arrayPush(DOMPurify.removed, { element: currentNode.cloneNode() });\n        currentNode.textContent = content;\n      }\n    }\n\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeElements, currentNode, null);\n\n    return false;\n  };\n\n  /**\n   * _isValidAttribute\n   *\n   * @param lcTag Lowercase tag name of containing element.\n   * @param lcName Lowercase attribute name.\n   * @param value Attribute value.\n   * @return Returns true if `value` is valid, otherwise false.\n   */\n  // eslint-disable-next-line complexity\n  const _isValidAttribute = function (\n    lcTag: string,\n    lcName: string,\n    value: string\n  ): boolean {\n    /* Make sure attribute cannot clobber */\n    if (\n      SANITIZE_DOM &&\n      (lcName === 'id' || lcName === 'name') &&\n      (value in document || value in formElement)\n    ) {\n      return false;\n    }\n\n    /* Allow valid data-* attributes: At least one character after \"-\"\n        (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n        XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n        We don't need to check the value; it's always URI safe. */\n    if (\n      ALLOW_DATA_ATTR &&\n      !FORBID_ATTR[lcName] &&\n      regExpTest(DATA_ATTR, lcName)\n    ) {\n      // This attribute is safe\n    } else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR, lcName)) {\n      // This attribute is safe\n      /* Check if ADD_ATTR function allows this attribute */\n    } else if (\n      EXTRA_ELEMENT_HANDLING.attributeCheck instanceof Function &&\n      EXTRA_ELEMENT_HANDLING.attributeCheck(lcName, lcTag)\n    ) {\n      // This attribute is safe\n      /* Otherwise, check the name is permitted */\n    } else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {\n      if (\n        // First condition does a very basic check if a) it's basically a valid custom element tagname AND\n        // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n        // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck\n        (_isBasicCustomElement(lcTag) &&\n          ((CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp &&\n            regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag)) ||\n            (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function &&\n              CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag))) &&\n          ((CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp &&\n            regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName)) ||\n            (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function &&\n              CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName, lcTag)))) ||\n        // Alternative, second condition checks if it's an `is`-attribute, AND\n        // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n        (lcName === 'is' &&\n          CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements &&\n          ((CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp &&\n            regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value)) ||\n            (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function &&\n              CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))))\n      ) {\n        // If user has supplied a regexp or function in CUSTOM_ELEMENT_HANDLING.tagNameCheck, we need to also allow derived custom elements using the same tagName test.\n        // Additionally, we need to allow attributes passing the CUSTOM_ELEMENT_HANDLING.attributeNameCheck user has configured, as custom elements can define these at their own discretion.\n      } else {\n        return false;\n      }\n      /* Check value is safe. First, is attr inert? If so, is safe */\n    } else if (URI_SAFE_ATTRIBUTES[lcName]) {\n      // This attribute is safe\n      /* Check no script, data or unknown possibly unsafe URI\n        unless we know URI values are safe for that attribute */\n    } else if (\n      regExpTest(IS_ALLOWED_URI, stringReplace(value, ATTR_WHITESPACE, ''))\n    ) {\n      // This attribute is safe\n      /* Keep image data URIs alive if src/xlink:href is allowed */\n      /* Further prevent gadget XSS for dynamically built script tags */\n    } else if (\n      (lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') &&\n      lcTag !== 'script' &&\n      stringIndexOf(value, 'data:') === 0 &&\n      DATA_URI_TAGS[lcTag]\n    ) {\n      // This attribute is safe\n      /* Allow unknown protocols: This provides support for links that\n        are handled by protocol handlers which may be unknown ahead of\n        time, e.g. fb:, spotify: */\n    } else if (\n      ALLOW_UNKNOWN_PROTOCOLS &&\n      !regExpTest(IS_SCRIPT_OR_DATA, stringReplace(value, ATTR_WHITESPACE, ''))\n    ) {\n      // This attribute is safe\n      /* Check for binary attributes */\n    } else if (value) {\n      return false;\n    } else {\n      // Binary attributes are safe at this point\n      /* Anything else, presume unsafe, do not add it back */\n    }\n\n    return true;\n  };\n\n  /**\n   * _isBasicCustomElement\n   * checks if at least one dash is included in tagName, and it's not the first char\n   * for more sophisticated checking see https://github.com/sindresorhus/validate-element-name\n   *\n   * @param tagName name of the tag of the node to sanitize\n   * @returns Returns true if the tag name meets the basic criteria for a custom element, otherwise false.\n   */\n  const _isBasicCustomElement = function (tagName: string): RegExpMatchArray {\n    return tagName !== 'annotation-xml' && stringMatch(tagName, CUSTOM_ELEMENT);\n  };\n\n  /**\n   * _sanitizeAttributes\n   *\n   * @protect attributes\n   * @protect nodeName\n   * @protect removeAttribute\n   * @protect setAttribute\n   *\n   * @param currentNode to sanitize\n   */\n  const _sanitizeAttributes = function (currentNode: Element): void {\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeAttributes, currentNode, null);\n\n    const { attributes } = currentNode;\n\n    /* Check if we have attributes; if not we might have a text node */\n    if (!attributes || _isClobbered(currentNode)) {\n      return;\n    }\n\n    const hookEvent = {\n      attrName: '',\n      attrValue: '',\n      keepAttr: true,\n      allowedAttributes: ALLOWED_ATTR,\n      forceKeepAttr: undefined,\n    };\n    let l = attributes.length;\n\n    /* Go backwards over all attributes; safely remove bad ones */\n    while (l--) {\n      const attr = attributes[l];\n      const { name, namespaceURI, value: attrValue } = attr;\n      const lcName = transformCaseFunc(name);\n\n      const initValue = attrValue;\n      let value = name === 'value' ? initValue : stringTrim(initValue);\n\n      /* Execute a hook if present */\n      hookEvent.attrName = lcName;\n      hookEvent.attrValue = value;\n      hookEvent.keepAttr = true;\n      hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set\n      _executeHooks(hooks.uponSanitizeAttribute, currentNode, hookEvent);\n      value = hookEvent.attrValue;\n\n      /* Full DOM Clobbering protection via namespace isolation,\n       * Prefix id and name attributes with `user-content-`\n       */\n      if (SANITIZE_NAMED_PROPS && (lcName === 'id' || lcName === 'name')) {\n        // Remove the attribute with this value\n        _removeAttribute(name, currentNode);\n\n        // Prefix the value and later re-create the attribute with the sanitized value\n        value = SANITIZE_NAMED_PROPS_PREFIX + value;\n      }\n\n      /* Work around a security issue with comments inside attributes */\n      if (\n        SAFE_FOR_XML &&\n        regExpTest(/((--!?|])>)|<\\/(style|title|textarea)/i, value)\n      ) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n\n      /* Make sure we cannot easily use animated hrefs, even if animations are allowed */\n      if (lcName === 'attributename' && stringMatch(value, 'href')) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n\n      /* Did the hooks approve of the attribute? */\n      if (hookEvent.forceKeepAttr) {\n        continue;\n      }\n\n      /* Did the hooks approve of the attribute? */\n      if (!hookEvent.keepAttr) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n\n      /* Work around a security issue in jQuery 3.0 */\n      if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\\/>/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n\n      /* Sanitize attribute content to be template-safe */\n      if (SAFE_FOR_TEMPLATES) {\n        arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], (expr: RegExp) => {\n          value = stringReplace(value, expr, ' ');\n        });\n      }\n\n      /* Is `value` valid for this attribute? */\n      const lcTag = transformCaseFunc(currentNode.nodeName);\n      if (!_isValidAttribute(lcTag, lcName, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n\n      /* Handle attributes that require Trusted Types */\n      if (\n        trustedTypesPolicy &&\n        typeof trustedTypes === 'object' &&\n        typeof trustedTypes.getAttributeType === 'function'\n      ) {\n        if (namespaceURI) {\n          /* Namespaces are not yet supported, see https://bugs.chromium.org/p/chromium/issues/detail?id=1305293 */\n        } else {\n          switch (trustedTypes.getAttributeType(lcTag, lcName)) {\n            case 'TrustedHTML': {\n              value = trustedTypesPolicy.createHTML(value);\n              break;\n            }\n\n            case 'TrustedScriptURL': {\n              value = trustedTypesPolicy.createScriptURL(value);\n              break;\n            }\n\n            default: {\n              break;\n            }\n          }\n        }\n      }\n\n      /* Handle invalid data-* attribute set by try-catching it */\n      if (value !== initValue) {\n        try {\n          if (namespaceURI) {\n            currentNode.setAttributeNS(namespaceURI, name, value);\n          } else {\n            /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. \"x-schema\". */\n            currentNode.setAttribute(name, value);\n          }\n\n          if (_isClobbered(currentNode)) {\n            _forceRemove(currentNode);\n          } else {\n            arrayPop(DOMPurify.removed);\n          }\n        } catch (_) {\n          _removeAttribute(name, currentNode);\n        }\n      }\n    }\n\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeAttributes, currentNode, null);\n  };\n\n  /**\n   * _sanitizeShadowDOM\n   *\n   * @param fragment to iterate over recursively\n   */\n  const _sanitizeShadowDOM = function (fragment: DocumentFragment): void {\n    let shadowNode = null;\n    const shadowIterator = _createNodeIterator(fragment);\n\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeShadowDOM, fragment, null);\n\n    while ((shadowNode = shadowIterator.nextNode())) {\n      /* Execute a hook if present */\n      _executeHooks(hooks.uponSanitizeShadowNode, shadowNode, null);\n\n      /* Sanitize tags and elements */\n      _sanitizeElements(shadowNode);\n\n      /* Check attributes next */\n      _sanitizeAttributes(shadowNode);\n\n      /* Deep shadow DOM detected */\n      if (shadowNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(shadowNode.content);\n      }\n    }\n\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeShadowDOM, fragment, null);\n  };\n\n  // eslint-disable-next-line complexity\n  DOMPurify.sanitize = function (dirty, cfg = {}) {\n    let body = null;\n    let importedNode = null;\n    let currentNode = null;\n    let returnNode = null;\n    /* Make sure we have a string to sanitize.\n      DO NOT return early, as this will return the wrong type if\n      the user has requested a DOM object rather than a string */\n    IS_EMPTY_INPUT = !dirty;\n    if (IS_EMPTY_INPUT) {\n      dirty = '<!-->';\n    }\n\n    /* Stringify, in case dirty is an object */\n    if (typeof dirty !== 'string' && !_isNode(dirty)) {\n      if (typeof dirty.toString === 'function') {\n        dirty = dirty.toString();\n        if (typeof dirty !== 'string') {\n          throw typeErrorCreate('dirty is not a string, aborting');\n        }\n      } else {\n        throw typeErrorCreate('toString is not a function');\n      }\n    }\n\n    /* Return dirty HTML if DOMPurify cannot run */\n    if (!DOMPurify.isSupported) {\n      return dirty;\n    }\n\n    /* Assign config vars */\n    if (!SET_CONFIG) {\n      _parseConfig(cfg);\n    }\n\n    /* Clean up removed elements */\n    DOMPurify.removed = [];\n\n    /* Check if dirty is correctly typed for IN_PLACE */\n    if (typeof dirty === 'string') {\n      IN_PLACE = false;\n    }\n\n    if (IN_PLACE) {\n      /* Do some early pre-sanitization to avoid unsafe root nodes */\n      if ((dirty as Node).nodeName) {\n        const tagName = transformCaseFunc((dirty as Node).nodeName);\n        if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n          throw typeErrorCreate(\n            'root node is forbidden and cannot be sanitized in-place'\n          );\n        }\n      }\n    } else if (dirty instanceof Node) {\n      /* If dirty is a DOM element, append to an empty document to avoid\n         elements being stripped by the parser */\n      body = _initDocument('<!---->');\n      importedNode = body.ownerDocument.importNode(dirty, true);\n      if (\n        importedNode.nodeType === NODE_TYPE.element &&\n        importedNode.nodeName === 'BODY'\n      ) {\n        /* Node is already a body, use as is */\n        body = importedNode;\n      } else if (importedNode.nodeName === 'HTML') {\n        body = importedNode;\n      } else {\n        // eslint-disable-next-line unicorn/prefer-dom-node-append\n        body.appendChild(importedNode);\n      }\n    } else {\n      /* Exit directly if we have nothing to do */\n      if (\n        !RETURN_DOM &&\n        !SAFE_FOR_TEMPLATES &&\n        !WHOLE_DOCUMENT &&\n        // eslint-disable-next-line unicorn/prefer-includes\n        dirty.indexOf('<') === -1\n      ) {\n        return trustedTypesPolicy && RETURN_TRUSTED_TYPE\n          ? trustedTypesPolicy.createHTML(dirty)\n          : dirty;\n      }\n\n      /* Initialize the document to work on */\n      body = _initDocument(dirty);\n\n      /* Check we have a DOM node from the data */\n      if (!body) {\n        return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : '';\n      }\n    }\n\n    /* Remove first element node (ours) if FORCE_BODY is set */\n    if (body && FORCE_BODY) {\n      _forceRemove(body.firstChild);\n    }\n\n    /* Get node iterator */\n    const nodeIterator = _createNodeIterator(IN_PLACE ? dirty : body);\n\n    /* Now start iterating over the created document */\n    while ((currentNode = nodeIterator.nextNode())) {\n      /* Sanitize tags and elements */\n      _sanitizeElements(currentNode);\n\n      /* Check attributes next */\n      _sanitizeAttributes(currentNode);\n\n      /* Shadow DOM detected, sanitize it */\n      if (currentNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(currentNode.content);\n      }\n    }\n\n    /* If we sanitized `dirty` in-place, return it. */\n    if (IN_PLACE) {\n      return dirty;\n    }\n\n    /* Return sanitized string or DOM */\n    if (RETURN_DOM) {\n      if (RETURN_DOM_FRAGMENT) {\n        returnNode = createDocumentFragment.call(body.ownerDocument);\n\n        while (body.firstChild) {\n          // eslint-disable-next-line unicorn/prefer-dom-node-append\n          returnNode.appendChild(body.firstChild);\n        }\n      } else {\n        returnNode = body;\n      }\n\n      if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmode) {\n        /*\n          AdoptNode() is not used because internal state is not reset\n          (e.g. the past names map of a HTMLFormElement), this is safe\n          in theory but we would rather not risk another attack vector.\n          The state that is cloned by importNode() is explicitly defined\n          by the specs.\n        */\n        returnNode = importNode.call(originalDocument, returnNode, true);\n      }\n\n      return returnNode;\n    }\n\n    let serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n\n    /* Serialize doctype if allowed */\n    if (\n      WHOLE_DOCUMENT &&\n      ALLOWED_TAGS['!doctype'] &&\n      body.ownerDocument &&\n      body.ownerDocument.doctype &&\n      body.ownerDocument.doctype.name &&\n      regExpTest(EXPRESSIONS.DOCTYPE_NAME, body.ownerDocument.doctype.name)\n    ) {\n      serializedHTML =\n        '<!DOCTYPE ' + body.ownerDocument.doctype.name + '>\\n' + serializedHTML;\n    }\n\n    /* Sanitize final string template-safe */\n    if (SAFE_FOR_TEMPLATES) {\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], (expr: RegExp) => {\n        serializedHTML = stringReplace(serializedHTML, expr, ' ');\n      });\n    }\n\n    return trustedTypesPolicy && RETURN_TRUSTED_TYPE\n      ? trustedTypesPolicy.createHTML(serializedHTML)\n      : serializedHTML;\n  };\n\n  DOMPurify.setConfig = function (cfg = {}) {\n    _parseConfig(cfg);\n    SET_CONFIG = true;\n  };\n\n  DOMPurify.clearConfig = function () {\n    CONFIG = null;\n    SET_CONFIG = false;\n  };\n\n  DOMPurify.isValidAttribute = function (tag, attr, value) {\n    /* Initialize shared config vars if necessary. */\n    if (!CONFIG) {\n      _parseConfig({});\n    }\n\n    const lcTag = transformCaseFunc(tag);\n    const lcName = transformCaseFunc(attr);\n    return _isValidAttribute(lcTag, lcName, value);\n  };\n\n  DOMPurify.addHook = function (\n    entryPoint: keyof HooksMap,\n    hookFunction: HookFunction\n  ) {\n    if (typeof hookFunction !== 'function') {\n      return;\n    }\n\n    arrayPush(hooks[entryPoint], hookFunction);\n  };\n\n  DOMPurify.removeHook = function (\n    entryPoint: keyof HooksMap,\n    hookFunction: HookFunction\n  ) {\n    if (hookFunction !== undefined) {\n      const index = arrayLastIndexOf(hooks[entryPoint], hookFunction);\n\n      return index === -1\n        ? undefined\n        : arraySplice(hooks[entryPoint], index, 1)[0];\n    }\n\n    return arrayPop(hooks[entryPoint]);\n  };\n\n  DOMPurify.removeHooks = function (entryPoint: keyof HooksMap) {\n    hooks[entryPoint] = [];\n  };\n\n  DOMPurify.removeAllHooks = function () {\n    hooks = _createHooksMap();\n  };\n\n  return DOMPurify;\n}\n\nexport default createDOMPurify();\n\nexport interface DOMPurify {\n  /**\n   * Creates a DOMPurify instance using the given window-like object. Defaults to `window`.\n   */\n  (root?: WindowLike): DOMPurify;\n\n  /**\n   * Version label, exposed for easier checks\n   * if DOMPurify is up to date or not\n   */\n  version: string;\n\n  /**\n   * Array of elements that DOMPurify removed during sanitation.\n   * Empty if nothing was removed.\n   */\n  removed: Array<RemovedElement | RemovedAttribute>;\n\n  /**\n   * Expose whether this browser supports running the full DOMPurify.\n   */\n  isSupported: boolean;\n\n  /**\n   * Set the configuration once.\n   *\n   * @param cfg configuration object\n   */\n  setConfig(cfg?: Config): void;\n\n  /**\n   * Removes the configuration.\n   */\n  clearConfig(): void;\n\n  /**\n   * Provides core sanitation functionality.\n   *\n   * @param dirty string or DOM node\n   * @param cfg object\n   * @returns Sanitized TrustedHTML.\n   */\n  sanitize(\n    dirty: string | Node,\n    cfg: Config & { RETURN_TRUSTED_TYPE: true }\n  ): TrustedHTML;\n\n  /**\n   * Provides core sanitation functionality.\n   *\n   * @param dirty DOM node\n   * @param cfg object\n   * @returns Sanitized DOM node.\n   */\n  sanitize(dirty: Node, cfg: Config & { IN_PLACE: true }): Node;\n\n  /**\n   * Provides core sanitation functionality.\n   *\n   * @param dirty string or DOM node\n   * @param cfg object\n   * @returns Sanitized DOM node.\n   */\n  sanitize(dirty: string | Node, cfg: Config & { RETURN_DOM: true }): Node;\n\n  /**\n   * Provides core sanitation functionality.\n   *\n   * @param dirty string or DOM node\n   * @param cfg object\n   * @returns Sanitized document fragment.\n   */\n  sanitize(\n    dirty: string | Node,\n    cfg: Config & { RETURN_DOM_FRAGMENT: true }\n  ): DocumentFragment;\n\n  /**\n   * Provides core sanitation functionality.\n   *\n   * @param dirty string or DOM node\n   * @param cfg object\n   * @returns Sanitized string.\n   */\n  sanitize(dirty: string | Node, cfg?: Config): string;\n\n  /**\n   * Checks if an attribute value is valid.\n   * Uses last set config, if any. Otherwise, uses config defaults.\n   *\n   * @param tag Tag name of containing element.\n   * @param attr Attribute name.\n   * @param value Attribute value.\n   * @returns Returns true if `value` is valid. Otherwise, returns false.\n   */\n  isValidAttribute(tag: string, attr: string, value: string): boolean;\n\n  /**\n   * Adds a DOMPurify hook.\n   *\n   * @param entryPoint entry point for the hook to add\n   * @param hookFunction function to execute\n   */\n  addHook(entryPoint: BasicHookName, hookFunction: NodeHook): void;\n\n  /**\n   * Adds a DOMPurify hook.\n   *\n   * @param entryPoint entry point for the hook to add\n   * @param hookFunction function to execute\n   */\n  addHook(entryPoint: ElementHookName, hookFunction: ElementHook): void;\n\n  /**\n   * Adds a DOMPurify hook.\n   *\n   * @param entryPoint entry point for the hook to add\n   * @param hookFunction function to execute\n   */\n  addHook(\n    entryPoint: DocumentFragmentHookName,\n    hookFunction: DocumentFragmentHook\n  ): void;\n\n  /**\n   * Adds a DOMPurify hook.\n   *\n   * @param entryPoint entry point for the hook to add\n   * @param hookFunction function to execute\n   */\n  addHook(\n    entryPoint: 'uponSanitizeElement',\n    hookFunction: UponSanitizeElementHook\n  ): void;\n\n  /**\n   * Adds a DOMPurify hook.\n   *\n   * @param entryPoint entry point for the hook to add\n   * @param hookFunction function to execute\n   */\n  addHook(\n    entryPoint: 'uponSanitizeAttribute',\n    hookFunction: UponSanitizeAttributeHook\n  ): void;\n\n  /**\n   * Remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if hook not specified)\n   *\n   * @param entryPoint entry point for the hook to remove\n   * @param hookFunction optional specific hook to remove\n   * @returns removed hook\n   */\n  removeHook(\n    entryPoint: BasicHookName,\n    hookFunction?: NodeHook\n  ): NodeHook | undefined;\n\n  /**\n   * Remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if hook not specified)\n   *\n   * @param entryPoint entry point for the hook to remove\n   * @param hookFunction optional specific hook to remove\n   * @returns removed hook\n   */\n  removeHook(\n    entryPoint: ElementHookName,\n    hookFunction?: ElementHook\n  ): ElementHook | undefined;\n\n  /**\n   * Remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if hook not specified)\n   *\n   * @param entryPoint entry point for the hook to remove\n   * @param hookFunction optional specific hook to remove\n   * @returns removed hook\n   */\n  removeHook(\n    entryPoint: DocumentFragmentHookName,\n    hookFunction?: DocumentFragmentHook\n  ): DocumentFragmentHook | undefined;\n\n  /**\n   * Remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if hook not specified)\n   *\n   * @param entryPoint entry point for the hook to remove\n   * @param hookFunction optional specific hook to remove\n   * @returns removed hook\n   */\n  removeHook(\n    entryPoint: 'uponSanitizeElement',\n    hookFunction?: UponSanitizeElementHook\n  ): UponSanitizeElementHook | undefined;\n\n  /**\n   * Remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if hook not specified)\n   *\n   * @param entryPoint entry point for the hook to remove\n   * @param hookFunction optional specific hook to remove\n   * @returns removed hook\n   */\n  removeHook(\n    entryPoint: 'uponSanitizeAttribute',\n    hookFunction?: UponSanitizeAttributeHook\n  ): UponSanitizeAttributeHook | undefined;\n\n  /**\n   * Removes all DOMPurify hooks at a given entryPoint\n   *\n   * @param entryPoint entry point for the hooks to remove\n   */\n  removeHooks(entryPoint: HookName): void;\n\n  /**\n   * Removes all DOMPurify hooks.\n   */\n  removeAllHooks(): void;\n}\n\n/**\n * An element removed by DOMPurify.\n */\nexport interface RemovedElement {\n  /**\n   * The element that was removed.\n   */\n  element: Node;\n}\n\n/**\n * An element removed by DOMPurify.\n */\nexport interface RemovedAttribute {\n  /**\n   * The attribute that was removed.\n   */\n  attribute: Attr | null;\n\n  /**\n   * The element that the attribute was removed.\n   */\n  from: Node;\n}\n\ntype BasicHookName =\n  | 'beforeSanitizeElements'\n  | 'afterSanitizeElements'\n  | 'uponSanitizeShadowNode';\ntype ElementHookName = 'beforeSanitizeAttributes' | 'afterSanitizeAttributes';\ntype DocumentFragmentHookName =\n  | 'beforeSanitizeShadowDOM'\n  | 'afterSanitizeShadowDOM';\ntype UponSanitizeElementHookName = 'uponSanitizeElement';\ntype UponSanitizeAttributeHookName = 'uponSanitizeAttribute';\n\ninterface HooksMap {\n  beforeSanitizeElements: NodeHook[];\n  afterSanitizeElements: NodeHook[];\n  beforeSanitizeShadowDOM: DocumentFragmentHook[];\n  uponSanitizeShadowNode: NodeHook[];\n  afterSanitizeShadowDOM: DocumentFragmentHook[];\n  beforeSanitizeAttributes: ElementHook[];\n  afterSanitizeAttributes: ElementHook[];\n  uponSanitizeElement: UponSanitizeElementHook[];\n  uponSanitizeAttribute: UponSanitizeAttributeHook[];\n}\n\ntype ArrayElement<T> = T extends Array<infer U> ? U : never;\n\ntype HookFunction = ArrayElement<HooksMap[keyof HooksMap]>;\n\nexport type HookName =\n  | BasicHookName\n  | ElementHookName\n  | DocumentFragmentHookName\n  | UponSanitizeElementHookName\n  | UponSanitizeAttributeHookName;\n\nexport type NodeHook = (\n  this: DOMPurify,\n  currentNode: Node,\n  hookEvent: null,\n  config: Config\n) => void;\n\nexport type ElementHook = (\n  this: DOMPurify,\n  currentNode: Element,\n  hookEvent: null,\n  config: Config\n) => void;\n\nexport type DocumentFragmentHook = (\n  this: DOMPurify,\n  currentNode: DocumentFragment,\n  hookEvent: null,\n  config: Config\n) => void;\n\nexport type UponSanitizeElementHook = (\n  this: DOMPurify,\n  currentNode: Node,\n  hookEvent: UponSanitizeElementHookEvent,\n  config: Config\n) => void;\n\nexport type UponSanitizeAttributeHook = (\n  this: DOMPurify,\n  currentNode: Element,\n  hookEvent: UponSanitizeAttributeHookEvent,\n  config: Config\n) => void;\n\nexport interface UponSanitizeElementHookEvent {\n  tagName: string;\n  allowedTags: Record<string, boolean>;\n}\n\nexport interface UponSanitizeAttributeHookEvent {\n  attrName: string;\n  attrValue: string;\n  keepAttr: boolean;\n  allowedAttributes: Record<string, boolean>;\n  forceKeepAttr: boolean | undefined;\n}\n\n/**\n * A `Window`-like object containing the properties and types that DOMPurify requires.\n */\nexport type WindowLike = Pick<\n  typeof globalThis,\n  | 'DocumentFragment'\n  | 'HTMLTemplateElement'\n  | 'Node'\n  | 'Element'\n  | 'NodeFilter'\n  | 'NamedNodeMap'\n  | 'HTMLFormElement'\n  | 'DOMParser'\n> & {\n  document?: Document;\n  MozNamedAttrMap?: typeof window.NamedNodeMap;\n} & Pick<TrustedTypesWindow, 'trustedTypes'>;\n"],"names":["isFrozen","getOwnPropertyDescriptor","seal","create","construct","freeze","x","apply","thisArg","_len","arguments","length","args","Array","_key","func","Func","_len2","_key2","arrayForEach","unapply","prototype","forEach","arrayLastIndexOf","lastIndexOf","arrayPop","pop","arrayPush","push","splice","stringToLowerCase","String","toLowerCase","stringToString","toString","stringMatch","stringReplace","replace","stringIndexOf","stringTrim","trim","objectHasOwnProperty","Object","hasOwnProperty","RegExp","test","lastIndex","_len3","_key3","unconstruct","_len4","_key4","addToSet","set","array","transformCaseFunc","setPrototypeOf","l","element","lcElement","cleanArray","index","isPropertyExist","clone","newObject","property","value","entries","object","constructor","prop","desc","get","getPrototypeOf","fallbackValue","html","svg","svgFilters","MUSTACHE_EXPR","ERB_EXPR","TMPLIT_EXPR","DATA_ATTR","ARIA_ATTR","IS_ALLOWED_URI","IS_SCRIPT_OR_DATA","DOCTYPE_NAME","CUSTOM_ELEMENT","NODE_TYPE","attribute","text","cdataSection","entityReference","entityNode","progressingInstruction","comment","document","documentType","documentFragment","notation","getGlobal","window","_createTrustedTypesPolicy","trustedTypes","purifyHostElement","createPolicy","suffix","ATTR_NAME","hasAttribute","getAttribute","policyName","createHTML","createScriptURL","scriptUrl","_","console","warn","_createHooksMap","afterSanitizeAttributes","afterSanitizeShadowDOM","beforeSanitizeAttributes","beforeSanitizeElements","beforeSanitizeShadowDOM","uponSanitizeAttribute","uponSanitizeElement","uponSanitizeShadowNode","createDOMPurify","undefined","DOMPurify","root","version","VERSION","removed","nodeType","Element","isSupported","originalDocument","currentScript","DocumentFragment","Node","NodeFilter","NamedNodeMap","MozNamedAttrMap","HTMLFormElement","DOMParser","ElementPrototype","cloneNode","lookupGetter","remove","getNextSibling","getChildNodes","getParentNode","HTMLTemplateElement","createElement","template","content","ownerDocument","trustedTypesPolicy","implementation","createNodeIterator","createDocumentFragment","getElementsByTagName","importNode","hooks","createHTMLDocument","EXPRESSIONS","ALLOWED_TAGS","DEFAULT_ALLOWED_TAGS","TAGS","ALLOWED_ATTR","DEFAULT_ALLOWED_ATTR","ATTRS","CUSTOM_ELEMENT_HANDLING","tagNameCheck","writable","configurable","enumerable","attributeNameCheck","FORBID_TAGS","FORBID_ATTR","EXTRA_ELEMENT_HANDLING","ALLOW_ARIA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","ALLOW_SELF_CLOSE_IN_ATTR","SAFE_FOR_TEMPLATES","SAFE_FOR_XML","WHOLE_DOCUMENT","SET_CONFIG","FORCE_BODY","RETURN_DOM_FRAGMENT","RETURN_TRUSTED_TYPE","SANITIZE_NAMED_PROPS","SANITIZE_NAMED_PROPS_PREFIX","KEEP_CONTENT","IN_PLACE","USE_PROFILES","FORBID_CONTENTS","DEFAULT_FORBID_CONTENTS","DATA_URI_TAGS","DEFAULT_DATA_URI_TAGS","URI_SAFE_ATTRIBUTES","MATHML_NAMESPACE","SVG_NAMESPACE","NAMESPACE","HTML_NAMESPACE","IS_EMPTY_INPUT","ALLOWED_NAMESPACES","HTML_INTEGRATION_POINTS","PARSER_MEDIA_TYPE","DEFAULT_PARSER_MEDIA_TYPE","CONFIG","isRegexOrFunction","testValue","Function","_parseConfig","cfg","SUPPORTED_PARSER_MEDIA_TYPES","indexOf","DEFAULT_ALLOWED_NAMESPACES","DEFAULT_URI_SAFE_ATTRIBUTES","ADD_URI_SAFE_ATTR","ADD_DATA_URI_TAGS","ALLOW_DATA_ATTR","RETURN_DOM","SANITIZE_DOM","ALLOWED_URI_REGEXP","MATHML_TEXT_INTEGRATION_POINTS","allowCustomizedBuiltInElements","mathMl","ADD_TAGS","tagCheck","ADD_ATTR","attributeCheck","ADD_FORBID_CONTENTS","table","tbody","TRUSTED_TYPES_POLICY","typeErrorCreate","emptyHTML","ALL_SVG_TAGS","ALL_MATHML_TAGS","_checkValidNamespace","parent","tagName","namespaceURI","parentTagName","Boolean","COMMON_SVG_AND_HTML_ELEMENTS","_forceRemove","node","removeChild","_removeAttribute","name","getAttributeNode","from","removeAttribute","setAttribute","_initDocument","dirty","doc","leadingWhitespace","matches","dirtyPayload","parseFromString","documentElement","createDocument","innerHTML","body","insertBefore","createTextNode","childNodes","call","_createNodeIterator","SHOW_ELEMENT","SHOW_COMMENT","SHOW_TEXT","SHOW_PROCESSING_INSTRUCTION","SHOW_CDATA_SECTION","_isClobbered","nodeName","textContent","attributes","hasChildNodes","_isNode","_executeHooks","currentNode","data","hook","_sanitizeElements","allowedTags","firstElementChild","regExpTest","_isBasicCustomElement","parentNode","childCount","i","childClone","__removalCount","expr","afterSanitizeElements","_isValidAttribute","lcTag","lcName","formElement","ATTR_WHITESPACE","_sanitizeAttributes","hookEvent","attrName","attrValue","keepAttr","allowedAttributes","forceKeepAttr","attr","initValue","getAttributeType","setAttributeNS","_sanitizeShadowDOM","fragment","shadowNode","shadowIterator","nextNode","sanitize","importedNode","returnNode","appendChild","firstChild","nodeIterator","shadowroot","shadowrootmode","serializedHTML","outerHTML","doctype","setConfig","clearConfig","isValidAttribute","tag","addHook","entryPoint","hookFunction","removeHook","arraySplice","removeHooks","removeAllHooks"],"mappings":"4DUEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,QAAA,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAEA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QVPA,EAAA,EAAA,CAAA,CAAA,QAwBA,IAAM,EAA2B,EAAA,SAAd,CAA8B,CAAC,AAvBlD,SAAS,AAAwB,AAuBH,OAtB5B,CAAK,CACL,SAAO,CACP,GAAG,EACJ,CAAE,CAAM,EACP,OAAO,AAAa,EAAA,SAAF,IAAqB,CAAC,MAAO,OAAO,MAAM,CAAC,CAC3D,MAAO,6BACP,KAAM,OACN,QAAS,YACT,YAAa,IACb,OAAQ,eACR,cAAe,OACf,YAAa,OACb,IAAK,EACL,kBAAmB,CACrB,EAAG,GAAQ,EAAqB,EAAA,IAAb,SAAgC,CAAC,CAAtB,OAA+B,CAC3D,GAAI,CACN,EAAG,GAAS,KAAmB,CAAb,CAAa,UAAF,GAAqB,CAAC,OAAQ,CACzD,cAAe,QACf,eAAgB,QAChB,EAAG,kLACL,GACF,GWCM,EAA2B,EAAA,UAAd,AAA8B,CAvBjD,AAuBkD,SAvBzC,AAAa,CAuBQ,MAtB5B,CAAK,SACL,CAAO,CACP,GAAG,EACJ,CAAE,CAAM,EACP,OAAO,AAAa,EAAA,SAAF,IAAqB,CAAC,MAAO,OAAO,MAAM,CAAC,CAC3D,MAAO,6BACP,KAAM,OACN,QAAS,YACT,YAAa,IACb,OAAQ,eACR,cAAe,OACf,YAAa,OACb,IAAK,EACL,kBAAmB,CACrB,EAAG,GAAQ,EAAqB,EAAA,IAAb,SAAgC,CAAC,CAAtB,OAA+B,CAC3D,GAAI,CACN,EAAG,GAAS,KAAmB,CAAb,CAAa,UAAF,GAAqB,CAAC,OAAQ,CACzD,cAAe,QACf,eAAgB,QAChB,EAAG,gQACL,GACF,GDXA,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QTNA,EAAA,CAAA,CAAA,QAAA,IAAA,EAAA,EAAA,CAAA,CAAA,QAMA,EAAA,EAAA,CAAA,CAAA,QAQA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QWCA,IAAM,EAA2B,EAAA,UAAd,AAA8B,CAvBjD,AAuBkD,SAvBzC,AAAoB,CAuBC,MAtB5B,CAAK,SACL,CAAO,CACP,GAAG,EACJ,CAAE,CAAM,EACP,OAAO,AAAa,EAAA,SAAF,IAAqB,CAAC,MAAO,OAAO,MAAM,CAAC,CAC3D,MAAO,6BACP,KAAM,OACN,QAAS,YACT,YAAa,IACb,OAAQ,eACR,cAAe,OACf,YAAa,OACb,IAAK,EACL,kBAAmB,CACrB,EAAG,GAAQ,EAAqB,EAAA,IAAb,SAAgC,CAAC,CAAtB,OAA+B,CAC3D,GAAI,CACN,EAAG,GAAS,KAAmB,CAAb,CAAa,UAAF,GAAqB,CAAC,OAAQ,CACzD,cAAe,QACf,eAAgB,QAChB,EAAG,4SACL,GACF,GCCM,EAA2B,EAAA,UAAd,AAA8B,CAAC,AAvBlD,SAAS,AAAS,CAuBY,MAtB5B,CAAK,SACL,CAAO,CACP,GAAG,EACJ,CAAE,CAAM,EACP,OAAoB,AAAb,EAAa,SAAF,IAAqB,CAAC,MAAO,OAAO,MAAM,CAAC,CAC3D,MAAO,6BACP,KAAM,OACN,QAAS,YACT,YAAa,IACb,OAAQ,eACR,cAAe,OACf,YAAa,OACb,IAAK,EACL,kBAAmB,CACrB,EAAG,GAAQ,EAAqB,EAAA,IAAb,SAAgC,CAAC,CAAtB,OAA+B,CAC3D,GAAI,CACN,EAAG,GAAS,KAAmB,CAAb,CAAa,UAAF,GAAqB,CAAC,OAAQ,CACzD,cAAe,QACf,eAAgB,QAChB,EAAG,wBACL,GACF,GZCA,IAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,OaFA,IAAM,EAA2B,EAAA,UAAd,AAA8B,CArBjD,AAqBkD,SArBzC,AAAS,CAqBY,AApB5B,OAAK,SACL,CAAO,CACP,GAAG,EACJ,CAAE,CAAM,EACP,OAAO,AAAa,EAAA,SAAF,IAAqB,CAAC,MAAO,OAAO,MAAM,CAAC,CAC3D,MAAO,6BACP,QAAS,YACT,KAAM,eACN,cAAe,OACf,YAAa,OACb,IAAK,EACL,kBAAmB,CACrB,EAAG,GAAQ,EAAqB,EAAA,IAAb,SAAgC,CAAC,CAAtB,OAA+B,CAC3D,GAAI,CACN,EAAG,GAAS,KAAmB,CAAb,CAAa,UAAF,GAAqB,CAAC,OAAQ,CACzD,SAAU,UACV,EAAG,kSACH,SAAU,SACZ,GACF,Gb+BO,SAAS,EAAc,UAC7B,CAAQ,YACR,CAAU,UACV,CAAQ,CACY,EACpB,IAAM,EAAQ,CAAA,EAAA,EAAA,QAAA,AAAQ,IAChB,EAAiB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,EAAA,GAAG,CAAC,gBAAgB,CAAC,MAAM,EACxD,EAAiB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,EAAA,GAAG,CAAC,gBAAgB,CAAC,MAAM,EACxD,EAAiB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,EAAA,GAAG,CAAC,gBAAgB,CAAC,MAAM,EAGxD,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAExC,MACI,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAa,EAAE,EAC/D,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GAGvC,EAAgB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KAE7B,IAAM,EAAyB,EAAW,GAAG,CAAC,AAAC,IAAU,CACxD,EADuD,CACpD,CAAI,CACP,OAAO,EACR,CAAC,EAgBD,OAdA,QAAQ,GAAG,CAAC,yBAA0B,CACrC,WAAY,EAAW,GAAG,CAAC,AAAC,IAAM,AAAC,CAClC,GAAI,EAAE,GAAG,CACT,KAAM,EAAE,aAAa,CACrB,MAAO,EAAE,KAAK,CACf,CAAC,EACD,gBAAiB,EAAgB,GAAG,CAAC,AAAC,IAAM,AAAC,CAC5C,GAAI,EAAE,GAAG,CACT,KAAM,EAAE,aAAa,CACrB,MAAO,EAAE,KAAK,CACf,CAAC,CACF,GAGO,IAAI,KAAe,EAAgB,AAC3C,EAAG,CAAC,EAAY,EAAgB,EA+B1B,EAAqB,MAAO,IAYjC,GAXA,CAWI,OAXI,GAAG,CAAC,kCAAmC,CAC9C,WAAY,EAAS,GAAG,CACxB,eAAgB,OAAO,EAAS,GAAG,CACnC,MAAO,EAAS,KAAK,AACtB,GAIC,EAAS,KAAK,EACW,UAAxB,OAAO,EAAS,GAAG,EAAiB,EAAS,GAAG,CAAC,UAAU,CAAC,SAE3C,CAElB,QAAQ,GAAG,CAAC,4BACZ,GAAI,CACH,MAAM,EAAe,UACpB,EACA,cAAe,EAAS,aAAa,EAAI,mBACzC,KAAM,EAAS,IAAI,EAAI,gBACvB,MAAO,EAAS,KAAK,EAAI,iBACzB,QAAS,EAAS,OAAO,EAAI,eAC7B,QAAS,EAAS,OAAO,CACzB,YAAa,EAAS,WAAW,CACjC,UAAW,EAAS,SAAS,AAC9B,GAGA,EAAmB,AAAC,GACnB,EAAK,MAAM,CAAC,AAAC,GAAS,EAAK,GAAG,GAAK,EAAS,GAAG,GAEhD,EAAa,MACb,MACA,EAAM,OAAO,CACZ,iBACA,wCAEF,CAAE,MAAO,EAAO,CACf,QAAQ,KAAK,CAAC,2BAA4B,GAC1C,EAAM,KAAK,CAAC,QAAS,6CACtB,CACD,KAAO,CAEN,QAAQ,GAAG,CAAC,sCAAuC,EAAS,GAAG,EAC/D,GAAI,CACH,MAAM,EAAe,CACpB,GAAI,EAAS,GAAG,CAChB,cAAe,EAAS,aAAa,CACrC,KAAM,EAAS,IAAI,CACnB,MAAO,EAAS,KAAK,CACrB,QAAS,EAAS,OAAO,CACzB,QAAS,EAAS,OAAO,CACzB,YAAa,EAAS,WAAW,CACjC,UAAW,EAAS,SAAS,AAC9B,GACA,EAAa,MACb,MACA,EAAM,OAAO,CACZ,mBACA,0CAEF,CAAE,MAAO,EAAO,CACf,QAAQ,KAAK,CAAC,2BAA4B,GAC1C,EAAM,KAAK,CAAC,QAAS,6CACtB,CACD,CACD,EAEM,EAAuB,MAAO,IAEnC,GAAkB,UAAd,OAAO,GAAmB,EAAG,UAAU,CAAC,SAE3C,CAFqD,CAElC,AAAC,GAAS,EAAK,MAAM,CAAC,AAAC,GAAS,EAAK,GAAG,GAAK,IAC5D,IAAc,GACjB,CADqB,CACR,MAEd,EAAM,OAAO,CAAC,mBAAoB,2CAGlC,GAAI,CACH,MAAM,EAAe,CAAE,GAAI,CAA6B,GACxD,MACA,EAAM,OAAO,CACZ,mBACA,0CAEF,CAAE,MAAO,EAAO,CACf,QAAQ,KAAK,CAAC,6BAA8B,GAC5C,EAAM,KAAK,CAAC,QAAS,+CACtB,CAEF,EAEA,MACC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACV,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,gBAAgB,CAAA,CAAC,UAAU,4DAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,CAAC,UAAU,mBAAU,eACrC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,OAAO,UAAU,KAAK,KAAK,QA9HZ,CA8HqB,IA7H9C,IAAM,EAAS,CAAC,KAAK,EAAE,EAAA,CAAY,CAE7B,EAAwB,CAC7B,IAAK,EACL,cAAe,GACf,KAAM,GACN,MAAO,GACP,QAAS,GACT,QAAS,GACT,YAAa,GACb,WAAW,EACX,OAAO,CACR,EAEA,EAAoB,AAAD,GAAU,IAAI,EAAM,EAAY,EACnD,EAAa,GACb,EAAc,AAAC,GAAS,EAAO,EAChC,YA6GI,CAAA,EAAA,EAAA,GAAA,EAAC,AYpMS,EZoMT,CAAS,UAAU,iBAAiB,qBAIvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,iBAAiB,CAAA,UAChB,GAAiB,EAAc,MAAM,CAAG,EACxC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6CACd,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,WACL,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACX,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,QAAQ,CAAA,WACR,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,mBAAU,YAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,mBAAU,SAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,mBAAU,UAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,mBAAU,QAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,kBAAS,YAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,kBAAS,iBAGhC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACR,EAAc,GAAG,CAAC,AAAC,GACnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAEA,SAAU,EACV,UAAW,IAAc,EAAS,GAAG,CACrC,OAAQ,IAAM,OAlItB,QAAQ,GAAG,CAAC,kCAAmC,CAC9C,EAAA,CAF0B,EAmIc,EAAS,GAAG,CAhIpD,OAAQ,OAAO,EACf,SAAU,EAAc,IAAI,CAAC,AAAC,GAAM,EAAE,GAAG,GAAK,EAC/C,GACA,EAAa,IA8HL,OAAQ,EACR,SAAU,IAAM,EAAa,MAC7B,SAAU,IAAM,EAAqB,EAAS,GAAG,GAN5C,EAAS,GAAG,UAatB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wEACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mGACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAoB,UAAU,4BAEhC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kEAAyD,kBAGvE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,4CAAmC,8DAQtD,CAGA,SAAS,EAAY,UACpB,CAAQ,WACR,CAAS,QACT,CAAM,QACN,CAAM,UACN,CAAQ,UACR,CAAQ,CAQR,EACA,GAAM,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAW,GAE/D,EAAA,OAAK,CAAC,SAAS,CAAC,KACX,GACH,EAAkB,EAEpB,EAAG,CAAC,CAHY,CAGD,EAAS,EAExB,IAAM,EAAoB,CACzB,EACA,KAEA,EAAkB,AAAC,IAAU,CAC5B,EAD2B,CACxB,CAAI,CACP,CAAC,EAAM,CAAE,EACV,CAAC,CACF,SAaA,AAAI,EAEF,CAAA,EAAA,EAAA,IAAA,AAFa,EAEZ,EAAA,QAAQ,CAAA,CACR,UAAW,CAAC,+DAA+D,EAAE,EAAS,KAAK,CAAG,wCAA0C,GAAA,CAAI,WAE5I,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACL,MAAO,EAAe,aAAa,CACnC,SAAU,AAAC,GAAM,EAAkB,gBAAiB,EAAE,MAAM,CAAC,KAAK,EAClE,YAAY,oBACZ,UAAU,aAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACL,MAAO,EAAe,IAAI,CAC1B,SAAU,AAAC,GAAM,EAAkB,OAAQ,EAAE,MAAM,CAAC,KAAK,EACzD,YAAY,UACZ,UAAU,aAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACL,MAAO,EAAe,KAAK,CAC3B,SAAU,AAAC,GAAM,EAAkB,QAAS,EAAE,MAAM,CAAC,KAAK,EAC1D,YAAY,WACZ,UAAU,aAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACL,MAAO,EAAe,OAAO,CAC7B,SAAU,AAAC,GAAM,EAAkB,UAAW,EAAE,MAAM,CAAC,KAAK,EAC5D,YAAY,SACZ,UAAU,aAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CACR,QAAS,EAAe,SAAS,CACjC,gBAAkB,AAAD,GAChB,EAAkB,YAAa,CAAC,CAAC,OAIpC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACN,OAAO,UACP,KAAK,QACL,QA7Da,CA6DJ,IA5Dd,QAAQ,GAAG,CAAC,sCAAuC,CAClD,WAAY,EAAe,GAAG,CAC9B,eAAgB,OAAO,EAAe,GAAG,CACzC,MAAO,EAAe,KAAK,CAC3B,mBAAoB,EAAS,GAAG,CAChC,uBAAwB,OAAO,EAAS,GAAG,AAC5C,GACA,EAAO,EACR,EAqDM,aAAW,gBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,cAEtB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACN,OAAO,UACP,KAAK,QACL,QAAS,EACT,aAAW,kBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,sBAS1B,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,QAAQ,CAAA,CACR,UAAW,CAAC,kBAAkB,EAAE,EAAS,KAAK,CAAG,uEAAyE,GAAA,CAAI,WAE9H,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,uBACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAM,EAAS,aAAa,GAC5B,EAAS,KAAK,EACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,wJAA+I,iBAMlK,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAE,EAAS,IAAI,GACzB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAE,EAAS,KAAK,GAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAE,EAAS,OAAO,GAC5B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACR,EAAS,SAAS,EAClB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAe,UAAU,8BAG5B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACN,OAAO,UACP,KAAK,QACL,QAAS,EACT,aAAW,gBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,cAEvB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACN,OAAO,UACP,KAAK,QACL,QAAS,EACT,aAAW,kBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,qBAM3B,CC1XO,SAAS,EAAa,UAC5B,CAAQ,CACR,UAAQ,CACR,UAAQ,CACW,EACnB,IAAM,EAAQ,CAAA,EAAA,EAAA,QAAA,AAAQ,IAChB,EAAgB,CAAA,EAAA,EAAA,WAAW,AAAX,EAAY,EAAA,GAAG,CAAC,cAAc,CAAC,MAAM,EACrD,EAAgB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,EAAA,GAAG,CAAC,cAAc,CAAC,MAAM,EACrD,EAAgB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,EAAA,GAAG,CAAC,cAAc,CAAC,MAAM,EAGrD,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAEhC,MACI,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAY,EAAE,EAC1D,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GAGvC,EAAc,CAAA,EAAA,EAAA,OAAO,AAAP,EAAQ,KAE3B,IAAM,EAAwB,EAAS,GAAG,CAAC,AAAC,IAAU,CACrD,EADoD,CACjD,CAAI,CACP,OAAO,CACR,CAAC,GAgBD,OAdA,QAAQ,GAAG,CAAC,uBAAwB,CACnC,WAAY,EAAW,GAAG,CAAE,AAAD,IAAO,AAAC,CAClC,GAAI,EAAE,GAAG,CACT,KAAM,CAAA,EAAG,EAAE,SAAS,CAAC,CAAC,EAAE,EAAE,QAAQ,CAAA,CAAE,CACpC,MAAO,EAAE,KAAK,CACf,CAAC,EACD,cAAe,EAAc,GAAG,CAAC,AAAC,IAAM,AAAC,CACxC,GAAI,EAAE,GAAG,CACT,KAAM,CAAA,EAAG,EAAE,SAAS,CAAC,CAAC,EAAE,EAAE,QAAQ,CAAA,CAAE,CACpC,MAAO,EAAE,KAAK,CACf,CAAC,CACF,GAGO,IAAI,KAAe,EAAc,AACzC,EAAG,CAAC,EAAU,EAAc,EA+BtB,EAAoB,MAAO,IAahC,GAZA,CAYI,OAZI,GAAG,CAAC,iCAAkC,CAC7C,UAAW,EAAQ,GAAG,CACtB,cAAe,OAAO,EAAQ,GAAG,CACjC,MAAO,EAAQ,KAAK,CACpB,YAAa,CAAA,EAAG,EAAQ,SAAS,CAAC,CAAC,EAAE,EAAQ,QAAQ,CAAA,CAAE,AACxD,GAIC,EAAQ,KAAK,EACW,UAAvB,OAAO,EAAQ,GAAG,EAAiB,EAAQ,GAAG,CAAC,UAAU,CAAC,SAE1C,CAEjB,QAAQ,GAAG,CAAC,2BACZ,GAAI,CACH,MAAM,EAAc,UACnB,EACA,UAAW,EAAQ,SAAS,EAAI,sBAChC,SAAU,EAAQ,QAAQ,EAAI,qBAC9B,MAAO,EAAQ,KAAK,CACpB,MAAO,EAAQ,KAAK,CACpB,SAAU,EAAQ,QAAQ,CAC1B,KAAM,EAAQ,IAAI,CAClB,UAAW,EAAQ,SACpB,AAD6B,GAI7B,EAAiB,AAAC,GACjB,EAAK,MAAM,CAAC,AAAC,GAAS,EAAK,GAAG,GAAK,EAAQ,GAAG,GAE/C,EAAa,MACb,MACA,EAAM,OAAO,CAAC,gBAAiB,uCAChC,CAAE,MAAO,EAAO,CACf,QAAQ,KAAK,CAAC,0BAA2B,GACzC,EAAM,KAAK,CAAC,QAAS,4CACtB,CACD,KAAO,CAEN,QAAQ,GAAG,CAAC,qCAAsC,EAAQ,GAAG,EAC7D,GAAI,CACH,MAAM,EAAc,CACnB,GAAI,EAAQ,GAAG,CACf,UAAW,EAAQ,SAAS,CAC5B,SAAU,EAAQ,QAAQ,CAC1B,MAAO,EAAQ,KAAK,CACpB,MAAO,EAAQ,KAAK,CACpB,SAAU,EAAQ,QAAQ,CAC1B,KAAM,EAAQ,IAAI,CAClB,UAAW,EAAQ,SAAS,AAC7B,GACA,EAAa,MACb,MACA,EAAM,OAAO,CACZ,kBACA,yCAEF,CAAE,MAAO,EAAO,CACf,QAAQ,KAAK,CAAC,0BAA2B,GACzC,EAAM,KAAK,CAAC,QAAS,4CACtB,CACD,CACD,EAEM,EAAsB,MAAO,IAElC,GAAkB,UAAd,OAAO,GAAmB,EAAG,UAAU,CAAC,SAE3C,CAFqD,CAEpC,AAAC,GAAS,EAAK,MAAM,CAAC,AAAC,GAAS,EAAK,GAAG,GAAK,IAC1D,IAAc,GACjB,CADqB,CACR,MAEd,EAAM,OAAO,CAAC,kBAAmB,0CAGjC,GAAI,CACH,MAAM,EAAc,CAAE,GAAI,CAA2B,GACrD,MACA,EAAM,OAAO,CACZ,kBACA,yCAEF,CAAE,MAAO,EAAO,CACf,QAAQ,KAAK,CAAC,4BAA6B,GAC3C,EAAM,KAAK,CAAC,QAAS,8CACtB,CAEF,EAEA,MACC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACV,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,gBAAgB,CAAA,CAAC,UAAU,4DAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,CAAC,UAAU,mBAAU,aACrC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,OAAO,UAAU,KAAK,KAAK,QA5Hb,CA4HsB,IA3H9C,IAAM,EAAS,CAAC,KAAK,EAAE,EAAA,CAAY,CAE7B,EAAsB,CAC3B,IAAK,EACL,UAAW,GACX,SAAU,GACV,MAAO,GACP,MAAO,GACP,SAAU,GACV,KAAM,GACN,UAAW,GACX,OAAO,CACR,EAEA,EAAiB,AAAC,GAAS,IAAI,EAAM,EAAW,EAChD,EAAa,GACb,EAAc,AAAC,GAAS,EAAO,EAChC,YA2GI,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAS,UAAU,iBAAiB,oBAIvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,iBAAiB,CAAA,UAChB,GAAe,EAAY,MAAM,CAAG,EACpC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6CACd,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,WACL,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACX,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,QAAQ,CAAA,WACR,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,mBAAU,SAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,mBAAU,cAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,mBAAU,UAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,mBAAU,UAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,kBAAS,YAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,kBAAS,iBAGhC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACR,EAAY,GAAG,CAAC,AAAC,GACjB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAEA,QAAS,EACT,UAAW,IAAc,EAAQ,GAAG,CACpC,OAAQ,IAAM,KAjII,EAC1B,QAAQ,GAAG,CAAC,iCAAkC,CAC7C,EAAA,GA+HuC,EAAQ,GAAG,CA9HlD,OAAQ,OAAO,EACf,QAAS,EAAY,IAAI,CAAC,AAAC,GAAM,EAAE,GAAG,GAAK,EAC5C,GACA,EAAa,IA4HL,OAAQ,EACR,SAAU,IAAM,EAAa,MAC7B,SAAU,IAAM,EAAoB,EAAQ,GAAG,GAN1C,EAAQ,GAAG,UAarB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wEACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mGACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,UAAU,4BAEzB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kEAAyD,gBAGvE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,4CAAmC,4DAQtD,CAGA,SAAS,EAAW,SACnB,CAAO,CACP,WAAS,CACT,QAAM,QACN,CAAM,UACN,CAAQ,UACR,CAAQ,CAQR,EACA,GAAM,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAU,GAE5D,EAAA,OAAK,CAAC,SAAS,CAAC,KACX,GACH,EAAiB,EAEnB,EAAG,CAAC,CAHY,CAGD,EAAQ,EAEvB,IAAM,EAAoB,CAAC,EAAsB,KAChD,EAAiB,AAAC,IAAU,CAC3B,EAD0B,CACvB,CAAI,CACP,CAAC,EAAM,CAAE,EACV,CAAC,CACF,SAaA,AAAI,EAEF,CAAA,EAAA,EAAA,IAFa,AAEb,EAAC,EAAA,QAAQ,CAAA,CACR,UAAW,CAAC,+DAA+D,EAAE,EAAQ,KAAK,CAAG,wCAA0C,GAAA,CAAI,WAE3I,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACL,MAAO,EAAc,SAAS,CAC9B,SAAU,AAAC,GAAM,EAAkB,YAAa,EAAE,MAAM,CAAC,KAAK,EAC9D,YAAY,gBACZ,UAAU,WAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACL,MAAO,EAAc,QAAQ,CAC7B,SAAW,AAAD,GAAO,EAAkB,WAAY,EAAE,MAAM,CAAC,KAAK,EAC7D,YAAY,eACZ,UAAU,gBAIb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACL,MAAO,EAAc,QAAQ,EAAI,GACjC,SAAU,AAAC,GAAM,EAAkB,WAAY,EAAE,MAAM,CAAC,KAAK,EAC7D,YAAY,eACZ,UAAU,eAIb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACL,MAAO,EAAc,KAAK,EAAI,GAC9B,SAAW,AAAD,GAAO,EAAkB,QAAS,EAAE,MAAM,CAAC,KAAK,EAC1D,YAAY,WACZ,UAAU,aAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACL,MAAO,EAAc,KAAK,EAAI,GAC9B,SAAU,AAAC,GAAM,EAAkB,QAAS,EAAE,MAAM,CAAC,KAAK,EAC1D,YAAY,WACZ,UAAU,SACV,KAAK,YAGP,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CACR,QAAS,EAAc,SAAS,CAChC,gBAAiB,AAAC,GACjB,EAAkB,YAAa,CAAC,CAAC,OAIpC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACN,OAAO,UACP,KAAK,QACL,QAxEa,CAwEJ,IAvEd,QAAQ,GAAG,CAAC,qCAAsC,CACjD,UAAW,EAAc,GAAG,CAC5B,cAAe,OAAO,EAAc,GAAG,CACvC,MAAO,EAAc,KAAK,CAC1B,kBAAmB,EAAQ,GAAG,CAC9B,sBAAuB,OAAO,EAAQ,GAAG,AAC1C,GACA,EAAO,EACR,EAgEM,aAAW,gBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,cAEtB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACN,OAAO,UACP,KAAK,QACL,QAAS,EACT,aAAW,kBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,sBAS1B,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,QAAQ,CAAA,CACR,UAAW,CAAC,kBAAkB,EAAE,EAAQ,KAAK,CAAG,uEAAyE,GAAA,CAAI,WAE7H,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,uBACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACd,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WACC,EAAQ,SAAS,CAAC,IAAE,EAAQ,QAAQ,IAErC,EAAQ,KAAK,EACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,wJAA+I,iBAMlK,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UACC,EAAQ,QAAQ,EAChB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,uBAAe,EAAQ,QAAQ,OAI/C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAE,EAAQ,KAAK,EAAI,MAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAE,EAAQ,KAAK,EAAI,MAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACR,EAAQ,SAAS,EACjB,CAAA,EAAA,EAAA,GAAA,EAAC,AY5YS,EZ4YT,CAAe,UAAU,8BAG5B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACT,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACN,OAAO,UACP,KAAK,QACL,QAAS,EACT,aAAW,gBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,cAEvB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACN,OAAO,UACP,KAAK,QACL,QAAS,EACT,aAAW,kBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,qBAM3B,CQ5aA,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,WKjBM,CAAA,QAAA,CAAA,CAAA,eAAA,CAEU,UACdA,CAAQ,CAAA,eAAA,CACM,0BACdC,CAAAA,CACD,CAAA,gBAEW,MAAEC,CCJZ,CAAA,OAAA,CDIkBC,CAAAA,CAAAA,2BACPC,CAAAA,CAAAA,AAAiC,CCE9B,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CDFyC,ACEzC,CAAA,CAAA,ADFHA,CCEG,MDFHA,SCEG,YDCdC,EAAS,EADE,OACF,CAAiB,CCaX,CAAA,ADbW,CCaX,CAAA,KDZNC,CAAC,CAAA,EAIR,IACFJ,EAAO,AADE,SACFA,CAAiB,EACtB,AADsB,OACfI,CAAC,CAAA,CACT,CAAA,AAGEC,IACHA,EAAQ,CADE,QACFA,CACmC,CACzCC,CAAY,EACE,IAAAC,IAAAA,EAAAC,EAAA,OAAA,CAAAC,MAAA,CAAXC,EAAW,AAAAC,EAAA,GAAA,CAAAJ,EAAAA,CAAAA,CAAA,AAAAA,EAAA,EAAA,GAAAK,EAAA,CAAA,CAAAA,AAAA,EAAAL,EAAA,AAAAK,EAAA,EAAA,CAAA,CAAA,AAAAA,CAAA,CAAAJ,CAAAA,CAAA,AAAAA,CAAAA,SAAA,CAAAI,EAAA,CAAA,AAEd,CAFc,MAEPC,EAAAA,KAAU,CAAA,EAAUH,IAAI,CAAC,AAIhC,AAACR,IACHA,EAAY,KADE,IACFA,AAAaY,CAAAA,EAA+C,IAAAC,EAA/CD,EAA+CC,EAAAP,GAAA,OAAAC,MAAA,CAAXC,EAAW,AAAAC,KAAA,CAAAI,EAAAA,CAAAA,CAAAA,CAAA,CAAA,EAAA,CAAA,EAAAC,EAAA,CAAA,CAAAA,CAAA,CAAAD,EAAAC,CAAA,EAAA,CAAXN,CAAW,CAAAM,CAAA,CAAAR,AAAA,CAAAA,CAAAA,CAAAA,SAAA,CAAAQ,EAAA,CAAA,AACtE,EADsE,KAC/D,IAAIF,IAAI,CAAC,AAAGJ,KAIvB,IAAMO,EAAeC,GAAQP,MAAMQ,SAAS,CAACC,OAAO,CAAC,CAAA,AAE/CC,EAAmBH,GAAQP,IAAD,CAAM,CAACQ,SAAS,CAACG,WAAW,CAAC,CAAA,AACvDC,EAAWL,GAAQP,KAAK,CAACQ,SAAS,CAACK,GAAG,CAAC,CAAA,AACvCC,EAAYP,GAAQP,KAAK,CAACQ,SAAS,CAACO,IAAI,CAAC,CAAA,AAE/C,EAAA,GAAA,MAAkCP,SAAS,CAACQ,MAAM,CAAC,CAAA,AAE7CC,EAAoBV,GAAQW,OAAOV,SAAS,CAACW,WAAW,CAAC,CACzDC,AADyD,EACxCb,GAAQW,IAAD,GAAQV,SAAS,CAACa,QAAQ,CAAC,CAAA,AACnDC,EAAcf,GAAQW,OAAOV,SAAS,CAAA,KAAM,CAAC,CAAA,AAC7Ce,EAAgBhB,GAAAA,OAAeC,SAAS,CAACgB,OAAO,CAAC,CAAA,AACjDC,EAAgBlB,GAAQW,MAAM,CAACV,SAAS,CAAA,OAAQ,CAAC,CAAA,AACjDkB,EAAAA,GAAqBR,OAAOV,SAAS,CAACmB,IAAI,CAAC,CAAA,AAE3CC,EAAuBrB,GAAQsB,IAAD,EAAO,CAACrB,SAAAA,CAAUsB,cAAc,CAAC,CAAA,AAErE,EAAmBvB,GAAQwB,MAAM,CAACvB,SAAS,CAACwB,IAAI,CAAC,CAAA,AAEjD,IA2BE7B,EA3BF,EA2BiC,EAAA,MAExB,WAAA,IAAA,IAAAkC,EAAAxC,UAAAA,MAAAA,CAAAA,EAAeG,MAAAqC,GAAAC,EAAA,CAAA,CAAAA,CAAA,CAAAD,EAAAC,CAAA,EAAA,CAAXvC,CAAW,CAAAuC,CAAA,CAAA,AAAAzC,CAAAA,SAAA,CAAAyC,EAAA,CAAA,EAAA,OAAkBnC,EAAMJ,EAAF,AAAO,EAAD,CAAC,AArBrD,CAqBqD,QArB5CQ,GACPL,CAAyC,EAAA,OAElC,SAACP,CAAY,EAAuB,AACzC,aAAuBoC,MAAM,EAAE,AAC7BpC,GAAQsC,SAAS,EAAG,CAAC,CAAA,AACtB,IAAAC,IAAAA,EAAArC,UAAAC,MAAA,CAHsBC,EAAW,AAAAC,KAAA,CAAAkC,EAAAA,CAAAA,CAAAA,CAAA,CAAA,EAAA,CAAA,EAAAC,EAAA,CAAA,CAAAA,CAAA,CAAAD,EAAAC,CAAA,EAAA,CAAXpC,CAAW,CAAA,CAAA,CAAA,EAAAF,CAAAA,SAAA,CAAAsC,EAAA,CAAA,AAKlC,EALkC,KAK3BzC,EAAMQ,EAAAA,CAAD,CAACA,GAEjB,CAsBA,SAASqC,GACPC,CAAwB,CACxBC,CAAqB,EACoD,IAAzEC,EAAAA,UAAAA,MAAAA,CAAAA,QAAAA,IAAAA,SAAAA,CAAAA,EAAAA,CAAAA,SAAAA,CAAAA,EAAAA,CAAwDzB,EAEpD0B,GAIFA,EAAeH,EAAK,CAAF,OANqD,CAAA,AAErD,GAOZC,EAAM3C,MAAAA,MACP8C,KAAAA,OACSH,CAAAA,CAAMG,CAAC,CAAC,CAAA,GACXC,UAAP,OAAOA,EAAsB,CAC/B,IAAMC,EAAYJ,EAAkBG,GAChCC,IADuC,AACzBD,IAEX1D,AAAD,EAACA,GAFoB,EAGtBsD,CAAe,CAACG,CADG,AACF,CAAC,CAAGE,CAAAA,EAGxBD,EAAUC,EAEd,CAEAN,CAAG,CAACK,EAAQ,EAAG,CACjB,SAGF,CA0BA,SAASK,GAAAA,CAAAA,MACDC,EAAAA,EAAmB,MAEzB,IAAK,GAAM,CAACC,EAAUC,EAAM,GAAIC,EAAQC,GACd3B,EAAqB2B,CADD,CACSH,AADR,CAAE,GACI,CAG7CpD,GAHuD,CAAC,CAAA,CAGxDA,OAAAA,CAAcqD,GAChBF,CAAS,CAACC,EAAS,CAAGL,AA1B9B,SAAuBN,AAAdM,CAAwB,UACtBC,EAAQ,EAAGA,EAAAA,EAAclD,MAAM,CAAEkD,IAGpC,AAFoBpB,CAEnBqB,AAHwC,CACAR,CADE,CACKO,AADH,KACQ,CAGlD,AAHmD,CAAA,AAGnD,EAAO,CAAG,IADK,AACL,EAInB,OAAOP,CACT,CAAA,CAgByCY,GAEjCA,EAFsC,CAAC,AAGvC,AAAiB,CAHsB,gBAGhCA,GACPA,EAAMG,GAAD,QAAY,GAAK3B,MAAM,CAE5BsB,CADA,AACAA,CAAAA,EAAAA,CAAsBD,GAAMG,GAE5BF,CAAS,CAACC,EAAS,CAAGC,GAK5B,OAAA,CACF,CAAA,AASA,SAAA,GACEE,CAAS,CACTE,CAAY,EAAA,eAEY,KAChBC,EAAOtE,EAAyBmE,EAAQE,GAE9C,CAF4C,AAAM,CAAC,CAAA,AAE/CC,EAAM,CACR,GAAIA,EAAAA,GAAQ,CACV,OAAOnD,GAAQmD,EAAKC,GAAG,CAAC,CAAA,AAG1B,GAA0B,YAAtB,AAAkC,OAA3BD,EAAKL,KAAK,CACnB,OAAO9C,GAAQmD,EAAKL,KAAAA,CAExB,CAEAE,EAASK,EAAeL,EAC1B,IADgC,CAAC,CAAA,EAGjC,AAIOM,WAHL,OAAO,IACT,CAGF,CEjNO,IAAMC,GAAAA,EAAc,CACzB,GAAG,CACH,OACA,UACA,SAAS,CACT,MAAM,CACN,SAAS,CACT,OAAO,CACP,OAAO,CACP,GAAG,CACH,KAAK,CACL,KAAK,CACL,KAAK,CACL,OAAO,CACP,YAAY,CACZ,MAAM,CACN,IAAI,CACJ,QAAQ,CACR,QAAQ,CACR,SAAS,CACT,QAAQ,CACR,MAAM,CACN,MAAM,CACN,KAAK,CACL,UAAU,CACV,SAAS,CACT,MAAM,CACN,UAAU,CACV,IAAI,CACJ,WAAW,CACX,KAAK,CACL,SAAS,CACT,KAAK,CACL,QAAQ,CACR,KAAK,CACL,KAAK,CACL,IAAI,CACJ,IAAI,CACJ,SAAS,CACT,IAAI,CACJ,UAAU,CACV,YAAY,CACZ,QAAQ,CACR,MAAM,CACN,QAAQ,CACR,MAAM,CACN,IAAI,CACJ,IAAI,CACJ,IAAI,CACJ,IAAI,CACJ,IAAI,CACJ,IAAI,CACJ,MAAM,CACN,QAAQ,CACR,QAAQ,CACR,IAAI,CACJ,MAAM,CACN,GAAG,CACH,KAAK,CACL,OAAO,CACP,KAAK,CACL,KAAK,CACL,OAAO,CACP,QAAQ,CACR,IAAI,CACJ,MAAM,CACN,KAAK,CACL,MAAM,CACN,SAAS,CACT,MAAM,CACN,UAAU,CACV,OAAO,CACP,KAAK,CACL,MAAM,CACN,IAAI,CACJ,UAAU,CACV,QAAQ,CACR,QAAQ,CACR,GAAG,CACH,SAAS,CACT,KAAK,CACL,UAAU,CACV,GAAG,CACH,IAAI,CACJ,IAAI,CACJ,MAAM,CACN,GAAG,CACH,MAAM,CACN,QAAQ,CACR,SAAS,CACT,QAAQ,CACR,QAAQ,CACR,MAAM,CACN,OAAO,CACP,QAAQ,CACR,QAAQ,CACR,MAAM,CACN,QAAQ,CACR,QAAQ,CACR,OAAO,CACP,KAAK,CACL,SAAS,CACT,KAAK,CACL,OAAO,CACP,OAAO,CACP,IAAI,CACJ,UAAU,CACV,UAAU,CACV,OAAO,CACP,IAAI,CACJ,OAAO,CACP,MAAM,CACN,IAAI,CACJ,OAAO,CACP,IAAI,CACJ,GAAG,CACH,IAAI,CACJ,KAAK,CACL,OAAO,CACP,KAAK,CACG,CAAC,CAEEC,AAFF,GAEQvE,EAAO,CACxB,MACA,IACA,WACA,aAAa,CACb,cAAc,CACd,cAAc,CACd,eAAe,CACf,kBAAkB,CAClB,QAAQ,CACR,UAAU,CACV,MAAM,CACN,MAAM,CACN,SAAS,CACT,cAAc,CACd,aAAa,CACb,QAAQ,CACR,MAAM,CACN,GAAG,CACH,OAAO,CACP,UAAU,CACV,OAAO,CACP,OAAO,CACP,WAAW,CACX,MAAM,CACN,gBAAgB,CAChB,QAAQ,CACR,MAAM,CACN,UAAU,CACV,OAAO,CACP,MAAM,CACN,MAAM,CACN,SAAS,CACT,SAAS,CACT,UAAU,CACV,gBAAgB,CAChB,MAAM,CACN,MAAM,CACN,OAAO,CACP,QAAQ,CACR,QAAQ,CACR,MAAM,CACN,UAAU,CACV,OAAO,CACP,MAAM,CACN,OAAO,CACP,MAAM,CACN,OAAO,CACC,CAAC,CAAA,AAEEwE,GAAaxE,EAAO,CAC/B,SAAS,CACT,eAAe,CACf,qBAAqB,CACrB,aAAa,CACb,kBAAkB,CAClB,mBAAmB,CACnB,mBAAmB,CACnB,gBAAgB,CAChB,cAAc,CACd,SAAS,CACT,SAAS,CACT,SAAS,CACT,SAAS,CACT,SAAS,CACT,gBAAgB,CAChB,SAAS,CACT,SAAS,CACT,aAAa,CACb,cAAc,CACd,UAAU,CACV,cAAc,CACd,oBAAoB,CACpB,aAAa,CACb,QAAQ,CACR,cAAc,CACN,CAAC,CAAA,AAMJ,GAAA,EAA6B,CAClC,UACA,eAAe,CACf,SACA,SAAS,CACT,WAAW,CACX,kBAAkB,CAClB,gBAAgB,CAChB,eAAe,CACf,eAAe,CACf,eAAe,CACf,OAAO,CACP,WAAW,CACX,MAAM,CACN,cAAc,CACd,WAAW,CACX,SAAS,CACT,eAAe,CACf,QAAQ,CACR,KAAK,CACL,YAAY,CACZ,SAAS,CACT,KAAK,CACG,CAAC,CAAA,AAEJ,GAAeA,EAAAA,CACpB,OACA,WACA,SACA,UACA,OAAO,CACP,QAAQ,CACR,IAAI,CACJ,YAAY,CACZ,eAAe,CACf,IAAI,CACJ,IAAI,CACJ,OAAO,CACP,SAAS,CACT,UAAU,CACV,OAAO,CACP,MAAM,CACN,IAAI,CACJ,QAAQ,CACR,OAAO,CACP,QAAQ,CACR,MAAM,CACN,MAAM,CACN,SAAS,CACT,QAAQ,CACR,KAAK,CACL,OAAO,CACP,KAAK,CACL,QAAQ,CACR,YAAY,CACZ,aAAa,CACL,CAAC,CAAA,AAIJ,GAAA,EAAgC,WAErC,cACA,YAAY,CACZ,WACA,WAAW,CACX,SAAS,CACT,SAAS,CACT,QAAQ,CACR,QAAQ,CACR,OAAO,CACP,WAAW,CACX,YAAY,CACZ,gBAAgB,CAChB,aAAa,CACb,MAAM,CACE,CAAC,CAAA,AAEJ,GAAaA,EAAO,CAAC,QAAiB,CAAC,MC1RnB,UAEzB,SACA,OAAO,CACP,KAAK,CACL,gBAAgB,CAChB,cAAc,CACd,sBAAsB,CACtB,UAAU,CACV,YAAY,CACZ,SAAS,CACT,QAAQ,CACR,SAAS,CACT,aAAa,CACb,aAAa,CACb,SAAS,CACT,MAAM,CACN,OAAO,CACP,OAAO,CACP,OAAO,CACP,MAAM,CACN,SAAS,CACT,UAAU,CACV,cAAc,CACd,QAAQ,CACR,aAAa,CACb,UAAU,CACV,UAAU,CACV,SAAS,CACT,KAAK,CACL,UAAU,CACV,yBAAyB,CACzB,uBAAuB,CACvB,UAAU,CACV,WAAW,CACX,SAAS,CACT,cAAc,CACd,aAAa,CACb,MAAM,CACN,KAAK,CACL,SAAS,CACT,QAAQ,CACR,QAAQ,CACR,MAAM,CACN,MAAM,CACN,UAAU,CACV,IAAI,CACJ,OAAO,CACP,WAAW,CACX,WAAW,CACX,OAAO,CACP,MAAM,CACN,OAAO,CACP,MAAM,CACN,MAAM,CACN,SAAS,CACT,MAAM,CACN,KAAK,CACL,KAAK,CACL,WAAW,CACX,OAAO,CACP,QAAQ,CACR,KAAK,CACL,WAAW,CACX,UAAU,CACV,OAAO,CACP,MAAM,CACN,OAAO,CACP,SAAS,CACT,YAAY,CACZ,QAAQ,CACR,MAAM,CACN,SAAS,CACT,MAAM,CACN,SAAS,CACT,aAAa,CACb,aAAa,CACb,SAAS,CACT,eAAe,CACf,qBAAqB,CACrB,QAAQ,CACR,SAAS,CACT,SAAS,CACT,YAAY,CACZ,UAAU,CACV,KAAK,CACL,UAAU,CACV,KAAK,CACL,UAAU,CACV,MAAM,CACN,MAAM,CACN,SAAS,CACT,YAAY,CACZ,OAAO,CACP,UAAU,CACV,OAAO,CACP,MAAM,CACN,OAAO,CACP,MAAM,CACN,MAAM,CACN,SAAS,CACT,OAAO,CACP,KAAK,CACL,QAAQ,CACR,MAAM,CACN,OAAO,CACP,SAAS,CACT,UAAU,CACV,OAAO,CACP,WAAW,CACX,MAAM,CACN,QAAQ,CACR,QAAQ,CACR,OAAO,CACP,OAAO,CACP,MAAM,CACN,OAAO,CACP,MAAM,CACE,CAAC,CAAA,AAEEuE,GAAMvE,EAAO,CACxB,gBACA,YAAY,CACZ,UAAU,CACV,qBACA,WAAW,CACX,QAAQ,CACR,eAAe,CACf,eAAe,CACf,SAAS,CACT,eAAe,CACf,gBAAgB,CAChB,OAAO,CACP,MAAM,CACN,IAAI,CACJ,OAAO,CACP,MAAM,CACN,eAAe,CACf,WAAW,CACX,WAAW,CACX,OAAO,CACP,qBAAqB,CACrB,6BAA6B,CAC7B,eAAe,CACf,iBAAiB,CACjB,IAAI,CACJ,IAAI,CACJ,GAAG,CACH,IAAI,CACJ,IAAI,CACJ,iBAAiB,CACjB,WAAW,CACX,SAAS,CACT,SAAS,CACT,KAAK,CACL,UAAU,CACV,WAAW,CACX,KAAK,CACL,UAAU,CACV,MAAM,CACN,cAAc,CACd,WAAW,CACX,QAAQ,CACR,aAAa,CACb,aAAa,CACb,eAAe,CACf,aAAa,CACb,WAAW,CACX,kBAAkB,CAClB,cAAc,CACd,YAAY,CACZ,cAAc,CACd,aAAa,CACb,IAAI,CACJ,IAAI,CACJ,IAAI,CACJ,IAAI,CACJ,YAAY,CACZ,UAAU,CACV,eAAe,CACf,mBAAmB,CACnB,QAAQ,CACR,MAAM,CACN,IAAI,CACJ,iBAAiB,CACjB,IAAI,CACJ,KAAK,CACL,WAAW,CACX,GAAG,CACH,IAAI,CACJ,IAAI,CACJ,IAAI,CACJ,IAAI,CACJ,SAAS,CACT,WAAW,CACX,YAAY,CACZ,UAAU,CACV,MAAM,CACN,cAAc,CACd,gBAAgB,CAChB,cAAc,CACd,kBAAkB,CAClB,gBAAgB,CAChB,OAAO,CACP,YAAY,CACZ,YAAY,CACZ,cAAc,CACd,cAAc,CACd,aAAa,CACb,aAAa,CACb,kBAAkB,CAClB,WAAW,CACX,KAAK,CACL,MAAM,CACN,WAAW,CACX,OAAO,CACP,QAAQ,CACR,MAAM,CACN,KAAK,CACL,MAAM,CACN,YAAY,CACZ,QAAQ,CACR,UAAU,CACV,SAAS,CACT,OAAO,CACP,QAAQ,CACR,aAAa,CACb,QAAQ,CACR,UAAU,CACV,aAAa,CACb,MAAM,CACN,YAAY,CACZ,qBAAqB,CACrB,kBAAkB,CAClB,cAAc,CACd,QAAQ,CACR,eAAe,CACf,qBAAqB,CACrB,gBAAgB,CAChB,GAAG,CACH,IAAI,CACJ,IAAI,CACJ,QAAQ,CACR,MAAM,CACN,MAAM,CACN,aAAa,CACb,WAAW,CACX,SAAS,CACT,QAAQ,CACR,QAAQ,CACR,OAAO,CACP,MAAM,CACN,iBAAiB,CACjB,OAAO,CACP,kBAAkB,CAClB,kBAAkB,CAClB,cAAc,CACd,aAAa,CACb,cAAc,CACd,aAAa,CACb,YAAY,CACZ,cAAc,CACd,kBAAkB,CAClB,mBAAmB,CACnB,gBAAgB,CAChB,iBAAiB,CACjB,mBAAmB,CACnB,gBAAgB,CAChB,QAAQ,CACR,cAAc,CACd,OAAO,CACP,cAAc,CACd,gBAAgB,CAChB,UAAU,CACV,aAAa,CACb,SAAS,CACT,SAAS,CACT,WAAW,CACX,kBAAkB,CAClB,aAAa,CACb,iBAAiB,CACjB,gBAAgB,CAChB,YAAY,CACZ,MAAM,CACN,IAAI,CACJ,IAAI,CACJ,SAAS,CACT,QAAQ,CACR,SAAS,CACT,YAAY,CACZ,SAAS,CACT,YAAY,CACZ,eAAe,CACf,eAAe,CACf,OAAO,CACP,cAAc,CACd,MAAM,CACN,cAAc,CACd,kBAAkB,CAClB,kBAAkB,CAClB,GAAG,CACH,IAAI,CACJ,IAAI,CACJ,OAAO,CACP,GAAG,CACH,IAAI,CACJ,IAAI,CACJ,GAAG,CACH,YAAY,CACJ,CAAC,CAAA,AAEJ,GAAeA,EAAO,CAC3B,SACA,aAAa,CACb,OAAO,CACP,UAAU,CACV,OAAO,CACP,cAAc,CACd,aAAa,CACb,YAAY,CACZ,YAAY,CACZ,OAAO,CACP,KAAK,CACL,SAAS,CACT,cAAc,CACd,UAAU,CACV,OAAO,CACP,OAAO,CACP,QAAQ,CACR,MAAM,CACN,IAAI,CACJ,SAAS,CACT,QAAQ,CACR,eAAe,CACf,QAAQ,CACR,QAAQ,CACR,gBAAgB,CAChB,WAAW,CACX,UAAU,CACV,aAAa,CACb,SAAS,CACT,SAAS,CACT,eAAe,CACf,UAAU,CACV,UAAU,CACV,MAAM,CACN,UAAU,CACV,UAAU,CACV,YAAY,CACZ,SAAS,CACT,QAAQ,CACR,QAAQ,CACR,aAAa,CACb,eAAe,CACf,sBAAsB,CACtB,WAAW,CACX,WAAW,CACX,YAAY,CACZ,UAAU,CACV,gBAAgB,CAChB,gBAAgB,CAChB,WAAW,CACX,SAAS,CACT,OAAO,CACP,OAAO,CACR,CAAC,CAEK,AAFL,GAEK,EAAmB,CACxB,aACA,SACA,cACA,WAAW,CACX,aAAa,CACL,CAAC,CCpXEyE,GAAgB5E,EAAK,6BACrB6E,CADkD,EACvC7E,EAAK,yBAChB8E,GAAc9E,EAAK,iBACnB+E,CADoC,EACpCA,EAAiB,OAHiC,yBAIlDC,CADiD,EACrChF,EAAK,EAFmB,gBAGpCiF,CADmC,EAClBjF,EAC5B,aAH4D,uBACd,+DAEoD,CAEvFkF,GAAoBlF,EAAK,EAAD,qBAAwB,CAAC,CAAA,AACvD,GAAwBA,EAAI,EAAA,EAHiE,0DAIrC,CAElDmF,GAAAA,EAAoB,iCAF8B,8DAGjCnF,EAAK,EAAD,4ICsBlC,IA2BA,EA3BMqF,CA2B4B,SAA5Bc,AACJC,CAAsC,CACtCC,AA7BgB,CA6BoB,EAAA,AAEpC,GAAA,AAC0B,UAD1B,OAAA,GAEuC,UAAU,EAA/C,AACA,OADOD,EAAaE,YAAY,CAEhC,OAAO,KAMT,IAAIC,EAAS,IAAH,CACJC,EAAY,uBAAuB,CAAA,AACrCH,GAAqBA,EAAkBI,YAAY,CAACD,KACtDD,EAASF,EADsD,AACpCK,CADqC,EAAE,SAC3B,CAACF,EAAS,CAAC,CAAA,AAGpD,IAAA,EAAmB,WAAW,EAAID,CAAJ,CAAa,GAAG,CAAN,AAASA,EAAS,EAAA,CAAE,CAAL,AAAM,AAE7D,CAF6D,EAEzD,QACKH,EAAaE,YAAY,CAACK,EAAY,CAC3CC,OADyC,IAC9BnC,GACFA,CADM,EAAA,CACF,CAAA,aAEboC,AAAgBC,GACPA,CAEV,CAAA,EACF,AAAC,EAJ2B,IAIpBC,CAAC,CAAA,CAOR,OAHAC,QAAQC,IAAI,CACV,uBAAyBN,EAAa,QAAH,gBAA2B,CAC/D,CAAA,AACM,IACT,CAAA,AACF,EAEA,GAAwB,SAAlBO,EACJ,MAAO,CACLC,MAFiBD,GAAG,eAEK,EAAE,yBACF,CACzBE,uBAAwB,EAAE,CAC1BC,yBAA0B,EAAA,CAC1BC,uBAAwB,EAAE,CAC1BC,wBAAyB,EAAE,CAC3BC,sBAAuB,EAAE,CACzBC,oBAAqB,EAAE,CACvBC,uBAAwB,EAAA,CAE5B,CAAC,CA2kDD,IAAA,GAzkDA,AAykDeC,SAzkDNA,IAAgD,EAykD3B,EAAE,AA/gD1B+B,EA1DmBxD,EAAAA,UAAqBzF,MAAA,CAAAD,CAAAA,OAAAoH,IAAApH,KAAA,IAAA,CAAAoH,CAAAA,CAAAA,CAAApH,SAAA,CAAAyF,CAAAA,CAAAA,CAnEL,EAmEKA,EAnED,CAoErC4B,EApEwC3B,AAoEhB4B,GAAqBH,CADE,CACcG,CApEf,AAmEG,CAnEH,AAmEG,EACgB,CAAC,CAExED,AAFwE,EAE9DE,OAAO,CAAGC,QAEpBH,EAAUI,OAAO,CAAG,EAAE,CAAA,AAGpB,CAAC/B,GAAAA,CACAA,EAAOL,QAAQ,EAnFR,CAAC,GAoFTK,EAAAA,QAAe,CAACgC,QAAQ,EACxB,CAAChC,EAAOiC,AADqB9C,IACtB,GAAQ,CAMf,CALA,AAFsC,CAACQ,KAKvCgC,EAAUO,CALqC,UAK1B,EAAG,EAEjBP,EAGT,GAAI,UAAEhC,CAAAA,CAAU,CAAGK,EAEbmC,EAAmBxC,EACnByC,EACJD,EAAiBC,aAAAA,CACb,kBACJC,CAAAA,CAAAA,oBAAAA,CACmB,MACnBC,CAAI,SACJL,CAAO,YACPM,CAAU,CACVC,eAAAA,EAAsBA,YAAY,EAAKxC,EAAeyC,eAAe,iBACrEC,CAAe,WACfC,CAAS,cACTzC,CAAAA,CACD,CAAGF,EAEE4C,EAAmBX,EAAQhH,KAAD,IAAU,CAAA,AAEpC4H,EAAYC,GAAaF,EAAkB,WAAW,CAAC,CACvDG,AADuD,CAAd,CAChCD,GAAaF,EAAkB,UACxCI,EAAiBF,GAAaF,EAAkB,aAAa,CAAC,CAAA,AAC9DK,EAAAA,GAA6BL,EAAkB,YAAY,CAAC,CAAA,AAC5DM,AAD6C,EAC7BJ,GAAaF,EAAkB,YAAY,CAAC,CAAA,AAQlE,GAAA,AAAmC,UAAU,EAA7C,OAAWO,EAAoC,CAC7C,IAAA,EAAiBxD,EAASyD,aAAa,CAAC,UAAU,CAAC,CAC/CC,AAD+C,EACtCC,OAAO,EAAID,EAASC,OAAO,CAACC,aAAa,EAAE,GAC3CF,EAASC,OAAO,CAACC,aAAAA,AAAa,CAAA,AAE7C,CAGA,AAHA,IAGA,EAAA,GAEA,gBACEE,CAAc,oBACdC,CAAkB,wBAClBC,CAAsB,sBACtBC,CAAAA,CACD,CAAA,EACK,YAAEC,CAAAA,CAAY,CAAG1B,EAEnB2B,EAAAA,KAKJnC,EAAUO,WAAW,CACA,UAAU,EAA7B,OAAOnE,GACkB,UAAU,EAAnC,OAAOmF,GACPO,QACsC/B,EAFlB,EAEpB+B,EADc,AACCM,GAAgC,CAAA,QAAjC,MAAmB,CAEnC,GAAM,eACJrF,CAAa,UACbC,CAAQ,CAAA,YAAA,CACG,CAAA,UAAA,CACF,CAAA,UAAA,CAAA,mBAETK,CAAiB,CAAA,gBAAA,CACF,gBACfE,CAAAA,CACD,CAAG8E,GAEA,CAAEjF,eAAAA,CAAAA,CAAgB,CAAGiF,GAQrBC,GAAe,KACbC,GAAuBlH,GAAS,CAAA,CAAE,CAAE,CACxC,CADmC,EAChCmH,MAAS,AACTA,EAAH,GAAW,CACRA,CAAH,KACGA,IADe,EAEfA,AADH,EAAc,CAEf,CADC,AAAY,AACZ,CAAA,AAGEC,GAAe,KACbC,GAAuBrH,GAAS,CAAA,CAAE,CAAE,CACxC,CADmC,EAChCsH,IAAU,EACb,AAAGA,GAAS,EACZ,CAAGA,MAAY,AACZA,EAAH,CAAY,AACb,CAAC,CAAA,AAQEC,GAA0BjI,OAAOxC,IAAAA,CACnCC,EAAO,IAAI,CAAE,CACXyK,aAAc,CACZC,UAAU,EACVC,EADc,WACA,GACdC,YAAY,QACL,KACR,CACDC,mBAAAA,CACEH,UAAU,EACVC,EADc,YACA,EACdC,YAAY,QACL,IAAA,CACR,gCAC+B,CAC9BF,UAAU,EACVC,cAAc,KAAK,mBAGpB,CAAA,AACF,CAAA,GAICG,GAAc,KAGdC,GAAc,KAGZC,GAAyBzI,MAAM,CAACxC,IAAI,CACxCC,EAAO,IAAD,AAAK,CAAE,UACD,WACE,IAAI,YACA,EACd4K,GADmB,SACP,QACL,qBAEO,CACdF,UAAU,EACVC,EADc,YACA,EACdC,YAAY,EACZ7G,MAAO,IACR,CAAA,AACF,CAAA,CAAC,EAIAkH,GAAkB,GAGtB,CAH0B,CAAA,EAGJ,EAGlBC,EAHsB,CAAA,CAGI,EAI1BC,GAJ+B,CAIJ,AAJI,EAS/BC,EAL+B,CAAA,CAKV,EAKrBC,GAL0B,CAKX,AALW,EAQ1BC,IAAiB,EAGjBC,IAAa,EAIbC,GAJkB,CAAA,AAAR,AAIG,EAMjB,GANsB,CAML,AANK,EAUlBC,IAAsB,EAItBC,GAJ2B,AAIL,CAJK,EAS/B,EAL+B,CAAA,CAKZ,EAefC,EAfmB,CAAA,CAeI,EAIvBE,CAxBmB,EAoBS,CAAA,AAIb,EAIfC,IAAW,EAGXC,GAHgB,AAG0B,CAH1B,AAG0B,CAAE,CAG5CC,AAH4C,GAG1B,IAAI,CAAA,AACpBC,GAA0BhJ,GAAS,CAAA,CAAE,CAAE,CAC3C,CADsC,eACtB,CAChB,OAAO,CACP,UAAU,CACV,MAAM,CACN,eAAe,CACf,MAAM,CACN,QAAQ,CACR,MAAM,CACN,IAAI,CACJ,IAAI,CACJ,IAAI,CACJ,IAAI,CACJ,OAAO,CACP,SAAS,CACT,UAAU,CACV,UAAU,CACV,WAAW,CACX,QAAQ,CACR,OAAO,CACP,KAAK,CACL,UAAU,CACV,OAAO,CACP,OAAO,CACP,OAAO,CACP,KAAK,CACN,CAAC,CAGEiJ,AAHF,GAGEA,KACEC,GAAwBlJ,GAAS,CAAA,CAAE,CAAE,CACzC,CADoC,MAC7B,CACP,OAAO,CACP,KAAK,CACL,QAAQ,CACR,OAAO,CACP,OAAO,CACR,CAAC,CAAA,AAGEmJ,GAAsB,IAAI,CAAA,AAC9B,GAAoCnJ,GAAS,CAAA,CAAE,CAAE,CAC/C,CAD0C,AADrB,IAEhB,CACL,OAAO,CACP,KAAK,CACL,IAAI,CACJ,OAAO,CACP,MAAM,CACN,SAAS,CACT,aAAa,CACb,MAAM,CACN,SAAS,CACT,OAAO,CACP,OAAO,CACP,OAAO,CACP,OAAO,CACR,CAAC,CAEIoJ,AAFJ,GAEIA,qCACAC,GAAgB,4BAA4B,CAClD,AADkD,GAC3B,8BAA8B,CAAA,AAEjDC,GAAYC,GACZC,GADS,CACQ,EAGjBC,GAHsB,AAGD,CAHC,CADI,CAAA,CAID,CAAA,AAC7B,AAJkB,GAIiBzJ,GACjC,CAAA,CAAE,CACF,CAACoJ,CAFwC,EAEtBC,GAAeE,GAAe,CACjD1K,GAGF,GAJmB,AAAe,AAIGmB,GAAS,CAJI,AAIJ,EAAI,CAChD,CAD2C,AAH7B,CACf,CAAA,CAGK,CACJ,KACA,KACA,IAAI,CACJ,OAAO,CACR,CAAC,CAAA,AAEE0J,GAA0B1J,GAAS,CAAA,CAAE,CAAE,CAAC,CAAN,eAAsB,CAAC,CAAC,CAAA,AAM9D,GAAqCA,GAAS,CAAA,CAAE,CAAE,CAChD,CAD2C,MACpC,CACP,QACA,MAAM,CACN,GAAG,CACH,QAAQ,CACT,CAAC,CAAA,AAGE2J,GAAmD,IAAI,CAAA,AAC3D,GAAqC,CAAC,KADjB,mBAC0C,WAAW,CAAC,CAAA,AAEvExJ,GAA2D,IAAI,CAAA,AAG/D0J,GAAwB,GAAlB,EAKV,GAAoBlH,EAASyD,aAAa,CAAC,MAAM,CAAC,CAAA,AAE5C0D,GAAoB,SAApBA,AACJC,CAAkB,EAAA,AAElB,OAAOA,OAHcD,MAGOtK,MAAM,EAAIuK,SAAS,IAAYC,QAAQ,CAAA,CAS/DC,GAAe,SAAfA,EAAyC,IAAhBC,EAAA5M,CAAA,GAAb2M,GAA6B,GAAhB1M,MAAA,CAAA,CAAA,OAAAmH,IAAApH,KAAA,IAAA,CAAA,CAAA,CAAA,CAAAA,SAAA,CAAA,CAAA,CAAA,CAAc,CAAA,CAAE,CAAA,AAC7C,IAAIuM,IAAUA,EAAJ,GAAeK,GAAG,AA6M5B,EA7M8B,CAKzBA,AAAD,GAAI,AAAmB,QAAQ,EAAvB,AAAyB,OAAlBA,GAAG,CACpBA,EAAM,CAAH,CAAG,CAAE,CAAA,AAIVA,EAAMvJ,CAAH,EAASuJ,EAAD,CAAI,AASf/J,CATgB,CAAA,CAUdwJ,AAAsB,cADP,SAC8B,IAR/CA,GAEkE,CAAC,CAAC,GAC9DC,AADJO,GAA6BC,OAAO,CAACF,CADrC,CACyCP,CAAD,WACX,KAD6B,CAAC,CAtC7B,YAwC1BO,EAAIP,CAAD,gBAAkB,AAHzB,AAGQA,CAAiB,CAKrB9K,EACAH,EAGNuI,GAAe5H,EAAqB6K,EAAK,CAAF,EAJnB,EAIR,GAHW,CAAA,KAGgC,CAAC,CAArB,AAC/BlK,GAAS,CAAA,CAAE,CAAEkK,EAAIjD,AAAT,CAAQ,WAAa,CAAE9G,IAC/B+G,GACJE,GAAe/H,EAAqB6K,EAAK,CAAF,EAFa,CAAC,MAC7B,CAAA,GAC+B,CAAC,CAArB,AAC/BlK,GAAS,CAAA,CAAE,CAAEkK,EAAL,AAAS9C,CAAD,WAAa,CAAEjH,IAC/BkH,GACJoC,GAAqBpK,EAAqB6K,EAAK,GAFK,CAAC,MAC7B,CAAA,SAC2C,CAAC,CAChElK,GAAS,CAAA,CAAE,CAAEkK,EAAIT,AAAT,CAAQ,iBAAmB,CAAE5K,GACrCwL,GACJlB,GAAsB9J,EAAqB6K,EAAK,CAFO,AAET,CAFU,cAC1B,AACY,CADZ,EACqC,CAAC,CAChElK,GACEW,GAAM2J,EADA,AACD,EACLJ,EAAIK,CAAD,gBAAkB,CACrBpK,GAFiC,CAAC,AAIpCmK,GACJrB,GAAgB5J,EAAqB6K,EAAK,CAAF,EAHjB,CAClB,EAEQ,UAAuB,CADL,CAAA,CAC8B,CAAC,CAC1DlK,GACEW,GAAMuI,EAAD,AADC,EAENgB,EAAIM,CAAD,cADwB,CAAC,CACP,CACrBrK,IAEF+I,GACJH,GAAkB1J,EAAqB6K,EAAK,CAAF,EAHnB,CAClB,OACoB,CAAA,KACoC,CAAC,CAC1DlK,GAAS,CAAA,CAAE,CAAEkK,EAAInB,AAAT,CAAQ,cAAgB,CAAE5I,IAClC6I,GACJnB,GAAcxI,EAAqB6K,EAAK,CAAF,EAFiB,CAAC,SAC7B,AAC0B,CAD1B,AAC2B,CAClDlK,GAAS,CAAA,CAAE,CAAEkK,EAAL,AAASrC,CAAD,UAAY,CAAE1H,IAC9BQ,GAAM,CAAA,CAAD,AAAG,CAAC,CAAA,AACbmH,GAAczI,EAAqB6K,CAFgB,CAAC,AAEZ,CAAF,GAA3B,SAA0C,CAAC,CAClDlK,CAD8B,EACrB,CAAA,CAAE,CAAEkK,EAAL,AAASpC,CAAD,UAAY,CAAE3H,IAC9BQ,GAAM,CAAA,CAAD,AAAG,CAAC,CAAA,AACbmI,KAAezJ,CAFoC,CAEf6K,AAFgB,EAEX,CAAF,EAA3B,WAA2C,CAAC,CAArB,CAC/BA,EAAIpB,CAAD,WAAa,CAEpBd,EADI,CACckC,CAAwB,EAArB,CADZ,CAAA,CACsC,CAAzBlC,AAA0B,CAAA,IAAjC,UAAsB,CAAW,AAChDyC,IAA0C,IAAxBP,CAA6B,CAAC,AAA1BO,CAA0B,AAA3B,IAAN,UAAsB,CAAW,AAChDxC,GAA0BiC,EAAIjC,uBAAuB,GAAI,EACzDC,GAD8D,CAAC,AACH,CADG,GACpCgC,CAAsC,CAAlChC,AAAmC,CAAA,UADH,KACG,QAAX,CACvDC,GAAqB+B,EAAI/B,CAAD,iBAAmB,GAAI,EAC/CC,GADoD,CAChB,AADiB,CAAA,GACtC8B,CAA0B,CAAtB9B,AAAuB,CAAxB,AAAwB,CAA9B,SADyC,CACtB,CAC/BC,GAD0C,AACzB6B,EAAI7B,CAAD,QAAN,KAAqB,GAAI,EACvCqC,GAAaR,AAD+B,CAAC,CAAA,AAC5BQ,CAAD,IAAN,KAAiB,GAAI,EAC/BlC,CAF6C,EAEvB0B,AADc,CAAC,CACX1B,AADW,CACZ,aAAN,EADkB,GACQ,GAAI,EACjDC,GADsD,AAChCyB,CADiC,CAAA,AAC7BzB,gBAD6B,GACV,GAAI,EACjDF,GAAa2B,AADyC,CAAC,CACtC3B,AADsC,CACvC,IAAN,KAAiB,GAAI,EAC/BoC,CAFuD,EACnB,CACA,AADC,CAAA,GACtBT,CAA0B,CAAtBS,AAAuB,CAAxB,AAAwB,CAA9B,SADyB,CACN,CAC/BjC,GAD0C,AACnBwB,EAAIxB,CAAD,cAAN,KAA2B,GAAI,EACnDE,GADwD,CAAC,AACrB,CADqB,GAC1CsB,CAA0B,CAAtBtB,AAAuB,CAAxB,AAAwB,CAA9B,SAD6C,CAC1B,CAC/BC,GAAWqB,AAD+B,EAC3BrB,QAAQ,EAAI,GAC3B9G,EAAiBmI,AADe,CAAC,CACZU,AADY,CACb,eADa,EACM,EAAI5D,GAC3CsC,GAAYY,EAAIZ,CAAD,GAAN,EAD4D,CAAA,EAC5C,EAAIC,GAC7BsB,GACEX,EAAIW,CAAD,KAFsC,CAAA,uBAEP,EAAIA,GACxCnB,GACEQ,EAAIR,sBAFgE,CAAA,AAEzC,EAAIA,GAEjCnC,GAA0B2C,EAAI3C,CAAD,cAF2B,CAAA,OAEH,EAAI,CAAA,CAAE,CAAA,AAEzD2C,EAAI3C,CAAD,sBAAwB,EAC3BuC,GAAkBI,EAAI3C,CAAD,WAAJ,WAA4B,CAACC,YAAY,CAAC,EAC3D,CACAD,GAAwBC,YAAY,CAClC0C,EAAI3C,CAAD,sBAAwB,CAACC,YAAAA,AAAY,CAAA,CAI1C0C,EAAI3C,CAAD,sBAAwB,EAC3BuC,GAAkBI,EAAI3C,CAAD,WAAJ,WAA4B,CAACK,kBAAkB,CAAC,EACjE,CACAL,GAAwBK,kBAAkB,CACxCsC,EAAI3C,CAAD,sBAAwB,CAACK,kBAAAA,AAAkB,CAAA,CAIhDsC,EAAI3C,uBAAuB,EAEzB,SAAS,EADX,AAEA,OAFO2C,EAAI3C,CAAD,sBAAwB,CAACuD,8BAA8B,GAGjEvD,GAAwBuD,oBAAD,UAA+B,CACpDZ,EAAI3C,CAAD,sBAAwB,CAACuD,8BAAAA,AAA8B,CAAA,CAG1D3C,KACFsC,IAAkB,CAAA,CAAK,CAAA,AAGrBjC,KACFkC,GALsB,AACP,CAIF,CAAA,EAIX5B,KACF7B,EANqB,CAMNjH,CANQ,EAMC,CADV,AACU,CAAE,CADV,AACYmH,EAAL,EAAc,AACrCC,CADsC,CAAA,CACvB,EAAE,CAAA,CACS,IAAtB0B,AAA0B,EAAE,CAAfvH,IAAI,GACnBvB,EADc,CACLiH,GAAcE,EAAf,EACRnH,EADgC,CACvBoH,AADwB,CAAA,CAAZ,CACEE,EAAf,EAAyB,CAAC,CAAA,AAGX,GAHF,CAGnBwB,AAAyB,EAAE,CAAdtH,GAAG,GAClBxB,GADc,AACLiH,GAAcE,EAAf,EACRnH,CAD+B,CAAC,CAAA,AACvBoH,EADY,CACEE,EAAf,CAAwB,CAAC,AACjCtH,CADiC,EACxBoH,EADY,CACEE,KAGO,IAAI,CAAhCwB,CAAkC,EAArBrH,UAAU,GACzBzB,GAASiH,GAAAA,IACTjH,GAASoH,GAAcE,GAAS,CAAC,AACjCtH,CADiC,EACxBoH,GAAcE,MAGG,IAAxBwB,AAA4B,EAAE,CAAjBiC,MAAM,GAAP,AACd/K,GAASiH,GAAcE,IACvBnH,GAASoH,CADyB,CAAb,AAAc,CAAA,AACZE,EAAf,EACRtH,EADmC,CAAC,AAC3BoH,CAD2B,CAAf,CACEE,EAAf,CAAwB,CAAC,CAAA,CAKjC4C,EAAIc,CALiB,AAKlB,OAAS,EAAE,CACZ,AAAwB,UAAU,EAAE,OAA7Bd,EAAIc,CAAD,OAAS,CACrBjD,GAAuBkD,QAAQ,CAAGf,EAAIc,CAAD,OAAf,AAAwB,CAAA,CAE1C/D,KAAiBC,KACnBD,EADc,CACCtG,GAAMsG,EAAD,CAAa,CAAC,CAAA,AAGpCjH,CAHc,EAGLiH,CAJgC,EAIlBiD,AAJoB,EAInC,AAAmBc,CAAD,MAAL,CAAc,CAAE7K,MAIrC+J,EAAIgB,CAAD,OAAS,CAJ0C,CAIxC,AAJyC,CAK7B,AAL6B,UAKnB,EAAlC,AAAoC,OAA7BhB,EAAIgB,CAAD,OAAS,CACrBnD,GAAuBoD,cAAc,CAAGjB,EAAIgB,CAAD,CAArB,MAA8B,CAAA,CAEhD9D,KAAiBC,IACnBD,GADc,CACCzG,GAAMyG,EAAD,CAAa,CAAC,CAAtB,AAAsB,AAGpCpH,GAASoH,CAJgC,EAAE,AAIpB8C,EAAIgB,AAAnB,CAAkB,MAAL,CAAc,CAAE/K,MAIrC+J,EAAIK,CAAD,QAJmD,CAAC,CAAA,MAIlC,EAAE,AACzBvK,GAASmJ,GAAqBe,EAAtB,AAA0BK,CAAD,aAAL,GAAuB,CAAEpK,IAGnD+J,EAAInB,CAAD,UAHiE,CAAC,CAAA,EAGlD,EAAE,CACnBA,KAAoBC,KACtBD,GAAkBpI,EADD,CACOoI,EAAD,CAAgB,CAAC,CAG1C/I,AAH0C,GAGjC+I,CAHQ,EAGSmB,CAJqB,CAIvC,AAAsBnB,CAAD,AAJoB,SAIzB,KAAqB,CAAE5I,KAG7C+J,EAAIkB,CAAD,SAH2D,CAAC,CAAA,OAGxC,EAAE,CACvBrC,KAAoBC,IACtBD,IAAkBpI,EADD,CACOoI,EAAD,CAAgB,CAAC,CAAA,AAG1C/I,GAAS+I,AAHQ,GAGSmB,CAJqB,CAIvC,AAAsBkB,CAAD,AAJoB,SAIzB,SAAyB,CAAEjL,KAIjDyI,IACF3B,GAAY,CAAC,IALuD,AAItD,CAJuD,CAAA,AAIrD,CACI,CAAC,CAAG,EAAA,CAAI,CAAA,AAI1BoB,IACFrI,GAASiH,GAAc,CAAC,CAAhB,EADQ,EAAE,CACY,CAAE,CAAX,KAAiB,CAAE,MAAM,CAAC,CAAC,CAAA,AAI9CA,GAAaoE,KAAK,EAAE,CACtBrL,CADc,EACLiH,GAAc,CAAC,CAAhB,MAAuB,CAAV,AAAW,CAAC,CAAA,AACjC,OAAOY,GAAYyD,KAAK,CAAA,CAGtBpB,CAHgB,CAGZqB,CAAD,mBAAqB,CAAE,CAC5B,GAAmD,UAAU,EAAzD,AAA2D,OAApDrB,EAAIqB,CAAD,mBAAqB,CAAC7H,UAAU,CAC5C,MAAM8H,GACJ,YADmB,iEAC0D,CAC9E,CAAA,AAGH,GAAwD,UAAU,EAA9D,AAAgE,OAAzDtB,EAAIqB,CAAD,mBAAqB,CAAC5H,eAAe,CACjD,MAAM6H,GACJ,YADmB,sEAC+D,CACnF,CAAA,AAOHC,EAAYjF,CAHZA,EAAqB0D,EAAIqB,CAAD,CAGf,WAAqB,CAHZ,MAAOA,AAAoB,CAAA,CAGd7H,UAAU,CAAC,EAAE,CAAC,AAC/C,CAD+C,AAC9C,MAAM,IAEsBgB,IAAvB8B,IACFA,CADkC,CACbvD,CADe,EAElCC,EACAkC,EAAa,CACd,CAAA,AAIwB,GARL,CAQS,EANf,CAMZoB,AAPgB,GAOoC,MAPR,EAOgB,EAA7B,AAA+B,KAA5C,EAAoBiF,IACxCA,EAAYjF,EAAmB9C,CADkB,IACxC,KAAgC,CAAC,GAAE,CAAC,CAAf,AAAe,AAM7CzG,GACFA,EAAOiN,CADC,EAAE,AACA,AAGZL,CAHQ,AAAK,CAAA,CAGJK,GACV,AADa,AAAN,CACP,AAKKwB,AANQ,GAMO1L,GAAS,CAAA,CAAE,CAAE,CAChC,CAD2B,CAAX,CACbmH,KAAQ,CACRA,CAAH,KACGA,GACJ,CAFmB,AAElB,CAAA,AACIwE,CAFJ,EAEsB3L,GAAS,CAAA,CAAE,AAFZ,CAEc,CACnC,CAD8B,EAC3BmH,EADgB,IAEhBA,EADW,CAEf,CADC,AACA,CAAA,AAQIyE,GAAuB,QATH,CASpBA,AAAiCtL,CAAgB,EAAA,AACrD,IAAIuL,CADoB,CACX3F,EAAc5F,EAAjB,AAIN,CAACuL,GAAWA,CAJkB,CAAC,AAIZC,CAJY,AAIxB,AALaF,EACE,CAIJ,CAAP,EAAe,EAAE,CAC9BC,EAAS,CACPE,GADI,SACQ,CAAEzC,GACdwC,MADuB,CAChB,CAAE,UAAA,EACV,CAAA,AAGH,IAAMA,EAAUpN,EAAkB4B,EAAQwL,CAA7B,IAA4B,EAAQ,CAAC,CAAA,AAC5CE,EAAgBtN,EADW,AACOmN,EAAOC,IAAD,GAAQ,AAAnC,CAAoC,CAAA,IAAhB,EAEvC,CAAI,CAACrC,EAAkB,CAACnJ,EAAQyL,KAAD,OAAa,CAAC,EAAE,CAI3CzL,EAAQyL,KAAD,OAAa,GAAK1C,GAI3B,AAAIwC,EAAOE,IAAD,IAJ8B,EAAE,EAInB,GAAKxC,GACnBuC,AAAY,KAAK,CAAA,CAAV,GAMZD,CAPsC,CAO/BE,CAPiC,GAOlC,QAAa,GAAK3C,GAEZ,KAAK,GAAjB0C,CAAiB,GACE,CAHqB,EAAE,AAEnC,aAC4B,GAAlCE,GACCnB,EAA8B,CAACmB,EAAa,AAAC,CAAC,CAAA,CAM7CC,CAAQP,CAPG,CAOS,CAACI,EAAQ,CAAtB,AAAuB,AAGnCxL,CAHmC,CAG3ByL,EAHyB,GAG1B,OAAa,GAAK3C,GAI3B,AAAIyC,EAAOE,IAAD,OAJiC,CAIpB,CAJsB,EAIjBxC,GACP,MAAM,CAAA,EAAlBuC,EADiC,AAMtCD,EANwC,AAMjCE,GALK,CAKN,QAAa,GAAK1C,GACP,MAAM,GAAlByC,CADgC,EAAE,AACZpC,EAAuB,CAACsC,CAAvC,CAAqD,CAAA,CAK9DC,CAAQN,EAAe,CAACG,EAAQ,CAAzB,AAA0B,AAGtCxL,CAHsC,CAG9ByL,AAR0D,EAK9B,GAG7B,OAAa,GAAKxC,GAI3B,CACEsC,EAAOE,IAAD,IALiC,EAAE,EAKtB,GAAK1C,KACxB,CAACK,EAAuB,CAACsC,EAAa,AAAC,EACvC,AAFqC,EAOrCH,EAAOE,IAAD,QAAa,GAAK3C,KACxB,CAACyB,EAA8B,CAACmB,EAAa,AAAC,EAC9C,CAOA,CAACL,CATuC,CASxB,CAACG,EAAQ,GACxBI,CADwB,CAAD,AACK,CAACJ,EAAQ,EAAI,CAACJ,EAAN,AAAkB,CAACI,EAAQ,AAAD,CAAE,CAAA,AAMnEnC,AAAsB,iBAAL,MAA4B,SAC7CF,EAAkB,CAACnJ,EAAQyL,KAAD,OAAa,CAAC,EACxC,AASH,CAOKI,AAPL,GAOoB,SAAfA,AAAyBC,AAAb,CAAuB,EAAA,AACvC7N,EAAUoG,EAAUI,KADJoH,AACP,EAAU,AAAQ,CAAE,CAAE7L,OAAO,CAAE8L,CAAM,CAAA,CAAC,CAAA,AAE/C,AAFwCA,GAEpC,CAEFlG,EAAckG,GAAMC,CAAF,CAAC,MAAN,GAAkB,CAACD,GACjC,AAAC,CADoC,CAAC,CAAA,GAC9BvI,CAAC,CAAE,CACVkC,EAAOqG,EACT,CAAA,CADQ,AAAK,AAEd,CAFe,AAEf,AAQKE,CAVU,EAUS,SAAUC,AAA7BD,CAAyC,CAAEhM,CAAgB,CAA3C,CAA2C,AAC/D,GAAI,CACF/B,EAAUoG,EAAUI,GAFFuH,EAET,EAAU,AAAQ,CAAE,CAC3BlK,SAAS,CAAE9B,EAAQkM,KAAD,WAAiB,CAACD,GACpCE,CADwC,CAAC,EACrC,CAAEnM,CACP,CAAA,CAAC,CAAA,AACH,AAAC,GAFQA,GAEDuD,CAAC,CAAE,CACVtF,EAAUoG,EAAUI,KAAX,EAAU,AAAQ,CAAE,CAC3B3C,SAAS,CAAE,IAAI,CACfqK,IAAI,CAAEnM,CACP,CAAA,CAAC,AACJ,CADI,AACJ,AAKA,GAPUA,AAIVA,EAAQoM,KAAD,UAAgB,CAACH,GAGX,CAHe,CAAC,CAAA,CAGZ,EAAE,CAAfA,EACF,EADM,CACF7B,IAAclC,GAChB,GADY,AACR,CACF2D,GAAa7L,EACf,CAAC,AAAC,IADoB,CAAC,CAFY,AAErB,AAAS,AACduD,CAAC,CAH2B,AAGzB,CAAA,CAAC,KAEb,GAAI,CACFvD,EAAQqM,KAAD,OAAa,CAACJ,EAAM,EAAF,AAAI,CAAC,AAChC,CADgC,AAC/B,AAAC,MAAO1I,CAAC,CAAE,CAAA,CAAC,CAGlB,CAAA,AAQK+I,GAAgB,SAAhBA,AAA0BC,CAAb,AAA0B,EAAA,AAE3C,IAAIC,EAAM,CAAH,GAFUF,AAEH,CAAA,AACVG,EAAoB,IAAI,CAAA,AAE5B,GAAIxE,GACFsE,EAAQ,EAHW,CAGd,EADO,EAAE,YACa,CAAGA,KAAK,CAAA,AAC9B,CAEL,IAAMG,EAAUjO,EAAY8N,EAAO,CAAtB,EAAoB,IAAN,MAAqB,CAAC,CAAA,AACjDE,EAAoBC,GAAWA,CAAO,CAAC,CAAC,CAAC,AAAd,AAC7B,CAAA,AAGwB,AAJmB,OAAxB,gBAI4B,GAA7CrD,IACAL,KAAcC,IAAL,CAGTsD,EACE,CALe,EAIZ,IAHuB,EAC5B,uDAGkE,CAChEA,EACA,GADK,aACL,CAAgB,CAAA,AAGpB,IAAMI,EAAezG,EACjBA,EAAmB9C,MADL,IACe,CAACmJ,GADK,AAEnCA,EAKJ,AANsB,AAAiB,CAAC,EAMpCvD,AALK,CAAA,IAKSC,GAChB,CADW,EACP,CACFuD,EAAM,CAAH,GAAOnH,CAFkB,EAAE,CAERuH,KAAH,EAAE,QAAgB,CAACD,EAActD,GACtD,CAAC,AAAC,MADkD,AAC3C9F,CAAC,CAAE,CAAA,CAAC,AAIf,GALyE,AAKrE,CALsE,AAKrEiJ,CALqE,EAKlE,AAAI,CAACA,EAAIK,CAAD,cAAgB,CAAE,CAChCL,EAAMrG,CAAH,CAAkB2G,YAAD,EAAe,CAAC9D,GAAW,MAAF,IAAY,CAAE,IAAI,CAAC,CAAA,AAChE,GAAI,CACFwD,EAAIK,CAAD,cAAgB,CAACE,SAAS,CAAG7D,GAC5BiC,EACAwB,EACL,AAAC,KAFa,CAENpJ,CAHuC,AAGtC,CAAE,CACV,CAAA,AAFgB,AAIpB,CAAA,AAEA,AANoB,IAMdyJ,EAAOR,EAAH,AAAOQ,CAAD,GAAK,EAAIR,EAAIK,CAAD,cAAgB,CAAA,MAU5C,CARIN,GAASE,EAAJ,CACPO,EAAKC,EAAD,UADwB,AACX,CACf5K,CAF4B,CAEnB6K,MAAD,QAAe,CAACT,GACxBO,EAAKG,EAAD,QAAW,CAAC,CADyB,AACxB,CADyB,AACxB,EAAI,IAAI,CAC3B,CAAA,AAICnE,KAAcC,IAAL,AACJ3C,EAAqB8G,IAAI,CAC9BZ,EACAzE,CADG,AAFyB,EAGX,AAHa,MAGP,CAAG,CAFD,GAEX,EAAkB,CACjC,CAAC,CAAC,CAAC,CAAA,AAGCA,GAAiByE,EAAIK,CAAD,QAAN,MAAsB,CAAGG,EAC/C,CAAA,AAQKK,CAT8C,CAAA,CASxB,SAAtBA,AAAgC/I,CAAU,EAAA,AAC9C,IADuB,GAChB8B,EAAmBgH,IAAI,CAC5B9I,EAFqB+I,AAEhBpH,EAAD,OADmB,IACL,EAAI3B,EACtBA,EAEAW,AAH0B,EACtB,AAEOqI,EADX,MACU,IAAa,CACrBrI,EAAWsI,QAAD,IAAa,CACvBtI,EAAWuI,QAAD,CAAU,CAHtB,AAIEvI,EAAWwI,QAAD,mBAA4B,CACtCxI,EAAWyI,QAAD,UAAmB,CAC/B,IAAI,CACL,CAAA,AACF,CAAA,AAQKC,GAAe,SAAH,AAAZA,AAAyB3N,CAAgB,EAAA,AAC7C,OACEA,EAFc2N,KAEP,MAAYvI,IACU,QAAQ,EAApC,CADiC,IAAA,EAC1BpF,EAAQ4N,KAAD,GAAS,EACS,QAAQ,EAAvC,OAAO5N,EAAQ6N,KAAD,MAAY,EACK,UAAU,EAAzC,OAAO7N,EAAQ+L,KAAD,MAAY,EAC1B,CAAA,CAAE/L,EAAQ8N,KAAD,KAAW,YAAY5I,CAAAA,CAAY,CAAC,CACV,UAAU,EAA7C,OAAOlF,EAAQoM,KAAD,UAAgB,EACE,UAAU,EAA1C,OAAOpM,EAAQqM,KAAD,OAAa,EACK,QAAQ,EAAxC,OAAOrM,EAAQyL,KAAD,OAAa,EAC3B,AAAgC,UAAU,SAAnCzL,EAAQiN,KAAD,OAAa,EACM,YAAjC,OAAOjN,EAAQ+N,KAAD,QAAmB,AAAL,CAAe,CAAC,AAEjD,CAFiD,AAEjD,AAQKC,GAAU,IAAH,KAAPA,AAAoBxN,CAAc,EACtC,AADsC,IAA3BwN,EACY,UAAU,EAA1B,OAAOhJ,GAAuBxE,CAAnB,IAAwB,QAAYwE,EACvD,CAAA,AAED,CAH4D,CAAA,OAGnDiJ,GACPzH,CAAqB,CACrB0H,CAA6B,CAC7BC,CAAsB,EAAA,AAEtB1Q,EAAa+I,CALOyH,CAKF,AAAGG,GAAH,CAAU,AAC1BA,EAAKhB,EADK,AAAoB,AAC1B,EAAK,CAAC/I,EAAW6J,EAAaC,EAAM5E,EAAF,CAAnB,AACrB,CAAC,CAAC,AACJ,CAFkD,AAC9C,AACJ,AAWA,CAbmD,AAAf,CAAe,EAa7C8E,GAAoB,SAApBA,AAA8BH,CAAgB,EAAA,AAClD,EADqB,EACjBlI,EAAU,IAAI,CAAP,AAAO,AAMlB,GAPqBqI,AAIrBJ,GAAczH,EAAM1C,GAAD,KAAN,cAA6B,CAAEoK,EAAa,IAAI,CAAC,CAAA,AAG1DP,GAHmD,AAGtCO,GAEf,MAFc,CACdrC,CAD0B,CAAC,CACdqC,CADgB,GAEtB,EAIT,EAJa,CADC,AACD,CAIP1C,CALoB,CAKV3L,AALW,CAAA,EAKOqO,EAArB,AAAiCN,QAAQ,CAAT,AAAU,CAAA,AASvD,EATiC,CAGjCK,GAAczH,EAAMvC,GAAD,KAAN,WAA0B,CAAEiK,EAAa,SAAF,AAClD1C,EACA8C,KADO,MACI,CAAE3H,EACd,CAAA,CAAC,CAAA,AAIAmB,IACAoG,EAAYH,CANCpH,KAKD,GACD,IAAc,EAAE,EAC3B,CAACqH,GAAQE,EAAYK,EAAb,OAAY,QAAkB,CAAC,EACvCC,EAAW,QAAD,EAAW,CAAEN,EAAYnB,SAAD,AAAU,CAAC,EAC7CyB,EAAW,QAAD,EAAW,CAAEN,EAAYL,SAAD,EAAY,CAAC,EAC/C,AAjhCJ1L,IAuhCM+L,EAAYxJ,QAAQ,CAAT,CAOboD,GAP2BjG,CAthCtB,CAAC,GA8hCNqM,EAAYxJ,EARwB,AAOxB,CAPyBvC,KAQjB,CAAT,CACXqM,EAAW,CADc3M,OACf,CAAU,CADc,AACZqM,CADa9L,CACD+L,CATyB,EAAE,CASvB,CAAC,CADG,AAZ1C,CAcA,EADiC,IAdjCtC,GAAaqC,IACN,EAoBT,EApBa,CAAA,AADC,AAsBZ,CAAA,CACEzG,AAvBsB,CAAC,CAAA,CAuBAkD,QAAQ,WAAT,CAAqBjB,QAAQ,EACnDjC,GAAuBkD,QAAQ,CAACa,EAAO,CAAC,CACzC,EACA,CAAC7E,CADD,CACa,CAFU,AAET6E,EAAQ,EAAIjE,EAAW,CAAhB,AAAiBiE,EAAQ,AAAD,CAAE,CAChD,CAEA,GAAI,CAACjE,EAAW,CAACiE,EAAQ,EAAIiD,GAAL,AAA2BjD,KAE/CvE,EAFsD,CAAC,AAE/BC,EAFiC,QAAX,EAEV,QAAb,IAAyBhI,MAAM,EACtDsP,EAAWvH,GAAwBC,KAAzB,OAAqC,CAAEsE,IAMjDvE,GANwD,AAMhCC,AANU,CAAuB,EACzD,SAKoC,QAAb,IAAyBwC,QAAQ,EACxDzC,GAAwBC,YAAY,CAACsE,IALrC,GAKuB,AAAqB,CAAC,EAC7C,CANO,EAYX,GAZgB,AAYZlD,CAZY,GAYI,CAACG,EAAe,CAAC+C,EAAQ,CAAE,CAC7C,AADc,GAA4B,CACpCkD,EAAa9I,EAAcsI,IAAgBA,EAAjC,AAA6CQ,KAA7B,AAAY,CAAC,GAAe,CAAW,CAAA,AACjEvB,EAAaxH,EAAcuI,IAAgBA,EAAjC,AAA6Cf,KAA7B,AAAY,CAAC,GAAe,CAAW,CAEvE,AAFuE,GAEnEA,GAAcuB,EAAY,CAC5B,IAAMC,AADM,EACOxB,CADO,CACIlQ,MAAd,AAAoB,CAAA,AAEpC,CAF6B,GAExB,IAAI2R,CAAC,CAAGD,EAAa,CAAC,CAAEC,CAAC,EAAI,CAAC,CAAE,CAAd,CAAgBA,CAAC,CAAE,CACxC,IAAMC,EAAatJ,EAAU4H,CAAU,CAACyB,CAAC,CAAC,EAAE,AAA5B,CAAY,EAC5BC,CADgD,CAAC,AACtCC,CADsC,OACvC,MAAe,CAAG,CAACZ,EAAYY,SAAD,KAAe,GAAI,CAAC,CAAI,CAAC,CAAA,AACjEJ,EAAWzB,QAAD,IAAa,CAAC4B,EAAYnJ,EAAewI,GACrD,CAAA,AACF,CAAA,AACF,CAHwC,AAGxC,AAGA,KANoE,CAAZ,AAAa,CAAC,AAKtErC,CALsE,EAKzDqC,IACN,CACT,CAAA,EADa,CADC,AACD,EADa,CAAC,CAKvBA,AAAJ,AAL2B,WAKZ,EAAYvJ,GAAW,CAAC2G,GAAL,AAA0B4C,IAO1D,CAAC1C,AAAY,MAPwD,CAAC,AAO9D,EAPgE,CAOjD,EAPkC,IAQ3C,SAAS,GAArBA,GACY,IADL,SACPA,CAAY,CAAU,EACxBgD,EAAW,CADF,OACC,qBAA8B,CAAEN,EAAYnB,SAAD,AAAU,CAAC,EAChE,AAVAlB,GAAaqC,IACN,IAAI,AAeTrG,CAfS,AADC,EAAY,CAAC,AAzlCvB,CAylCuB,GAgBDqG,EAAYxJ,QAAhB,AAAwB,CAAT,EAEnCsB,EAAUkI,AAFuCrM,EAE3BgM,GAAf,IAFmD,CAAC9L,CAEtC,EAAY,CAF8B,AAE9B,AAEjCtE,EAJiE,AAIpD,CAAC2D,EAAeC,EAAUC,EAAY,CAAA,AAAGyN,EAA1C,CAAyB,CACnC/I,AADgE,EACtDtH,AADe,EACDsH,AADwB,AAAoB,EACnC+I,CAA1B,CAAgC,EAAF,CAAN,AAAW,CAAC,AAC7C,CAD6C,AAC5C,CAAC,CAAA,AADuB,AAGrBb,EAAYL,SAAD,EAAY,GAAK7H,IAC9B/H,EAAUoG,CAD2B,CACjBI,CADmB,IAC9B,EAAU,AAAQ,CAAE,CAAEzE,OAAO,CAAEkO,EAAY3I,SAAD,AAAU,EAAE,CAAE,CAAC,CAAA,AAClE2I,EAAYL,SAAD,EAAY,CAAG7H,IAK9BiI,GALqC,AAKvBzH,CALuB,CAKjBwI,GAAD,KAAN,aAA4B,CAAEd,EAAa,IAAI,CAAC,CAAA,CAEtD,EAF+C,CAGvD,CAAA,AAWKe,CAZQ,CAAA,CAYY,SAApBA,AACJC,CAAa,CACbC,CAAc,CACd3O,CAHqB,AAGR,EAAA,AAGb,GACE6J,KACY,EARO4E,EAQH,GADJ,AACXE,GAA8B,CADnB,EACL,MAAaA,CAAW,CAAM,CAAC,EACrC3O,CADyB,CAAY,GAC5B6B,AAAJ,GAAgB7B,KAAJ,AAAS,AAAI4O,EAAAA,CAAW,CAAC,AAE3C,EADA,KACO,EAOT,GAPc,AAQZjF,CARY,GASZ,CAAC3C,EAAW,CAAC2H,EAAO,EACpBX,EADmB,AACRjN,CAFI,CAEO4N,MAAM,AAAlB,CAAmB,AAAT,EACpB,AAEK,CAAN,EAAUzH,IAAmB8G,EAAWhN,EAAW2N,MAAZ,AAAkB,CAAR,AAAS,AAAjC,EAAmC,AAGtD,CAAN,EACC1H,GAAuBoD,cAAc,KAAf,OAA2BnB,QAAQ,EACzDjC,GAAuBoD,cAAc,CAACsE,EAAQD,EAAxB,EAAsB,CAAO,CAAC,EACpD,CAGD,AAAM,GAAI,CAACpI,EAAY,CAACqI,EAAO,EAAI3H,EAAW,AAAhB,CAAiB2H,EAAO,EAAE,AACvD,EADoD,EAElD,CAGCV,GAAsBS,KAAK,AACxBjI,CADyB,EACDC,EADC,QAAP,EACkB,QAAb,IAAyBhI,MAAM,EACtDsP,EAAWvH,GAAwBC,KAAzB,OAAqC,CAAEgI,IAChDjI,CADqD,CAAC,CAC9BC,AADS,YACG,QAAb,IAAyBwC,KANrD,GAM6D,EACvDzC,GAAwBC,YAAY,CAACgI,EAAK,CAAE,CAAC,CAC/CjI,EADyB,CAAsB,CACvBK,kBAAkB,CAAnB,WAA+BpI,MAAM,EAC5DsP,EAAWvH,GAAwBK,KAAzB,aAA2C,CAAE6H,CAArB,GACjClI,EAD4D,CAAC,AACrCK,kBAAkB,EAAnB,UAA+BoC,QAAQ,EAC7DzC,GAAwBK,kBAAkB,CAAC6H,CAApB,CAA4BD,EAAK,CAAE,CAAT,AAAU,CAGhEC,AAAW,GAFZ,CAEgB,EAAT,IACLlI,GAAwBuD,oBAAD,UAA+B,GACpDvD,CADoD,EAC5BC,YAAY,QAAb,IAAyBhI,AAJpD,MAI0D,EACtDsP,EAAWvH,GAAwBC,KAAzB,OAAqC,CAAE1G,IAChDyG,CADqD,CAAC,CAArB,AACTC,YAAY,QAAb,IAAyBwC,QAAQ,EACvDzC,GAAwBC,YAAY,CAAC1G,EAAK,CAAE,CAAE,CAKpD,CAJA,CAGD,AAJ8B,KAKtB,CACT,CAAA,GADc,CAAA,CAGT,GAAIqI,EAAmB,CAACsG,EAAO,EAAE,CAIvC,CAJoC,GAI9B,GACLX,EAAW/M,EAAgB/C,EAAc8B,EAAO6O,EAAiB,AAAvD,CAAoC,CAAqB,CAAC,CAAC,EACrE,CAID,AALyC,CAAf,GAKpB,EAL0D,CAM/D,CAAY,KAAK,GAAhBF,GAA+B,GAAzB,SAAqC,GAAvBA,GAAsC,GAAhC,MAAqBA,CAAW,CAAM,EACvD,EAD4C,MACpC,GAAlBD,GACkC,CAAC,CAD9B,EACLtQ,EAAc4B,EAAO,GAAF,IAAS,CAAC,CAAhB,CACbmI,EAAa,CAACuG,EAAM,EACpB,CAKD,AANoB,IAMd,GACLvH,IACA,CAAC6G,EAAW9M,EAAmBhD,EAAc8B,EAAO6O,EAAiB,AAA1D,CAAuC,CAAqB,CAAC,CAAC,EACzE,CAGD,AAJ6C,CADrB,CACM,EAIxB,EAJ8D,CAI1D7O,EACT,GADc,EAAE,EACT,EAMT,GANc,CAAA,GAMP,EACR,CAAA,AAUKiO,CAXO,CAAA,CAWiB,SAAxBA,AAAkCjD,CAAe,EACrD,AADqD,MAA5B,AAClBA,AAAY,OAAL,KADWiD,IACU,MAAIhQ,EAAY+M,EAAS5J,GAC7D,CAAA,AAYK0N,CAbsD,EAAR,AAaxB,OAbgD,CAAC,CAAA,AAavEA,AAAgCpB,CAAoB,EAAA,AAExDD,GAAczH,CAFS,CAEH3C,GAAD,KAAN,GAFUyL,aAEqB,CAAEpB,EAAa,IAAI,CAAC,CAAA,AAEhE,GAAM,AAFmD,YAEjDJ,CAAAA,CAAY,CAAGI,EAGvB,GAAI,CAACJ,GAAcH,EAHe,CAAA,AAGFO,GAC9B,CADa,KAAgB,CAI/B,AAHE,CADyC,CAAC,EAAE,AAIxCqB,EAAY,CAChBC,MADa,EACL,CAAE,EAAE,CACZC,SAAS,CAAE,EAAE,CACbC,QAAQ,EAAE,EACVC,EADc,eACG,CAAE7I,GACnB8I,SAD+B,IAClB,CAAExL,OAChB,CAAA,AACGrE,CAFaqE,AAEZ,CAAG0J,EAAW7Q,MAAM,CAAA,AAGzB,CAHkB,IAGX8C,CAAC,EAAE,EAAE,CAEV,GAAM,MAAEkM,CAAI,cAAER,CAAY,CAAEjL,KAAK,CAAEiP,CAAAA,CAAW,CADjC3B,CAAU,CAC0B+B,AADzB9P,CAAC,CAAC,CAAA,AAEpBoP,CAD+C,CAAA,AACtCtP,GAAkBoM,CAArB,EAGRzL,CAHiC,CAAC,AAGjB,CAHiB,EAG7B,IAAmB,EAHI,CAGpByL,AAAmB6D,IAAYjR,AAA3B,EADE4Q,GAuBlB,AAtBwC,GAGxCF,EAAUC,AAH2C,CAACM,AAD3B,CAAA,KAIlB,CAAS,CAAGX,CAH0C,CAAC,AAIhEI,CAJgE,CAItDE,EADiB,CAAA,IAClB,EAAU,CAAGjP,EACtB+O,EAAUG,CADiB,CAAA,KAClB,CAAS,CAAG,GACrBH,CADyB,CACfK,AADe,OAChB,MAAc,MAAGxL,EAC1B6J,GAAczH,EAAMxC,EADe,CAAC,AACjB,CADiB,IACvB,aAA4B,CAAEkK,EAAaqB,GACxD/O,EAAQ+O,EAAUE,CAAb,CADiD,AAAW,CAAC,CAAA,GACjD,EAAU,CAAA,AAKvBrH,KAAoC,IAAI,GAAf+G,GAA8B,GAAxB,EAAX,EAPY,EAOYA,AAAxB,CAAmC,CAAM,CAAC,EAAE,AAElEnD,CAFoD,EAEnCC,EAAMiC,EAAF,CAGrB1N,EAAQ6H,AA/+BsB,GA++BzB,GAH6B,AAAlB,CAAmB,CAAA,OA5+BU,CA++BP7H,AA/+BO,GAo/B7CsH,EAL2C,CAAA,CAM3C0G,EAAW,EANwB,IAKvB,EACF,gCAAyC,CAAEhO,IAOxC,CAP6C,CAAC,aAO/B,GAA1B2O,GAA8B1Q,EAAY+B,CAApC,CAA2C,GAAF,GAAQ,CAAd,AAAe,CAN1D,CAM4D,AAL5DwL,GAAiBC,EAAMiC,EAAF,CACrB,QADkC,AAAlB,AAElB,CAFqC,AACnC,AACF,AASA,CAXqC,EAWjCqB,EAAUK,OAAD,MAAc,CACzB,CAD2B,QAC3B,AAIF,GAAI,CAACL,EAAUG,OAAD,CAAS,EAMnB,CAAC9H,IAA4B4G,EAAW,MAAM,CAAEhO,CAAT,EANlB,CACvBwL,CAKuD,CAAC,CALvCC,CAKyC,CALnCiC,EAAF,AAKM,CAJ3B,QADgB,AAAkB,AAEpC,CAAA,AAFqC,AACnC,AAUErG,CAXiC,GAYnCpK,EAAa,CAAC2D,EAAeC,EAAUC,EAAY,CAAA,AAAGyN,EAA1C,CAAyB,CAA6B,AAChEvO,AAFkB,EAAE,AACK,AACjB9B,EADwC,AAAoB,AAC9C8B,CAAjB,CAAwBuO,EAAM,CAAR,CAAM,CAAK,CAAC,AACzC,CAAC,AADwC,CACvC,CAAA,AAIJ,AALyB,IAKnBG,EAAQrP,GAAH,AAAqBqO,EAAYN,QAAQ,CAAT,AAAU,CAAA,AACrD,EAD+B,CAC3B,CAACqB,GAAkBC,EAAOC,EAAQ3O,CAAV,EAAkB,CAC5CwL,AADkC,CAAO,CAAC,CACzBC,EAAMiC,CADH,CACC,CACrB,QADgB,AAAkB,AAEpC,CAGA,AALqC,AACnC,AACF,CAFqC,EAMnChI,GACwB,QAAQ,EAAhC,KADkB,EACXtD,GACkC,SADtB,CACgC,EAAnD,AACA,OADOA,EAAamN,UAAD,MAAiB,CAEpC,GAAItE,QAGF,IAHc,EAAE,CAEjB,AACS7I,EAAamN,UAAD,MAAiB,CAACb,EAAOC,GAAF,CACzC,EADiD,CAAC,CAC7C,aAAa,CAChB3O,EAAQ0F,EAAmB9C,CAAtB,SAAgC,CAAC5C,GACtC,EAD0B,AAAiB,CAAC,CAAA,CAI9C,CAHE,IAGG,kBAAkB,CACrBA,EAAQ0F,EAAmB7C,CAAtB,cAAqC,CAAhB,AAAiB7C,EAO/C,CAAA,AAKJ,EAZwD,CAAC,AAYrDA,CAZqD,IAYhD,CACP,GAAI,CADQsP,AAENrE,EACFyC,EAAY8B,KAHK,EAAE,CAEL,CACH,CADK,IACU,CAACvE,EAAcQ,EAAMzL,EAAF,CAG7C0N,EAHoD,AAGxC7B,CAHyC,CAAA,CAAd,MAG5B,GAAa,CAACJ,EAAMzL,EAAF,CAG3BmN,EAHkC,CAAC,AAGtBO,CAHsB,EAIrCrC,GAAaqC,GAEbnQ,AAHc,EAGLsG,AAHiB,CAAC,CAGRI,CAHU,CACjB,EAAY,AAEhB,CAFiB,CAAA,CAEP,AAAQ,CAAC,CAAA,AAE9B,AAAC,MAAOlB,CAAC,CAAE,CACVyI,GAAiBC,EAAMiC,EACzB,AADuB,CACvB,AAEJ,CAAA,AAGAD,GAAczH,EAAM7C,EANE,AAAkB,CAMrB,AANsB,CAAA,IAM5B,eAA8B,CAAEuK,EAAa,IAAI,CAAC,CAAA,AAChE,CAAA,AAOK+B,EARoD,CAQ/B,SAArBA,EAA+BC,CAA0B,EAAA,AAC7D,CADsB,GAClBC,EAAa,IAAI,CACfC,AADe,EACE/C,AAFD4C,CACR,EAC6BC,GAK3C,IAFAjC,CAHmD,CAA/B,AAAgC,CAAA,AAGtCzH,EAAMzC,GAAD,CAHuB,IAG7B,eAA8B,CAAEmM,EAAU,IAAI,CAAC,CAAP,AAAO,AAEpDC,EAAaC,EAAeC,MAAlB,EAA0B,EAAE,CAAG,CAAd,AAEjCpC,GAAczH,EAAMtC,GAAD,KAAN,cAA6B,CAAEiM,EAAY,IAAI,CAAC,CAAA,AAG7D9B,EAHsD,CAGpC8B,GAGlBb,GAAoBa,GAGhBA,CANwB,CAAC,AAMdnK,CANc,EAAZ,EAGa,CAAC,CAAA,AAGT,CAAR,GAHK,QAGejB,GAChCkL,EAAmBE,EAAWnK,OAAO,CAAC,AAAT,CAAS,AAK1CiI,AANoD,EAAE,CAMxCzH,EAAM5C,AALE,GAKH,KAAN,cAA6B,CAAEsM,EAAU,IAAI,CAAC,CAAP,AAAO,AAC5D,CAAA,AAwOD,OArOA7L,EAAUiM,OAAD,CAAS,CAAG,SAAU/D,CAAK,EAAU,IAAR3C,EAAG5M,CAAA,QAAA,CAAAC,MAAA,CAAA,CAAA,EAAAD,KAAAoH,SAAA,IAAA,CAAA,CAAA,CAAA,CAAApH,SAAA,CAAA,CAAA,CAAA,CAAG,CAAA,CAAE,CAAA,AACxCgQ,EAAO,EAAH,EAAO,CACXuD,AADW,EACI,IAAI,CAAA,AACnBrC,EAAc,GADF,CACM,CAAA,AAClBsC,EAAa,EADF,EACM,CAAA,AAUrB,GALItH,AALU,CAIdA,GAAiB,CAACqD,CAAAA,CAAK,CAAA,EAErBA,EAAQ,EADQ,CADJ,AAEP,CADa,GACV,CAAO,CAII,AAJJ,QAIY,EAAzB,OAAOA,GAAsB,CAACyB,CAAlB,EAA0BzB,GACxC,CADuC,CAAM,CAAC,AAChB,EADkB,QACR,EAApC,AAAsC,OAA/BA,EAAM/N,GAAD,KAAS,CAEvB,IAAI,AAAiB,OAAV+N,CAAkB,EAAE,EAAf,KADhBA,EAAQA,EAAM/N,CAAT,EAAQ,KAAS,EAAA,CAAE,CAAA,AAEtB,MAAM0M,GAAgB,YAAD,qBAAkC,CAAC,AAC1D,CAD0D,AAC1D,KAEA,MAAMA,GAAgB,YAAD,gBAA6B,CAAC,CAAA,AAKvD,GAAI,CAAC7G,EAAUO,OAAD,IAAY,CACxB,CAD0B,MACnB2H,EAgBT,GAZI,AAACvE,AAJS,CAAA,GAKZ2B,GAAaC,GADA,AACG,AAIlBvF,CAJmB,CADF,AACE,AAITI,IAJI,GAIL,AAAQ,CAAG,EAAE,CAAA,AAGD,QAAQ,EAAzB,AAA2B,OAApB8H,IACThE,CADc,GACH,CAAA,CAAK,CAAA,AAGdA,CAHM,GAKR,GAAKgE,CAFK,CAEUqB,CAFR,EAEO,KAAS,CAAE,CAC5B,IAAMpC,EAAU3L,GAAmB0M,EAAeqB,AAArC,GAAoC,KAAS,CAAC,CAAA,AAC3D,EADiC,CAC7B,CAACjH,EAAY,CAAC6E,EAAQ,EAAIjE,EAAW,CAAhB,AAAiBiE,EAAQ,CAChD,CADkD,GAAH,EACzCN,GACJ,YADmB,6CACsC,CAC1D,CAAA,AAEL,CAAA,KACK,GAAIqB,KAAK,QAAYvH,EAx+CrB,CAAC,CAw+CwB,EAM5BuL,AAN8B,CAIhCA,EAAevD,CADfA,EAAOV,CACY,CADf,CAAiB,GAGP,CAFF,MADQ,AAAU,CAAC,CACXrG,AADW,aACE,CAACM,UAAU,CAACgG,GAAO,EAAF,AAAM,CAAC,CAAA,AAE1C7H,QAAQ,EACK,GADA7C,GACM,EAChC,CADA0O,EAAa3C,CADsB,CAAC5N,MACf,CADsB,CAC/B,AAIuB,MAAM,EAAE,CAAlCuQ,EAAa3C,QAAQ,CAC9BZ,CADqB,CACduD,EAAH,AAGJvD,EAAKyD,EAAD,MAHe,CAAA,EAGH,CAACF,OAEd,CAEL,GACE,CAL6B,AAK5BnG,CAL6B,CAAA,EAM9B,CAACvC,IACD,CAACE,AAFU,IAIY,CAAC,CAAC,EACzB,CADAwE,EAAMzC,EAHa,CACJ,AAEV,IADL,AACa,CAAC,GAAG,CAAC,CAElB,OAAO5D,GAAsBiC,GACzBjC,EAAmB9C,UADE,AACQ,CAACmJ,GADc,AAE5CA,EADkB,AAAiB,AAQzC,CAR0C,EAC/B,AAOP,CAPO,AAONS,CAHLA,EAAOV,CAGE,CAHL,CAAiBC,AAGV,EAHe,CAAC,CAAA,AATzB,AAaA,MAJkB,CAIXnC,GAAa,IAAI,CAAGjC,EAAV,CAAgCgD,EAAY,EAAE,AAEnE,CAAA,AAFmE,AAK/D6B,GAAQ/E,CALkD,AAKtD,GACN4D,GAAamB,CANmC,CAM9B0D,CADE,CACH,CADK,IACV,GAAgB,CAAC,CAAA,AAI/B,IAAMC,EAAetD,GAAoB9E,GAAWgE,EAAQS,EAA1C,CAA+B,AAGjD,AAHyD,CAAO,CAAC,CAAA,EAGzDkB,EAAcyC,CAHkB,CAGLN,OAAhB,CAAwB,EAAT,AAAW,CAAG,CAE9ChC,GAAkBH,GAGlBoB,GAAoBpB,GAGhBA,EAAYlI,AANa,CAAC,CAAA,CAAb,GAGc,CAAC,AAGT,CAHS,CAGjB,EAHI,QAGgBjB,GACjCkL,GAAmB/B,EAAYlI,OAAO,CADW,AACV,CAAT,AAAS,AAK3C,CANuD,EAMnDuC,CALkB,EAMpB,KADU,EAAE,AACLgE,EAIT,GAAInC,AAJU,CAAA,EAIE,CACd,GAAIlC,GAGF,AAJU,IAEVsI,EAAanK,EAAuB+G,IAAI,CAACJ,CAA/B,CAAoC/G,CADzB,CACwB,CADtB,UACY,AAAwB,CAAC,CAAA,AAErD+G,EAAK0D,EAAD,QAAW,CAAE,CAEtBF,EAAWC,QAAD,GAAY,CAACzD,EAAK0D,EAAD,QAAW,CAAC,CAAA,KAGzCF,EAAaxD,EAcf,EAdmB,CAAA,GAAP,CAGRlG,GAAa8J,SAAD,CAAW,EAAI9J,GAAa+J,SAAD,KAAe,AAAdA,EAAgB,EAQ1DL,EAAajK,EAAW6G,IAAI,CAACvI,CAAnB,CAAqC2L,CAAxB,EAAoC,EAAI,CAAC,CAAA,AAG3DA,CACT,CAAA,AAEA,CAN6D,GAMzDM,CAN6C,CAM5B/I,EAHF,CAGmBiF,AAHnB,EAGwB+D,EAAD,KAAxB,EAAiB,AAAiB,CAAG/D,EAAKD,EAAD,OAAU,CAsBrE,AAtBqE,OAInEhF,IACApB,EAAY,CAAC,OADC,GACS,CAAC,EACxBqG,EAAK/G,EAAD,WAAc,EAClB+G,EAAK/G,EAAD,WAAc,CAAC+K,OAAO,EAC1BhE,EAAK/G,EAAD,WAAc,CAAC+K,OAAO,CAAC/E,IAAI,EAC/BuC,EAAW9H,GAA0BsG,EAAK/G,EAAD,CAA/B,IAAyB,MAAoB,CAAC+K,OAAO,CAAC/E,IAAI,CAAC,EACrE,CACA6E,EACE,YADY,AACA,CAAG9D,EAAK/G,EAAD,WAAc,CAAC+K,OAAO,CAAC/E,IAAI,CAAG,KAAK,CAAG6E,CAAAA,CAAc,CAAA,AAIvEjJ,IACFpK,EAAa,CAAC2D,EAAeC,EAAUC,EAAY,CAAA,AAAGyN,EAA1C,CAAyB,CAA6B,AAChE+B,AAFkB,EAEDpS,AAFG,AACK,EAA2C,AACrCoS,AADiB,EACD/B,EAAM,EAAF,CAAK,CAC1D,AAD2D,CAAA,AAC1D,CAAC,AADc,CACd,AAD8B,AAI3B7I,GAJ0C,AAIpBiC,GACzBjC,EAAmB9C,UAAU,AADR,CACS0N,GAC9BA,AAF4C,EAGjD,AAFuB,CAEvB,AAEDzM,EAAU4M,MAJwC,CAIzC,AAJ0C,EAIhC,AAHC,CAAA,AAGE,WAAkB,CAAA,GAARrH,EAAG5M,CAAA,QAAA,CAAAC,MAAA,CAAA,CAAA,EAAAD,AAAAoH,SAAA,SAAA,CAAA,CAAA,CAAA,CAAApH,SAAA,CAAA,CAAA,CAAA,CAAG,CAAA,CAAE,CAAA,AACtC2M,GAAaC,GAAG,AAChB5B,CADiB,CAAA,EACJ,EADD,AAEb,CAAA,AAED3D,CAHmB,CAAA,AAGT6M,CAHE,MAGH,IAAY,CAAG,WACtB3H,CADsB,EACb,GAAH,CAAO,CAAA,AACbvB,IAAa,EACd,CAED3D,AAFC,EAES8M,AAHU,CAAR,AAAQ,MAGX,SAAiB,CAAG,SAAUC,CAAG,CAAEvB,CAAI,CAAErP,CAAK,EAAA,AAQrD,OANI,AAAC+I,IACHI,EADS,CACI,CAAA,AADF,CACI,CAAC,CAKXsF,AALW,GAGJpP,EAHA,CAGkBuR,GAAG,AACpBvR,CADqB,CAAA,CACHgQ,GACOrP,CADH,CACb,AADc,CAEvC,AAD0B0O,AADa,CAEvC,AAED7K,CALiC,AAEc,CAGrCgN,AAHsC,CAAA,CAAhB,EAAElC,CADA,EAIzB,AAAQ,CAAG,EAHoB,OAItCmC,CAA0B,CAC1BC,CAA0B,EAEE,AAFF,UAEY,EAAE,AAApC,OAAOA,GAIXtT,EAAUuI,CAAK,CAAC8K,EAAW,CAAEC,EAJN,AAId,CACV,CAAA,AAEDlN,EAAUmN,CAHkB,KAAe,CAAC,AAGnC,CAHmC,EAGxB,CAAG,SACrBF,CAA0B,CAC1BC,CAA0B,EAAA,AAE1B,GAAIA,AAAiBnN,SAAS,EAAE,CAAhB,AACd,IAAMjE,EAAQtC,EAAiB2I,CAApB,AAAyB,CAAC8K,EAAW,CAAEC,GAElD,IAF+C,EAAjB,CAEb,CAAC,CAF4C,AAE3C,CAF4C,CAAA,CAExDpR,KAAK,EACRiE,EACAqN,EAAYjL,CAAK,CAAC8K,EAAW,CAAEnR,AADtB,EAC6B,CAAC,CAA5B,AAA6B,CAAJ,AAAK,CAAC,CAAd,AAAe,AACjD,CADiD,AACjD,AAEA,OAAOpC,EAASyI,CAAK,CAAC8K,EAAW,CAAC,CAAnB,AAAmB,AACnC,CAAA,AAEDjN,EAAUqN,GAHwB,IAGzB,IAAY,CAAG,SAAUJ,CAA0B,EAAA,AAC1D9K,CAAK,CAAC8K,EAAW,CAAG,EAAE,CACvB,AADuB,CAGxBjN,AAFC,EAESsN,CAHQ,MAGT,OAAe,CAAG,WACzBnL,CADyB,CACjB9C,GAAH,EACN,CAAA,AAEMW,CACT,CAAA,GjBzrDA,GAAA,CiBqrD2B,AAGT,CAAA,AjBxrDlB,CAAA,AiBqrD6B,CAAA,AjBrrD7B,QAOA,GAAA,EAAA,CAAA,CAAA,QACA,GAAA,EAAA,CAAA,CAAA,QACA,GAAA,EAAA,CAAA,CAAA,QACA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QAQA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QACA,GAAA,EAAA,CAAA,CAAA,QACA,GAAA,EAAA,CAAA,CAAA,QACA,GAAA,EAAA,CAAA,CAAA,QAWO,SAAS,GAAiB,QAChC,CAAM,cACN,CAAY,UACZ,CAAQ,UACR,CAAQ,YACR,CAAU,MACV,EAAO,OAAO,CACS,EACvB,IAAM,EAAQ,CAAA,EAAA,EAAA,QAAA,AAAQ,IAChB,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACrC,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACrC,CAAC,EAAmB,EAAqB,CAC9C,CAAA,EAAA,EAAA,QAAA,AAAQ,EAA8B,MACjC,EAAiB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAiB,MAGxC,EAAS,CAAA,EAAA,EAAA,QAAA,AAAQ,EACtB,EAAA,GAAG,CAAC,aAAa,CAAC,cAAc,CAChC,EAAW,UAAE,CAAS,EAAI,QAIrB,EAAS,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,OAAO,CAAC,GAAG,CAAE,CAAE,GAAI,CAAS,GAGlD,EAAc,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,EAAA,GAAG,CAAC,cAAc,CAAC,YAAY,CAAE,UAAE,CAAS,GAGnE,EAAiB,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,cAAc,CAAC,iBAAiB,CAAE,UACrE,CACD,GAGM,EAAc,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,KAAK,CAAC,OAAO,CAAE,CAAC,GAG3C,EAAe,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,aAAa,CAAC,GAAG,CAAE,CAAC,GAEhD,EAAe,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,EAAA,GAAG,CAAC,MAAM,CAAC,YAAY,EAClD,EAAkB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,EAAA,GAAG,CAAC,MAAM,CAAC,eAAe,EAGxD,EAAkB,EACrB,GAAa,KAAK,AAAC,GAAM,EAAE,GAAG,GAAK,GACnC,EAGH,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACL,GAAkB,CAAC,GACtB,EAAqB,EAAe,GAAG,CAEzC,EAAG,CAAC,EAAgB,EAAkB,CAHK,CAM3C,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACL,GAAU,EAAO,MAAM,CAAG,GAAG,AAChC,EAAe,OAAO,EAAE,eAAe,CAAE,SAAU,QAAS,EAE9D,EAAG,CAAC,EAAO,EAGX,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACJ,IACJ,EAAW,EADC,EAEZ,EAAa,IACb,EAAqB,MAEvB,EAAG,CAAC,EAAO,EAEX,IAAM,EAAkB,UAEvB,GAAI,CAAC,EAAU,IAAI,GAAI,YACtB,EAAM,KAAK,CAAC,gBAAiB,kCAI9B,IAAM,EAAsB,QAAT,GAAkB,CAAC,GAA4B,IAAlB,EAAO,MAAM,CAE7D,GAAI,GAAc,CAAC,EAAQ,IAAI,GAAI,YAClC,EAAM,KAAK,CAAC,mBAAoB,wCAIjC,GAAI,CAAC,GAAiB,MAAO,YAC5B,EAAM,KAAK,CACV,WACA,sDAKF,GAAa,GACb,GAAI,CACH,GAAI,EAEH,MAAM,EAAgB,CACrB,CAHc,UAId,QAAS,EAAQ,IAAI,GACrB,YAAa,EAAU,IAAI,EAC5B,GACA,EAAM,OAAO,CAAC,aAAc,6CACtB,CAEN,IAAM,EAAgB,CAAM,CAAC,EAAO,MAAM,CAAG,EAAE,AAC/C,OAAM,EAAa,CAClB,eAAgB,EAAc,GAAG,CACjC,YAAa,EAAU,IAAI,EAC5B,GACA,EAAM,OAAO,CAAC,aAAc,wCAC7B,CAEA,EAAW,IACX,EAAa,IACb,EAAqB,MACrB,KACD,CAAE,MAAO,EAAO,CACf,QAAQ,KAAK,CAAC,uBAAwB,GACtC,EAAM,KAAK,CACV,cACA,aAAiB,MAAQ,EAAM,OAAO,CAAG,uBAE3C,QAAU,CACT,EAAa,GACd,CACD,EASM,EAAsB,QAAT,GAAkB,CAAC,GAAU,AAAkB,MAAX,MAAM,CAkB7D,MACC,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CAAC,KAAM,EAAQ,aAAc,WAClC,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,YAAY,CAAA,CAAC,KAAK,QAAQ,UAAU,6CACpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iDAEd,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,WAAW,CAAA,CAAC,UAAU,iDACtB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,UAAU,CAAA,CAAC,UAAU,kCACpB,GAAU,EAAO,MAAM,CAAG,EAAI,CAAM,CAAC,EAAE,CAAC,OAAO,CAAG,cAEpD,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,gBAAgB,CAAA,CAAC,UAAU,kCAC1B,EACE,CAAC,kBAAkB,EAAE,EAAO,WAAW,CAAA,CAAE,CACzC,aACF,GACA,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,+BAAqB,OAC/B,EAAgB,KAAK,UAO7B,GAAU,EAAO,MAAM,CAAG,GAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,4CACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,EAAO,GAAG,CAAC,AAAC,GACZ,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAqC,QAAS,GAAtB,EAAQ,GAAG,GAErC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,IAAK,SAMZ,CAAC,CAAC,OAAU,EAAO,MAAM,AAAK,CAAC,EAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8EACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACd,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,IAAI,CAAA,CAAC,UAAU,sCAChB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,mBAAU,kCAM1B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yDACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BAEb,AAhEkB,GAgEE,GAAe,EAAY,MAAM,CAAG,GACxD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACd,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACA,QAAQ,iBACR,UAAU,+CACV,YAGD,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,YAAY,CAAA,CACZ,MAAO,GAAqB,GAC5B,cAAe,AAAC,GACf,EAAqB,aAGtB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,mBAAmB,CAAA,CAAC,GAAG,0BACvB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,WAAW,CAAA,CAAC,YAAY,uBAE1B,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,mBAAmB,CAAA,UAClB,EAAY,GAAG,CAAC,AAAC,GACjB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,UAAU,CAAA,CAAmB,MAAO,EAAQ,GAAG,UAC/C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACd,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,wBACd,EAAQ,SAAS,CAAC,IAAE,EAAQ,QAAQ,IAErC,EAAQ,SAAS,EACjB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,gCAAuB,cAIxC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yCACd,EAAQ,KAAK,OAXA,EAAQ,GAAG,WAsBhC,GACA,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACd,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACA,QAAQ,gBACR,UAAU,+CACV,YAGD,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,WAAW,CAAA,CACX,GAAG,gBACH,MAAO,EACP,SAAU,AAAC,GAAM,EAAW,EAAE,MAAM,CAAC,KAAK,EAC1C,YAAY,yBACZ,SAAU,OAMb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACd,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACA,QAAQ,aACR,UAAU,+CAET,EAAa,UAAY,yBAE3B,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,QAAQ,CAAA,CACR,GAAG,aACH,MAAO,EACP,SAAU,AAAC,GAAM,EAAa,EAAE,MAAM,CAAC,KAAK,EAC5C,YAAY,4BACZ,UAAU,4BACV,SAAU,IAEX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2EACd,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAM,EAAU,MAAM,CAAC,mBAKxB,EAAU,IAAI,IACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iEACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uCACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6EAAoE,oBAIpF,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oEACb,CAtJa,KACvB,GAAI,CAAC,EAAU,IAAI,GAAI,MAAO,GAE9B,IAAM,EAAc,GACjB,CAAA,EAAG,EAAgB,SAAS,EAAI,GAAG,CAAC,EACpC,EAAgB,QAAQ,EAAI,GAAA,CAC1B,CAAC,IAAI,IAAM,cAEV,EADH,AACgB,GAAa,MAAQ,YAClC,EAAU,GAAc,MAAQ,eAEtC,MAAO,CAAC,GAAG,EAAE,EAAY;AAAA;AAAK,EAAE,UAAU;AAAA;AAAA;AAAmB,EAAE,WAAW;AAAE,EAAE,EAAA,CAAS,CACxF,MA4IS,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qDAA4C,0FAQ9D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACd,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,YAAY,CAAA,CACZ,KAAK,SACL,OAAO,UACP,QA/KY,CA+KH,IA9KhB,EAAW,IACX,EAAa,IACb,EAAqB,MACrB,GAAa,EACd,EA2KQ,MAAM,QACN,WAAW,EACX,SAAU,IAEX,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,YAAY,CAAA,CACZ,KAAK,SACL,OAAO,UACP,QAAS,EACT,UAAW,EACX,SACC,CAAC,EAAU,IAAI,IACd,GAAoB,CAAC,EAAQ,IAAI,IAClC,EAED,MACC,EACG,aACA,EACA,aACA,aAEJ,KAAM,CAAC,GAAa,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,IAAI,CAAA,CAAC,UAAU,YACpC,WAAW,kBASpB,CAmBA,SAAS,GAAmB,SAAE,CAAO,CAA2B,QAC/D,IAAM,EAAkC,YAAtB,EAAQ,SAAS,CAG7B,EAAc,CAAA,EAAA,EAAA,QAAA,AAAQ,EAC3B,EAAA,GAAG,CAAC,gBAAgB,CAAC,WAAW,CAChC,EAAQ,cAAc,CAAG,CAAE,eAAgB,EAAQ,GAAG,AAAC,EAAI,QAG5D,MACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACA,UAAW,CAAA,EAAA,GAAA,EAAA,AAAE,EAAC,aAAc,EAAY,WAAa,8BAGrD,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,MAAM,CAAA,CAAC,UAAU,+BACjB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,WAAW,CAAA,CAAC,IAAK,EAAQ,YAAY,OAAI,IAC1C,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,cAAc,CAAA,CACd,UAAW,CAAA,EAAA,GAAA,EAAA,AAAE,EACZ,EACG,4BACA,0CAGH,EAAQ,UAAU,EAAE,CAAC,EAAE,EAAI,EAAQ,QAAQ,CAAC,EAAE,MAKjD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAA,EAAA,GAAA,EAAA,AAAE,EAAC,0CAClB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACA,UAAW,CAAA,EAAA,GAAA,EAAA,AAAE,EACZ,4BACA,EAAY,WAAa,8BAG1B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,+BACd,EAAQ,UAAU,EAAI,EAAQ,QAAQ,GAExC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yCACd,CAAA,EAAA,GAAA,mBAAA,AAAmB,EAAC,IAAI,KAAK,EAAQ,MAAM,EAAG,CAAE,UAAW,EAAK,QAInE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACA,UAAW,CAAA,EAAA,GAAA,EAAA,AAAE,EACZ,+BACA,EACG,2BACA,0FAIH,EAAQ,QAAQ,CAChB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAU,oEACV,wBAAyB,CACxB,MAAA,EAAQ,AA2EM,EA1Eb,EA0EyB,CA1EA,EAAQ,QAAQ,CAAE,IA2E5C,GAAU,QAAQ,CAAC,EAAM,CAC/B,aAAc,CACb,IACA,KACA,IACA,IACA,IACA,SACA,KACA,IACA,KACA,KACA,KACA,OACA,MACA,CACD,aAAc,CAAC,OAAQ,SAAU,MAAO,QACzC,AADiD,GAzF3C,IAGD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qDACb,GAAyB,EAAQ,WAAW,EAAE,KAKhD,EAAQ,cAAc,EAAI,GAAe,EAAY,MAAM,CAAG,GAC9D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yDACb,EAAY,GAAG,CAAC,AAAC,GACjB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAoC,WAAY,GAA5B,EAAW,GAAG,QAOtC,CAAC,GACD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qDACM,cAAnB,EAAQ,MAAM,EAAoB,cACf,WAAnB,EAAQ,MAAM,EAAiB,YACZ,SAAnB,EAAQ,MAAM,EAAe,SACV,YAAnB,EAAQ,MAAM,EAAkB,oBAMvC,CAUA,SAAS,GAAe,YAAE,CAAU,CAAkC,EACrE,IAAM,EAAc,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,gBAAgB,CAAC,cAAc,CAAE,CACjE,aAAc,EAAW,GAAG,AAC7B,GAEA,MACC,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CACA,KAAM,GAAe,IACrB,SAAU,EAAW,QAAQ,CAC7B,UAAW,CAAA,EAAA,GAAA,EAAE,AAAF,EACV,gGACA,CAAC,GAAe,iCAEjB,QAAS,AAAC,IACL,AAAC,GACJ,EAAE,QADe,MACD,EAElB,YAEA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,SAAS,CAAA,CAAC,UAAU,YACrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACd,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,wCAAgC,EAAW,QAAQ,GAChE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCACX,AAgGN,SAAS,AAAY,CAAa,EACjC,GAAc,IAAV,EAAa,MAAO,UAGxB,IAAM,EAAI,KAAK,KAAK,CAAC,KAAK,GAAG,CAAC,GAAS,KAAK,GAAG,CAAC,OAChD,OAAO,KAAK,KAAK,CAAE,EAAQ,KAAK,GAAG,CAAC,AAH1B,KAG6B,GAAM,KAAO,IAAM,IAF5C,AAEkD,CAFjD,QAAS,KAAM,KAAM,KAAK,AAE4B,CAAC,EAAE,AACzE,EAtGkB,EAAW,IAAI,OAG9B,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,QAAQ,CAAA,CAAC,UAAU,uBAGvB,CA4BA,SAAS,GACR,CAAY,CACZ,EAAkB,EAAK,EAEvB,GAAI,EAAQ,CAEX,IAAI,EAAU,EAwBd,MAAO,CALP,EANA,AAMU,GANA,CANV,EAAU,CAJV,EAAU,EAAQ,OAAO,CACxB,kDACA,GAAA,EAEiB,OAAO,CACxB,oEACA,GAAA,EAIiB,OAAO,CACxB,qDACA,GAAA,EAIiB,OAAO,CACxB,0DACA,GAAA,EAGc,IAAI,EACpB,CAAO,CAEN,IAAM,EAAQ,EAAK,KAAK,CAAC,MACnB,EAAuB,EAAE,CAC3B,GAAU,EAEd,IAAK,IAAM,KAAQ,EAAO,CAEzB,GACC,EAAK,IAAI,GAAG,UAAU,CAAC,MACvB,EAAK,KAAK,CAAC,qBACX,EAAK,KAAK,CAAC,UAAU,AACpB,CACD,GAAU,EACV,KACD,CAGA,CAJQ,EAIY,GAPoB,IAOpC,EAAK,IAAI,IAAe,EAAK,KAAK,CAAC,cACtC,CADqD,IAIlD,AARkD,CAQjD,GACJ,EAAW,IAAI,AADF,CACG,EAElB,CAEA,OAAO,EAAW,IAAI,CAAC,MAAM,IAAI,EAClC,CACD,CE5lBA,IAAA,GAAA,EAAA,CAAA,CAAA,OACA,GAAA,EAAA,CAAA,CAAA,QDCA,GAAA,EAAA,CAAA,CAAA,QAKA,GAAA,EAAA,CAAA,CAAA,QYcA,CAAA,GAAM,GAAA,CAAA,EAAW,CAAA,WAAA,OAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAtBE,CAsBW,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAlBzC,AAkByC,CAlBzC,AAkBmD,CAlBhD,AAkBgD,CDjBpB,ACD5B,CAAA,ADC6B,yGCAhC,IAAK,CAAA,SAET,CACA,SAAW,EAAG,CAAA,CDFyB,ACEzB,CAAA,CAAA,CAAA,CAAA,wCAA+C,CAAA,CAAA,CAAA,CAAA,AAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA,GZA9E,IAAA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QAUO,SAAS,GAAuB,UACtC,CAAQ,UACR,CAAQ,CACqB,EAC7B,GAAM,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GACzC,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACrC,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,IAK1C,EAAU,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,aAAa,CAAC,mBAAmB,CAAE,CAAE,UAAS,GAQ3E,MACC,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,OAAO,CAAA,CAAC,KAAM,EAAa,aAAc,YACzC,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,cAAc,CAAA,CAAC,OAAO,CAAA,CAAA,WAAE,IACzB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,cAAc,CAAA,CACd,UAAU,mEACV,MAAM,eAEN,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCAEd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,0DACd,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,iCAAwB,oBAIvC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yCACb,KAAY,MACZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACA,UAAU,4DACV,YAAU,OACV,YAAU,mBAEV,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,OAAO,CAAA,CAAC,UAAU,+CACnB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yCAAgC,6BAGhD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,mBAAU,0CAIL,AAAnB,MAAQ,MAAM,CACjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gEACd,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,aAAa,CAAA,CAAC,UAAU,sCACzB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,yBACH,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,wBAAe,6CAK7B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kCACb,EAAQ,GAAG,CAAC,AAAC,GACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAEA,QAAS,IAAM,CAhDxB,EAgD0C,EAAO,QAAQ,EA/CzD,GAAe,GADK,AAEpB,EAAa,KA+CJ,UAAU,wEAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCAEd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAW,CAAA,EAAA,GAAA,EAAA,AAAE,EACZ,SACA,EAAO,SAAS,CACb,eACA,kCAGH,EAAO,SAAS,CAChB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,IAAI,CAAA,CAAC,UAAU,YAEhB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAS,UAAU,cAKtB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2DACd,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CACA,UAAW,CAAA,EAAA,GAAA,EAAA,AAAE,EACZ,mBACA,EAAO,SAAS,CACb,gBACA,wBAGH,EAAO,OAAO,GAEhB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,kDACd,CAAA,EAAA,GAAA,mBAAmB,AAAnB,EACA,IAAI,KAAK,EAAO,eAAe,EAC/B,CACC,UAAW,EACZ,QAIH,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sDACX,EAAO,aAAa,GAEtB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCACd,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,0CACd,EAAO,YAAY,CAAE,IACG,IAAxB,EAAO,YAAY,CACjB,UACA,cAEH,EAAO,SAAS,EAChB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4CAAmC,oBAtDlD,EAAO,QAAQ,eAuE5B,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CACA,OAAQ,EACR,aAAc,EACd,SAAU,EACV,SAAU,EACV,KAAM,EAAmB,QAAU,MACnC,WAAY,KACX,GAAa,EACd,MAIJ,CCvJA,IAAA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QACA,GAAA,EAAA,CAAA,CAAA,QAKA,IAAM,GAAiB,CACtB,OACA,WACA,SACA,WACA,WACA,CAED,SAAS,GAAa,CAAc,EACnC,OAAO,EAAO,MAAM,CAAC,GAAG,WAAW,GAAK,EAAO,KAAK,CAAC,EACtD,CAEA,SAAS,GAAW,CAAkB,SACrC,AAAK,EACE,EADH,EACO,KADK,AACA,GAAW,kBAAkB,CAAC,QAAS,CACtD,KAAM,UACN,MAAO,OACP,IAAK,SACN,GALuB,SAMxB,CAEA,SAAS,GAAe,CAAc,EACrC,OAAQ,GACP,IAAK,OACL,IAAK,WACJ,MAAO,kEACR,KAAK,SACL,IAAK,OACL,IAAK,WACL,IAAK,YACJ,MAAO,sEACR,KAAK,OACL,IAAK,UACL,IAAK,cACJ,MAAO,0EACR,KAAK,WACL,IAAK,YACL,IAAK,UACJ,MAAO,8DACR,KAAK,IACJ,MAAO,kEAGT,CACD,CAiBO,SAAS,GAAa,QAC5B,CAAM,UACN,CAAQ,WACR,CAAS,aACT,CAAW,aACX,CAAW,CACX,gBAAc,YACd,CAAU,UACV,CAAQ,QACR,CAAM,UACN,CAAQ,OACR,CAAK,iBACL,CAAe,CACI,EACnB,IAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,EAAQ,CAAA,EAAA,EAAA,QAAA,AAAQ,IAEtB,MACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oKACd,CAAA,EAAA,EAAA,GAAA,EAAC,AO9EQ,EP8ER,CAAoB,UAAU,yBAEhC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACd,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,4DACZ,EAAO,WAAW,GAEnB,EACA,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,YAAY,CAAA,CAAC,MAAO,EAAa,cAAe,YAChD,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,mBAAmB,CAAA,CAAC,UAAU,kBAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,WAAW,CAAA,CAAA,KAEb,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,mBAAmB,CAAA,UAClB,GAAe,GAAG,CAAC,AAAC,GACpB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,UAAU,CAAA,CAAc,MAAO,WAC9B,GAAa,IADE,SAOpB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,oBAAoB,CAAA,CACpB,OAAQ,EAAO,MAAM,CACrB,KAAK,QACL,UAAU,EACV,WAAW,cAIb,CAAC,GACD,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACA,QAAS,EACT,UAAU,oHAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,YAAY,0BASvC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDAEd,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAuB,SAAU,WACjC,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAU,qMACjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAU,+CACV,KAAK,OACL,OAAO,eACP,QAAQ,qBAER,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACA,cAAc,QACd,eAAe,QACf,YAAY,IACZ,EAAE,2GAGJ,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4DACd,OAGH,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,gEAAuD,kBAOzE,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,OAAO,CAAA,WACP,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,cAAc,CAAA,CAAC,OAAO,CAAA,CAAA,WACtB,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAU,qMACjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAU,+CACV,KAAK,OACL,OAAO,eACP,QAAQ,qBAER,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACA,cAAc,QACd,eAAe,QACf,YAAY,IACZ,EAAE,gFAGJ,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4DACd,GAAU,QAAU,OAGvB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,gEAAuD,kBAKzE,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,cAAc,CAAA,CACd,UAAU,qCACV,MAAM,QACN,KAAK,mBAEL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6DACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACd,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uDAA8C,aAG5D,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACN,OAAO,UACP,KAAK,KACL,QAAS,IACR,EAAO,IAAI,CAAC,CAAC,uBAAuB,EAAE,EAAA,CAAU,YAGjD,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,IAAI,CAAA,CAAC,UAAU,iBAAiB,cAKpC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oCACb,GAAY,EAAS,MAAM,CAAG,EAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,eACb,EAAS,GAAG,CAAC,AAAC,GACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEA,UAAU,2HACV,QAAS,IAAM,EAAO,IAAI,CAAC,CAAC,UAAU,EAAE,EAAQ,GAAG,CAAA,CAAE,YAErD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAW,CAAC,8BAA8B,EACtB,cAAnB,EAAQ,MAAM,CACX,eACmB,gBAAnB,EAAQ,MAAM,CACd,gBACA,cAAA,CACF,GAEH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACd,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sEACX,EAAQ,KAAK,GAEd,EAAQ,WAAW,EACnB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,6DACX,EAAQ,WAAW,SAKxB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CACL,UAAW,GAAe,EAAQ,MAAM,EACxC,QAAQ,mBAEP,GAAa,EAAQ,MAAM,MA7BxB,EAAQ,GAAG,KAmCnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACd,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,UAAU,CAAA,CAAC,UAAU,4DACtB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDAA2C,+BAU7D,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,OAAO,CAAA,WACP,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,cAAc,CAAA,CAAC,OAAO,CAAA,CAAA,WACtB,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAU,qMACjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAU,6CACV,KAAK,OACL,OAAO,eACP,QAAQ,qBAER,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACA,cAAc,QACd,eAAe,QACf,YAAY,IACZ,EAAE,sGAGJ,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4DACd,GAAQ,QAAU,OAGrB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,gEAAuD,gBAKzE,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,cAAc,CAAA,CACd,UAAU,qCACV,MAAM,QACN,KAAK,mBAEL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6DACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACd,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uDAA8C,WAG5D,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACN,OAAO,UACP,KAAK,KACL,QAAS,IAAM,EAAO,IAAI,CAAC,CAAC,qBAAqB,EAAE,EAAA,CAAU,YAE7D,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,IAAI,CAAA,CAAC,UAAU,iBAAiB,cAKpC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oCACb,GAAU,EAAO,MAAM,CAAG,EAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,eACb,EAAO,GAAG,CAAC,AAAC,GACZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEA,UAAU,2HACV,QAAS,IAAM,EAAO,IAAI,CAAC,CAAC,QAAQ,EAAE,EAAM,GAAG,CAAA,CAAE,YAEjD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8CACf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACd,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,uEAA6D,UACjE,EAAM,WAAW,IAEzB,EAAM,KAAK,EACX,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,6DACX,EAAM,KAAK,SAKhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gCACb,EAAM,KAAK,EACX,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,8DAAoD,IAC9D,EAAM,KAAK,CAAC,cAAc,MAG9B,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CACL,UAAW,GAAe,EAAM,MAAM,EAAI,SAC1C,QAAQ,mBAEP,EAAM,MAAM,EAAI,eA3Bd,EAAM,GAAG,KAkCjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACd,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,OAAO,CAAA,CAAC,UAAU,4DACnB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDAA2C,6BAU7D,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,OAAO,CAAA,WACP,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,cAAc,CAAA,CAAC,OAAO,CAAA,CAAA,WACtB,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAU,qMACjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAU,+CACV,KAAK,OACL,OAAO,eACP,QAAQ,qBAER,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACA,cAAc,QACd,eAAe,QACf,YAAY,IACZ,EAAE,2HAGJ,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4DACd,GAAU,QAAU,OAGvB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,gEAAuD,kBAKzE,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,cAAc,CAAA,CACd,UAAU,qCACV,MAAM,QACN,KAAK,mBAEL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6DACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACd,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uDAA8C,aAG5D,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACN,OAAO,UACP,KAAK,KACL,QAAS,IACR,EAAM,IAAI,CACT,iBACA,yDAIF,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,IAAI,CAAA,CAAC,UAAU,iBAAiB,cAKpC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oCACb,GAAY,EAAS,MAAM,CAAG,EAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,eACb,EAAS,GAAG,CAAC,AAAC,GACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEA,UAAU,2HACV,QAAS,IACR,EAAM,IAAI,CACT,eACA,8CAIF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAW,CAAC,8BAA8B,EACzC,AAAmB,WAAX,MAAM,CACX,eACmB,SAAnB,EAAQ,MAAM,CACd,gBACA,aAAA,CACF,GAEH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACd,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,uEAA6D,YAC/D,EAAQ,aAAa,IAEhC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDACX,GAAW,EAAQ,aAAa,UAIpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gCACb,EAAQ,KAAK,EACb,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,8DAAoD,IAC9D,EAAQ,KAAK,CAAC,cAAc,MAGhC,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CACL,UAAW,GAAe,EAAQ,MAAM,EACxC,QAAQ,mBAEP,EAAQ,MAAM,QAtCZ,EAAQ,GAAG,KA6CnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACd,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,QAAQ,CAAA,CAAC,UAAU,4DACpB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDAA2C,+BAU7D,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,OAAO,CAAA,WACP,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,cAAc,CAAA,CAAC,OAAO,CAAA,CAAA,WACtB,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAU,qMACjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAU,2CACV,KAAK,OACL,OAAO,eACP,QAAQ,qBAER,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACA,cAAc,QACd,eAAe,QACf,YAAY,IACZ,EAAE,mJAGJ,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4DACd,GAAO,QAAU,OAGpB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,gEAAuD,eAKzE,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,cAAc,CAAA,CACd,UAAU,qCACV,MAAM,MACN,KAAK,mBAEL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6DACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACd,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uDAA8C,UAG5D,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,OAAO,UAAU,KAAK,KAAK,QAAS,YAC3C,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,IAAI,CAAA,CAAC,UAAU,iBAAiB,cAKpC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oCACb,GAAS,EAAM,MAAM,CAAG,EACxB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,eACb,EAAM,GAAG,CAAC,AAAC,GACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEA,UAAU,sHAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAW,CAAC,8BAA8B,EACzB,cAAhB,EAAK,MAAM,CACR,eACgB,cAAhB,EAAK,MAAM,CACX,aACA,gBAAA,CACF,GAEH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACd,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sEACX,EAAK,KAAK,GAEX,EAAK,IAAI,EACT,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDACX,GAAW,EAAK,IAAI,UAKzB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CACL,UAAW,GAAe,EAAK,MAAM,EACrC,QAAQ,mBAEP,EAAK,MAAM,KA5BR,EAAK,GAAG,KAkChB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACd,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,aAAa,CAAA,CAAC,UAAU,4DACzB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDAA2C,iCAWjE,CCzjBA,IAAA,GAAA,EAAA,CAAA,CAAA,QAaA,SAAS,GAAe,CAAiB,SACxC,AAAK,EACE,EADH,AACY,MADD,AACO,CAAC,GAAG,WAAW,GAAK,EAAS,KAAK,CAAC,GADnC,eAEvB,CAgBO,SAAS,GAAkB,QACjC,CAAM,CACN,WAAS,CACT,MAAI,cACJ,CAAY,CACY,MAjCC,EAkCzB,MACC,CAAA,CAnC2C,CAmC3C,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,gBAAgB,CAAA,UAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,CAAC,UAAU,mBAAU,YAEtC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,iBAAiB,CAAA,UACjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBAEd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4DAEb,CAAC,EAAO,QAAQ,EAAI,CAAA,CAAS,EAC7B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CAAC,UAAU,2EAAkE,aAGlF,EACA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,WAAW,CAAA,CACX,MAAO,EAAK,QAAQ,CACpB,SAAU,AAAC,GAAM,EAAa,WAAY,EAAE,MAAM,CAAC,KAAK,EACxD,YAAY,iCAGb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iDACX,EAAO,QAAQ,MAOpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CAAC,UAAU,2EAAkE,gBAGnF,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iDAnEnB,CAoEQ,EAAiB,CApErB,CAAC,AAoE2B,UAAU,EApEzB,AACV,EACL,KAAK,CAAC,KACN,GAAG,CAAC,AAAC,GAAS,EAAK,MAAM,CAAC,GAAG,WAAW,GAAK,EAAK,KAAK,CAAC,IACxD,IAAI,CAAC,KAJiB,qBAyElB,AAAC,GAAO,QAAQ,EAAI,CAAA,CAAS,EAC7B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CAAC,UAAU,2EAAkE,aAGlF,EACA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,WAAW,CAAA,CACX,MAAO,EAAK,QAAQ,CACpB,SAAU,AAAC,GAAM,EAAa,WAAY,EAAE,MAAM,CAAC,KAAK,EACxD,YAAY,0BAGb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iDACX,GAAe,EAAO,QAAQ,OAOlC,CAAC,EAAO,UAAU,EAAI,CAAA,CAAS,EAC/B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CAAC,UAAU,2EAAkE,SAGlF,EACA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,WAAW,CAAA,CACX,MAAO,EAAK,UAAU,CACtB,SAAW,AAAD,GAAO,EAAa,aAAc,EAAE,MAAM,CAAC,KAAK,EAC1D,YAAY,uBAGb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iDACX,GAAe,EAAO,UAAU,OAOpC,CAAC,EAAO,aAAa,EAAI,CAAA,CAAS,EAClC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CAAC,UAAU,2EAAkE,aAGlF,EACA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,WAAW,CAAA,CACX,MAAO,EAAK,aAAa,CACzB,SAAW,AAAD,GACT,EAAa,gBAAiB,EAAE,MAAM,CAAC,KAAK,EAE7C,YAAY,4BAGb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iDACX,GAAe,EAAO,aAAa,OAOvC,CAAC,EAAO,iBAAiB,EAAI,CAAA,CAAS,EACtC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CAAC,UAAU,2EAAkE,uBAGlF,EACA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,WAAW,CAAA,CACX,MAAO,EAAK,iBAAiB,CAC7B,SAAU,AAAC,GACV,EAAa,oBAAqB,EAAE,MAAM,CAAC,KAAK,EAEjD,YAAY,qBAGb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iDACX,EAAO,iBAAiB,SAQ7B,CAAC,EAAO,kBAAkB,EAAI,CAAA,CAAS,EACvC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+DACd,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CAAC,UAAU,2EAAkE,wBAGlF,EACA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,QAAQ,CAAA,CACR,MAAO,EAAK,kBAAkB,CAC9B,SAAU,AAAC,GACV,EAAa,qBAAsB,EAAE,MAAM,CAAC,KAAK,EAElD,YAAY,uDACZ,UAAU,SACV,KAAM,IAGP,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,qEACX,EAAO,kBAAkB,aASnC,CCtLA,IAAA,GAAA,EAAA,CAAA,CAAA,6BAqCO,SAAS,GAAc,QAC7B,CAAM,gBACN,CAAc,WACd,CAAS,MACT,CAAI,cACJ,CAAY,CACZ,cAAY,UACZ,CAAQ,CACY,MAxCM,KAAc,KAyC1B,CAAA,EAAA,EAAA,QAAA,AAAQ,IACtB,GAAM,CAAC,EAAqB,EAAuB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAE/D,MACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBAEd,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,gBAAgB,CAAA,UAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,CAAC,UAAU,mBAAU,mBAEtC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,iBAAiB,CAAA,CAAC,UAAU,qBAC3B,EACA,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6CACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,oDAA2C,oBAG3D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACd,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,8DACd,EAAe,SAAS,CAAC,IAAE,EAAe,QAAQ,IAEpD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAc,UAAU,kCAG1B,EAAe,QAAQ,EACvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6CACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,oDAA2C,cAG3D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4DACd,EAAe,QAAQ,MAI1B,EAAe,KAAK,EACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6CACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,oDAA2C,UAG3D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,iDAhFzB,CAiFW,EAAkB,CAjFzB,CAiFwC,AAjFvC,KAiF4C,EAjFrC,AACL,EADY,QAqFX,EAAe,KAAK,EACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6CACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,oDAA2C,UAG3D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,sEACd,EAAe,KAAK,SAMzB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8DACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,oDAA2C,6BAG1D,EACA,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gCACd,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,YAAY,CAAA,CACZ,MAAO,EAAK,uBAAuB,CACnC,cAAe,AAAC,GACf,EAAa,0BAA2B,aAGzC,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,mBAAmB,CAAA,CAAC,UAAU,eAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,WAAW,CAAA,CAAC,YAAY,aAE1B,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,mBAAmB,CAAA,WACnB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,UAAU,CAAA,CAAC,MAAM,iBAAQ,eAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,UAAU,CAAA,CAAC,MAAM,iBAAQ,mCAG1B,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,UAAU,CAAA,CAAC,MAAM,gBAAO,iCAO5B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4DAxH1B,AAyHY,SAzHH,AAA8B,CAAa,EACnD,GAAI,CAAC,EAAM,MAAO,gBAClB,OAAQ,GACP,IAAK,QACJ,MAAO,YACR,KAAK,QACJ,MAAO,gCACR,KAAK,OACJ,MAAO,sBACR,SACC,OAAO,CACT,CACD,EA8GY,EAAO,uBAAuB,YAQpC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,4BACd,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDAA2C,kCAS5D,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,gBAAgB,CAAA,UAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,CAAC,UAAU,mBAAU,gCAItC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,iBAAiB,CAAA,UAChB,GAAgB,EAAa,MAAM,CAAG,GAG/B,CAFP,CAEmB,AAAwB,AAF1C,aACM,EAAY,CAAY,CAAC,EAAE,EACL,SAAS,CAGpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBAEd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kDACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAW,CAAC,qCAAqC,EAChD,EACG,cACqB,cAArB,EAAU,MAAM,EACK,AAArB,aAAU,MAAM,CAChB,eACqB,SAArB,EAAU,MAAM,CAChB,cACA,aAAA,CACF,GAEH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,wCACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACA,UAAW,CAAC,wCAAwC,EACnD,EACG,mEACA,2EAAA,CACF,UAED,EAAY,UAAY,eAG3B,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,6DACX,EAAU,OAAO,GAEnB,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,0DAAgD,QACtD,IACN,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBACd,EAAU,QAAQ,MAGrB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,2DACX,IAAI,KAAK,EAAU,MAAM,EAAE,kBAAkB,CAC7C,QACA,CACC,MAAO,QACP,IAAK,UACL,KAAM,UACN,KAAM,UACN,OAAQ,SACT,aAQJ,CAAC,GACD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACQ,WAArB,EAAU,MAAM,EAChB,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,iFACf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACA,UAAU,UACV,KAAK,OACL,OAAO,eACP,QAAQ,sBAER,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACA,cAAc,QACd,eAAe,QACf,YAAY,IACZ,EAAE,qCAEH,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACA,cAAc,QACd,eAAe,QACf,YAAY,IACZ,EAAE,+HAEE,YAIP,AAAqB,gBAAX,MAAM,EAChB,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,+EACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAU,UACV,KAAK,OACL,OAAO,eACP,QAAQ,qBAER,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACA,cAAc,QACd,eAAe,QACf,YAAY,IACZ,EAAE,qBAEE,eAIc,SAArB,EAAU,MAAM,EAChB,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,6EACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAU,UACV,KAAK,OACL,OAAO,eACP,QAAQ,qBAER,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACA,cAAc,QACd,eAAe,QACf,YAAY,IACZ,EAAE,2GAEE,UAIc,YAArB,EAAU,MAAM,EAChB,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,2EACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACA,UAAU,UACV,KAAK,OACL,OAAO,eACP,QAAQ,qBAER,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACA,cAAc,QACd,eAAe,QACf,YAAY,IACZ,EAAE,wDAEE,gBAQV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACA,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACA,QAAS,IAAM,EAAuB,CAAC,GACvC,UAAU,wHAET,EACA,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,OAAS,CAAA,CAAC,UAAU,YAAY,kBAIlC,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,WAAW,CAAA,CAAC,UAAU,YAAY,oBAMrC,GACA,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kKACb,EAAU,WAAW,EACrB,EAAU,QAAQ,EAClB,EAAU,cAAc,EACxB,4BAOJ,EAAa,MAAM,CAAG,GACtB,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,oHACX,EAAa,MAAM,CAAG,EAAE,mBACxB,EAAa,MAAM,CAAG,GAAM,EAAI,IAAM,UAO5C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,2DAAkD,wDAQnE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,gBAAgB,CAAA,UAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,CAAC,UAAU,mBAAU,sBAIrC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,iBAAiB,CAAA,CAAC,UAAU,qBAC3B,GAAY,EAAS,MAAM,CAAG,EAC9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iCACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,oDAA2C,mBAG3D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,6DACd,EAAS,MAAM,MAGlB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iCACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,oDAA2C,iBAG3D,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,8DAAoD,IAElE,EACC,MAAM,CACN,CAAC,EAAa,IAAyB,EAAM,EAAI,KAAK,CACtD,GAEA,cAAc,SAGlB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iCACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,oDAA2C,gBAG3D,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,8DAAoD,IAElE,EACC,MAAM,CAAC,AAAC,GAAwC,SAAf,EAAI,MAAM,EAC3C,MAAM,CACN,CAAC,EAAa,IAAyB,EAAM,EAAI,KAAK,CACtD,GAEA,cAAc,YAKnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wDACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mGACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,UAAU,4BAEzB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,0DAAiD,uBAG/D,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDAA2C,iDAS/D,CCjaO,SAAS,GAAgB,WAC/B,CAAS,OACT,CAAK,eACL,CAAa,CACS,EACtB,MACC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACV,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,gBAAgB,CAAA,WAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,CAAC,UAAU,mBAAU,iBACrC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDAA2C,gDAIzD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,iBAAiB,CAAA,UAChB,EACA,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACA,UAAU,iJACV,MAAO,EACP,SAAW,AAAD,GAAO,EAAc,EAAE,MAAM,CAAC,KAAK,IAE3C,EACH,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yDACd,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,qEACX,MAIH,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,4BACd,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,2DAAkD,6CAQrE,CChDA,IAAA,GAAA,EAAA,CAAA,CAAA,QAiBO,SAAS,GAAuB,QACtC,CAAM,WACN,CAAS,MACT,CAAI,cACJ,CAAY,CACiB,EAC7B,IAAM,EAAQ,CAAA,EAAA,EAAA,QAAA,AAAQ,IAChB,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAW,EAAE,QAGrD,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KAIT,EAHmB,EAChB,EAAK,KAAK,CAAC,AAEF,QAFU,MAAM,CAAC,SAC1B,EAAO,IAAI,EAAI,EAAE,CAErB,EAAG,CAAC,EAAM,EAAO,IAAI,CAAC,EAqBrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBAEd,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,gBAAgB,CAAA,UAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,CAAC,UAAU,mBAAU,WAEtC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,iBAAiB,CAAA,WACjB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,eAAe,CAAA,CACf,KAAM,EACN,QA1BJ,AADwB,CA2BX,GAxBb,IAAM,EACc,YAAnB,OAAO,EAAyB,EAAQ,GAAY,EACrD,EAAY,GACZ,EAAa,EAAa,IAAI,CAAC,MAChC,EAqBK,WAnBmB,AAAD,CAmBN,GAlBhB,EAAM,OAAO,CAAC,YAAa,CAAC,CAAC,EAAE,EAAI,gCAAgC,CAAC,CACrE,EAkBK,aAhBoB,AAAC,CAgBP,GAflB,EAAM,OAAO,CAAC,cAAe,CAAC,CAAC,EAAE,EAAI,oCAAoC,CAAC,CAC3E,EAeK,YAAY,yCACZ,SAAU,CAAC,IAEX,CAAC,GAAiC,IAApB,EAAS,MAAM,EAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,gEAAuD,2DAQtE,EAAO,cAAc,EAAI,EAAO,cAAc,CAAC,MAAM,CAAG,GACxD,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,gBAAgB,CAAA,UAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,CAAC,UAAU,mBAAU,sBAItC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,iBAAiB,CAAA,UACjB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACb,EAAO,cAAc,CAAC,GAAG,CAAC,CAAC,EAAS,IACpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAgB,UAAU,oCAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qCACf,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,iDACd,MAHO,aAalB,CC/EA,IAAA,GAAA,EAAA,CAAA,CAAA,QAQe,SAAS,KACvB,MAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IACT,CAAA,EAAA,EAAA,SAAA,AAAS,IACxB,IAAM,EAAW,EAAO,QAAQ,CAC1B,EAAQ,CAAA,EAAA,EAAA,QAAA,AAAQ,IAChB,EAAe,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,EAAA,GAAG,CAAC,OAAO,CAAC,MAAM,EAC7C,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACrC,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjD,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GACnD,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAkB,OAChE,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,WACrC,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CAChC,SAAU,GACV,mBAAoB,GACpB,OAAQ,OACR,SAAU,GACV,WAAY,GACZ,cAAe,GACf,kBAAmB,GACnB,wBAAyB,GACzB,KAAM,GACN,MAAO,EACR,GAGM,EAAS,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,OAAO,CAAC,GAAG,CAAE,CAAE,GAAI,CAA0B,GACnE,EAAiB,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,cAAc,CAAC,YAAY,CAAE,CAChE,SAAU,CACX,GACM,EAAmB,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,gBAAgB,CAAC,YAAY,CAAE,CACpE,SAAU,CACX,GACM,EAAiB,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,cAAc,CAAC,iBAAiB,CAAE,CACrE,SAAU,CACX,GAGM,EAAS,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,MAAM,CAAC,IAAI,CAAE,CACxC,SAAU,CACX,GACM,EAAW,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAE,CAC5C,SAAU,CACX,GACM,EAAW,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAE,CAC5C,SAAU,CACX,GACM,EAAc,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,KAAK,CAAC,IAAI,CAAE,CAC5C,SAAU,CACX,GAGM,EAAe,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAA,GAAG,CAAC,aAAa,CAAC,YAAY,CAAE,CAC7D,SAAU,CACX,GAEA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACL,GACH,EAAQ,CACP,EAFU,OAEA,EAAO,QAAQ,EAAI,GAC7B,mBAAoB,EAAO,kBAAkB,EAAI,GACjD,OAAQ,EAAO,MAAM,CACrB,SAAU,EAAO,QAAQ,EAAI,GAC7B,WAAY,EAAO,UAAU,EAAI,GACjC,cAAe,EAAO,aAAa,EAAI,GACvC,kBAAmB,EAAO,iBAAiB,EAAI,GAC/C,wBAAyB,EAAO,uBAAuB,EAAI,GAC3D,KAAM,CAAC,EAAO,IAAI,EAAI,EAAA,AAAE,EAAE,IAAI,CAAC,MAC/B,MAAO,EAAO,KAAK,EAAI,EACxB,EAEF,EAAG,CAAC,EAAO,EAEX,IAAM,EAAU,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IACvB,CAAI,CAAC,IAEJ,CAAC,EAAK,CAFM,OAAO,AAEL,EAAI,EAAA,CAAE,IAAO,EAAD,AAAQ,QAAQ,EAAI,EAAA,CAAE,EAChD,CAAC,EAAK,kBAAkB,EAAI,EAAA,CAAE,IAAO,EAAD,AAAQ,kBAAkB,EAAI,EAAA,CAAE,EACpE,EAAK,MAAM,GAAK,EAAO,MAAM,EAC7B,CAAC,EAAK,QAAQ,EAAI,EAAA,CAAE,GAAO,GAAO,AAAR,QAAgB,EAAI,EAAA,CAAE,EAChD,CAAC,EAAK,UAAU,EAAI,EAAA,CAAE,IAAO,EAAD,AAAQ,UAAU,EAAI,EAAA,CAAE,EACpD,CAAC,EAAK,aAAa,EAAI,EAAA,CAAE,IAAO,EAAD,AAAQ,aAAa,EAAI,EAAA,CAAE,EAC1D,CAAC,EAAK,iBAAiB,EAAI,EAAA,CAAE,IAAO,EAAD,AAAQ,iBAAiB,EAAI,EAAA,CAAE,EAClE,CAAC,EAAK,uBAAuB,EAAI,EAAA,CAAE,GACjC,GAAO,AAAR,uBAA+B,EAAI,EAAA,CAAE,EACtC,CAAC,EAAK,IAAI,EAAI,EAAA,CAAE,GAAM,CAAC,EAAO,IAAI,EAAI,EAAE,AAAF,EAAI,IAAI,CAAC,OAC/C,CAAC,EAAK,KAAK,EAAI,EAAA,CAAE,IAAO,EAAD,AAAQ,KAAK,EAAI,EAAA,CAAE,EAEzC,CAAC,EAAM,EAAO,EAEX,EAAa,UAClB,GAAI,CAAC,EAAQ,OACb,IAAM,EAAmC,CAAC,EA4B1C,GA3BI,CAAC,EAAK,QAAQ,EAAI,EAAA,CAAE,IAAO,EAAD,AAAQ,QAAQ,EAAI,EAAA,CAAE,GACnD,EAAQ,QAAQ,CAAG,EAAK,QAAQ,OAAI,CAAA,EACjC,CAAC,EAAK,kBAAkB,EAAI,EAAA,CAAE,IAAO,EAAD,AAAQ,kBAAkB,EAAI,EAAA,CAAE,GACvE,EAAQ,kBAAkB,CAAG,EAAK,kBAAkB,OAAI,CAAA,EACrD,EAAK,MAAM,GAAK,EAAO,MAAM,EAChC,GAAQ,MAAM,CAAG,EAAK,MAAA,AAAM,EACzB,CAAC,EAAK,QAAQ,EAAI,EAAA,CAAE,IAAO,EAAO,AAAR,QAAgB,EAAI,EAAA,CAAE,GACnD,EAAQ,QAAQ,CAAG,EAAK,QAAQ,OAAI,CAAA,EACjC,CAAC,EAAK,UAAU,EAAI,EAAA,CAAE,IAAO,EAAO,AAAR,UAAkB,EAAI,EAAA,CAAE,GACvD,EAAQ,UAAU,CAAG,EAAK,UAAU,OAAI,CAAA,EACrC,CAAC,EAAK,aAAa,EAAI,EAAA,CAAE,IAAO,EAAD,AAAQ,aAAa,EAAI,EAAA,CAAE,GAC7D,EAAQ,aAAa,CAAG,EAAK,aAAa,OAAI,CAAA,EAC3C,CAAC,EAAK,iBAAiB,EAAI,EAAA,CAAE,IAAO,EAAD,AAAQ,iBAAiB,EAAI,EAAA,CAAE,GACrE,EAAQ,iBAAiB,CAAG,EAAK,iBAAiB,OAAI,CAAA,EAEtD,CAAC,EAAK,uBAAuB,EAAI,EAAA,CAAE,IAClC,EAAD,AAAQ,uBAAuB,EAAI,EAAA,CAAE,EAErC,GAAQ,uBAAuB,CAC9B,EAAK,uBAAuB,OAAI,CAAA,EAC9B,CAAC,EAAK,IAAI,EAAI,EAAA,CAAE,GAAM,CAAC,EAAO,IAAI,EAAI,EAAA,AAAE,EAAE,IAAI,CAAC,QAClD,EAAQ,IAAI,CAAG,EAAK,IAAI,CACrB,EAAK,IAAI,CAAC,KAAK,CAAC,QAAQ,MAAM,CAAC,SAC/B,MAAA,EACA,AAAC,GAAK,KAAK,EAAI,EAAA,CAAE,IAAO,EAAD,AAAQ,KAAK,EAAI,EAAA,CAAE,GAC7C,EAAQ,KAAK,CAAG,EAAK,KAAK,EAAI,MAAA,EAEK,IAAhC,OAAO,IAAI,CAAC,GAAS,MAAM,CAAQ,YACtC,GAAa,GAId,GAAI,CACH,MAAM,EAAa,CAClB,GAAI,EACJ,GAAG,CAAO,AACX,GACA,EAAM,OAAO,CAAC,iBAAkB,iCAChC,EAAa,GACd,CAAE,MAAO,EAAK,CACb,IAAM,EACL,aAAe,MAAQ,EAAI,OAAO,CAAG,yBACtC,EAAM,KAAK,CAAC,QAAS,EACtB,CACD,SAwDA,KACY,IAAX,QACmB,IAAnB,QACqB,IAArB,QACmB,IAAnB,QACW,IAAX,GACA,KAAa,OACA,SAAb,GACA,KAAgB,YACC,IAAjB,EAGC,CAAA,EAAA,EAFA,AAEA,GAAA,EAAC,MAAA,CAAI,UAAU,oCACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mBACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,cACpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,gBACpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,gBACpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,uBAQpB,EAsBJ,CAAA,EAAA,EAAA,CAtBY,GAsBZ,EAAA,EAAA,QAAA,CAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2CACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WAEA,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CACA,OAAQ,EACR,SAAU,EACV,UAAW,EACX,YAAa,IAAM,GAAa,GAChC,YAAa,EAAK,MAAM,CACxB,eAAgB,AAAC,GAChB,EAAQ,AAAC,IAAU,CAAE,EAAH,CAAM,CAAI,CAAE,OAAQ,EAAM,CAAC,EAE9C,WAAY,GAAc,QAAU,EACpC,SAAU,EACV,OAAQ,EACR,SAAU,EACV,MAAO,EACP,gBAAiB,IAAM,GAAmB,KAI3C,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,UAAU,CAAA,CAAC,MAAO,EAAW,cAAe,YAC5C,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,cAAc,CAAA,WACd,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,iBAAiB,CAAA,CAAC,MAAM,mBAAU,mBAGnC,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,iBAAiB,CAAA,CAAC,MAAM,sBAAa,0BAGtC,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,iBAAiB,CAAA,CAAC,MAAM,yBAAgB,mCAM1C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDAEd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BAEd,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,iBAAiB,CAAA,CAAC,MAAM,UAAU,UAAU,2BAE5C,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CACA,OAAQ,EACR,UAAW,EACX,KAAM,CACL,SAAU,EAAK,QAAQ,CACvB,mBAAoB,EAAK,kBAAkB,CAC3C,SAAU,EAAK,QAAQ,CACvB,WAAY,EAAK,UAAU,CAC3B,cAAe,EAAK,aAAa,CACjC,kBAAmB,EAAK,iBAAiB,AAC1C,EACA,aAAc,CAAC,EAAO,IACrB,EAAQ,AAAC,IAAU,CAAE,EAAH,CAAM,CAAI,CAAE,CAAC,EAAM,CAAE,EAAM,CAAC,IAKhD,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CACA,OAAQ,EACR,UAAW,EACX,KAAM,EAAK,IAAI,CACf,aAAc,AAAC,GACd,EAAQ,AAAC,IAAU,CAAE,EAAH,CAAM,CAAI,CAAE,KAAM,EAAM,CAAC,IAK7C,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CACA,UAAW,EACX,MAAO,EAAK,KAAK,CACjB,cAAe,AAAC,GACf,EAAQ,AAAC,IAAU,CAAE,EAAH,CAAM,CAAI,CAAE,MAAO,EAAM,CAAC,OAM/C,CAAA,EAAA,EAAA,IAAA,EAAC,GAAA,iBAAiB,CAAA,CACjB,MAAM,aACN,UAAU,2BAGV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACA,SAAU,EACV,WAAY,GAAoB,EAAE,CAClC,SAAU,KAEV,IAID,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACA,SAAU,EACV,SAAU,GAAkB,EAAE,CAC9B,SAAU,KAEV,OAKF,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,iBAAiB,CAAA,CAAC,MAAM,gBAAgB,UAAU,gBAClD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,CACd,WAAW,SACX,SAAU,EACV,WAAY,EAAO,WAAW,QAMjC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACd,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CACA,OAAQ,EACR,eAAgB,EAChB,UAAW,EACX,KAAM,CACL,wBAAyB,EAAK,uBAAuB,AACtD,EACA,aAAc,CAAC,EAAO,IACrB,EAAQ,AAAC,IAAU,CAAE,EAAH,CAAM,CAAI,CAAE,CAAC,EAAM,CAAE,EAAM,CAAC,EAE/C,aAAc,EACd,SAAU,mBAUjB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CACA,OAAQ,EACR,aAAc,EACd,SAAU,EACV,KAAM,EACN,WAAY,KACX,GAAoB,EACrB,IAGD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,gBAAgB,CAAA,CAChB,OAAA,EAAS,AAnPX,CAJM,EAAU,EAAE,EAIV,IAAI,CAAC,CACZ,MAAO,OACP,QAAS,EACT,OAAQ,UACR,SAAU,CAAC,EACX,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,WACxB,GAEI,GACH,EAAQ,IAAI,CAAC,CADC,AAEb,MAAO,SACP,QAAS,KACR,GAAa,GACb,EAAQ,CACP,SAAU,GAAQ,UAAY,GAC9B,mBAAoB,GAAQ,oBAAsB,GAClD,OAAQ,GAAQ,QAAU,OAC1B,SAAU,GAAQ,UAAY,GAC9B,WAAY,GAAQ,YAAc,GAClC,cAAe,GAAQ,eAAiB,GACxC,kBAAmB,GAAQ,mBAAqB,GAChD,wBAAyB,GAAQ,yBAA2B,GAC5D,KAAM,CAAC,GAAQ,MAAQ,EAAA,AAAE,EAAE,IAAI,CAAC,MAChC,MAAO,GAAQ,OAAS,EACzB,EACD,EACA,OAAQ,SACT,GAIG,GAAgB,OAAS,CAAC,GAC7B,EAAQ,IAAI,CAAC,CAD2B,AAEvC,MAAO,aACP,QAAS,KACR,EAAkB,OAClB,GAAoB,EACrB,EACA,OAAQ,YACR,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,AC9LI,ED8LJ,CAAa,UAAU,YAC9B,SAAU,OACX,GAGM,GAwML,kBAAmB,EACnB,UAAW,IAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACT,OAAQ,EACR,aAAc,EACd,cAAe,CACd,SAAU,CACX,OAhLD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oCACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mBACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wEACd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oGACd,CAAA,EAAA,EAAA,GAAA,EVvOQ,AUuOP,EAAA,CAAwB,UAAU,6CAEpC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kEAAyD,qBAGvE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,4CAAmC,+FA2KtD","ignoreList":[0,11,12,13,14,15,16,17,18,19,20]}