module.exports=[591965,a=>{"use strict";let b=(0,a.i(170106).default)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);a.s(["History",()=>b],591965)},192978,a=>a.a(async(b,c)=>{try{var d=a.i(187924),e=a.i(120267),f=b([e]);[e]=f.then?(await f)():f;let g=e.StyleSheet.create({page:{flexDirection:"column",backgroundColor:"#FFFFFF",padding:28,fontSize:11,fontFamily:"Helvetica"},logoSection:{marginBottom:16,alignItems:"flex-start"},logoContainer:{width:160,height:60},logo:{width:"100%",height:"100%",objectFit:"contain",objectPosition:"left center"},header:{flexDirection:"row",justifyContent:"space-between",marginBottom:24,paddingBottom:12,borderBottomWidth:2,borderBottomColor:"#000000"},headerLeft:{flexDirection:"column",maxWidth:280},headerRight:{flexDirection:"column",alignItems:"flex-end",justifyContent:"flex-start"},title:{fontSize:32,fontWeight:"bold",color:"#000000",marginBottom:8,letterSpacing:1},subtitle:{fontSize:10,color:"#374151",marginBottom:2,lineHeight:1.5},quoteNumber:{fontSize:20,fontWeight:"bold",color:"#000000",marginBottom:8},date:{fontSize:10,color:"#6B7280"},quoteMeta:{backgroundColor:"#F9FAFB",borderWidth:1,borderColor:"#E5E7EB",borderRadius:4,padding:10,minWidth:200},metaRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:4},metaLabel:{fontSize:10,color:"#6B7280",fontWeight:"bold"},metaValue:{fontSize:10,color:"#1F2937",marginLeft:16},billToSection:{marginTop:8,marginBottom:16,padding:12,backgroundColor:"#F9FAFB",borderRadius:4},sectionTitle:{fontSize:11,fontWeight:"bold",color:"#1F2937",marginBottom:8,textTransform:"uppercase",letterSpacing:.5},billToContent:{fontSize:11,color:"#374151",lineHeight:1.6},itemsTable:{marginTop:12,marginBottom:16,borderWidth:1,borderColor:"#E5E7EB",borderRadius:4},tableHeader:{flexDirection:"row",backgroundColor:"#1F2937",paddingVertical:10,paddingHorizontal:12},tableRow:{flexDirection:"row",borderBottomWidth:1,borderBottomColor:"#E5E7EB",paddingVertical:10,paddingHorizontal:12,backgroundColor:"#FFFFFF"},tableCell:{fontSize:10,color:"#374151",lineHeight:1.4},tableCellDescription:{flex:3},tableCellQuantity:{flex:1,textAlign:"center"},tableCellUnit:{flex:1,textAlign:"center"},tableCellPrice:{flex:1.5,textAlign:"right"},tableCellTotal:{flex:1.5,textAlign:"right",fontWeight:"bold",color:"#1F2937"},tableHeaderCell:{fontSize:10,fontWeight:"bold",color:"#FFFFFF",textTransform:"uppercase",letterSpacing:.8},totalsSection:{flexDirection:"row",justifyContent:"flex-end",marginTop:12,marginBottom:16},totalsContainer:{width:260,borderWidth:1,borderColor:"#E5E7EB",borderRadius:4,padding:12,backgroundColor:"#F9FAFB"},totalRow:{flexDirection:"row",justifyContent:"space-between",paddingVertical:4},totalLabel:{fontSize:11,color:"#6B7280"},totalValue:{fontSize:11,color:"#374151",fontWeight:"bold"},grandTotalRow:{flexDirection:"row",justifyContent:"space-between",paddingVertical:8,paddingTop:10,borderTopWidth:2,borderTopColor:"#1F2937",marginTop:6},grandTotalLabel:{fontSize:14,fontWeight:"bold",color:"#000000"},grandTotalValue:{fontSize:16,fontWeight:"bold",color:"#000000"},termsSection:{marginTop:6,marginBottom:12,padding:12,backgroundColor:"#F9FAFB",borderRadius:4,borderLeftWidth:3,borderLeftColor:"#1F2937"},termsContent:{fontSize:10,color:"#4B5563",lineHeight:1.6},signatureSection:{marginTop:32,flexDirection:"row",justifyContent:"space-between",gap:40},signatureBox:{flex:1,borderBottomWidth:1.5,borderBottomColor:"#1F2937",paddingBottom:8},signatureLabel:{fontSize:10,color:"#6B7280",marginBottom:32,fontWeight:"bold",textTransform:"uppercase",letterSpacing:.5}}),h=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a),i=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});a.s(["default",0,({quote:a,client:b,items:c,organization:f})=>(0,d.jsx)(e.Document,{children:(0,d.jsxs)(e.Page,{size:"A4",style:g.page,children:[f?.logoUrl?(0,d.jsx)(e.View,{style:g.logoSection,children:(0,d.jsx)(e.View,{style:g.logoContainer,children:(0,d.jsx)(e.Image,{style:g.logo,src:f.logoUrl})})}):null,(0,d.jsxs)(e.View,{style:g.header,children:[(0,d.jsxs)(e.View,{style:g.headerLeft,children:[(0,d.jsx)(e.Text,{style:g.title,children:"QUOTE"}),f?.name?(0,d.jsx)(e.Text,{style:g.subtitle,children:f.name}):null,f?.address?(0,d.jsx)(e.Text,{style:g.subtitle,children:f.address}):null,f?.phone?(0,d.jsxs)(e.Text,{style:g.subtitle,children:["Phone: ",f.phone]}):null,f?.email?(0,d.jsxs)(e.Text,{style:g.subtitle,children:["Email: ",f.email]}):null]}),(0,d.jsxs)(e.View,{style:g.headerRight,children:[(0,d.jsxs)(e.Text,{style:g.quoteNumber,children:["Quote ",a.quoteNumber||`#${a._id.slice(-6)}`]}),(0,d.jsxs)(e.View,{style:g.quoteMeta,children:[(0,d.jsxs)(e.View,{style:g.metaRow,children:[(0,d.jsx)(e.Text,{style:g.metaLabel,children:"Date:"}),(0,d.jsx)(e.Text,{style:g.metaValue,children:i(a._creationTime)})]}),a.validUntil?(0,d.jsxs)(e.View,{style:g.metaRow,children:[(0,d.jsx)(e.Text,{style:g.metaLabel,children:"Valid Until:"}),(0,d.jsx)(e.Text,{style:g.metaValue,children:i(a.validUntil)})]}):null]})]})]}),(0,d.jsxs)(e.View,{style:g.billToSection,wrap:!1,children:[(0,d.jsx)(e.Text,{style:g.sectionTitle,children:"Bill To:"}),(0,d.jsx)(e.View,{style:g.billToContent,children:b?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.Text,{children:b.companyName}),b.industry?(0,d.jsx)(e.Text,{children:b.industry}):null]}):(0,d.jsx)(e.Text,{children:"Client details unavailable"})})]}),(0,d.jsxs)(e.View,{style:g.itemsTable,wrap:!1,children:[(0,d.jsxs)(e.View,{style:g.tableHeader,children:[(0,d.jsx)(e.Text,{style:[g.tableHeaderCell,g.tableCellDescription],children:"Description"}),(0,d.jsx)(e.Text,{style:[g.tableHeaderCell,g.tableCellQuantity],children:"Qty"}),(0,d.jsx)(e.Text,{style:[g.tableHeaderCell,g.tableCellUnit],children:"Unit"}),(0,d.jsx)(e.Text,{style:[g.tableHeaderCell,g.tableCellPrice],children:"Rate"}),(0,d.jsx)(e.Text,{style:[g.tableHeaderCell,g.tableCellTotal],children:"Amount"})]}),c.map(a=>(0,d.jsxs)(e.View,{style:g.tableRow,children:[(0,d.jsx)(e.Text,{style:[g.tableCell,g.tableCellDescription],children:a.description}),(0,d.jsx)(e.Text,{style:[g.tableCell,g.tableCellQuantity],children:a.quantity}),(0,d.jsx)(e.Text,{style:[g.tableCell,g.tableCellUnit],children:a.unit}),(0,d.jsx)(e.Text,{style:[g.tableCell,g.tableCellPrice],children:h(a.rate)}),(0,d.jsx)(e.Text,{style:[g.tableCell,g.tableCellTotal],children:h(a.amount)})]},String(a._id)))]}),(0,d.jsx)(e.View,{style:g.totalsSection,wrap:!1,children:(0,d.jsxs)(e.View,{style:g.totalsContainer,children:[(0,d.jsxs)(e.View,{style:g.totalRow,children:[(0,d.jsx)(e.Text,{style:g.totalLabel,children:"Subtotal:"}),(0,d.jsx)(e.Text,{style:g.totalValue,children:h(a.subtotal)})]}),a.discountEnabled&&a.discountAmount?(0,d.jsxs)(e.View,{style:g.totalRow,children:[(0,d.jsx)(e.Text,{style:g.totalLabel,children:"Discount:"}),(0,d.jsx)(e.Text,{style:g.totalValue,children:"percentage"===a.discountType?`-${a.discountAmount}%`:`- ${h(a.discountAmount)}`})]}):null,a.taxEnabled&&a.taxAmount?(0,d.jsxs)(e.View,{style:g.totalRow,children:[(0,d.jsx)(e.Text,{style:g.totalLabel,children:"Tax:"}),(0,d.jsx)(e.Text,{style:g.totalValue,children:h(a.taxAmount)})]}):null,(0,d.jsxs)(e.View,{style:g.grandTotalRow,children:[(0,d.jsx)(e.Text,{style:g.grandTotalLabel,children:"Total:"}),(0,d.jsx)(e.Text,{style:g.grandTotalValue,children:h(a.total)})]})]})}),a.terms?(0,d.jsxs)(e.View,{style:g.termsSection,wrap:!1,children:[(0,d.jsx)(e.Text,{style:g.sectionTitle,children:"Terms & Conditions:"}),(0,d.jsx)(e.Text,{style:g.termsContent,children:a.terms})]}):null,a.clientMessage?(0,d.jsxs)(e.View,{style:g.termsSection,wrap:!1,children:[(0,d.jsx)(e.Text,{style:g.sectionTitle,children:"Message to Client:"}),(0,d.jsx)(e.Text,{style:g.termsContent,children:a.clientMessage})]}):null,(0,d.jsxs)(e.View,{style:g.signatureSection,wrap:!1,children:[(0,d.jsxs)(e.View,{style:{width:"45%"},children:[(0,d.jsx)(e.Text,{style:{fontSize:10,color:"#1F2937",marginBottom:5},children:"Signature:"}),(0,d.jsx)(e.Text,{style:{fontSize:8,color:"#FFFFFF"},children:"{{sign|1|*||client_signature}}"}),(0,d.jsx)(e.View,{style:{borderBottomWidth:1,borderBottomColor:"#1F2937",marginTop:20,width:"100%"}})]}),(0,d.jsxs)(e.View,{style:{width:"45%"},children:[(0,d.jsx)(e.Text,{style:{fontSize:10,color:"#1F2937",marginBottom:5},children:"Date:"}),(0,d.jsx)(e.Text,{style:{fontSize:8,color:"#FFFFFF"},children:"{{date|1|*||date_signed}}"}),(0,d.jsx)(e.View,{style:{borderBottomWidth:1,borderBottomColor:"#1F2937",marginTop:20,width:"100%"}})]})]})]})})]),c()}catch(a){c(a)}},!1),399686,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(877559),e=a.i(757215),f=a.i(468106);a.i(511241);var g=a.i(296373),h=a.i(130487),i=a.i(104720),j=a.i(452495);function k({isOpen:a,onClose:k,onConfirm:l}){let[m,n]=(0,c.useState)([]),o=(0,g.useQuery)(h.api.organizationDocuments.list),p=()=>{n([]),k()};return(0,b.jsx)(d.default,{isOpen:a,onClose:p,title:"Append Documents to Quote",size:"lg",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Optionally select documents to append to your quote PDF. Selected documents will be added after the quote content, or continue without attachments."}),void 0===o?(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mx-auto"}),(0,b.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mx-auto"})]})}):0===o.length?(0,b.jsxs)("div",{className:"text-center py-8 px-4 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg",children:[(0,b.jsx)(i.FileText,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-2 font-medium",children:"No documents available"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Upload documents in Settings â†’ Documents to use them in quotes"}),(0,b.jsx)("a",{href:"/organization/profile?tab=documents",target:"_blank",rel:"noopener noreferrer",children:(0,b.jsxs)(e.StyledButton,{intent:"outline",size:"sm",children:[(0,b.jsx)(j.ExternalLink,{className:"h-3 w-3 mr-2"}),"Go to Documents"]})})]}):(0,b.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:o.map(a=>{var c;return(0,b.jsxs)("label",{className:"flex items-center gap-3 p-3 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-muted/50 cursor-pointer transition-colors",children:[(0,b.jsx)(f.Checkbox,{checked:m.includes(a._id),onCheckedChange:()=>{var b;return b=a._id,void n(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])}}),(0,b.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded bg-blue-100 dark:bg-blue-900/30 shrink-0",children:(0,b.jsx)(i.FileText,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:a.name}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:new Date(a.uploadedAt).toLocaleDateString()}),a.fileSize&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{children:"â€¢"}),(0,b.jsx)("span",{children:(c=a.fileSize)?c<1024?`${c} B`:c<1048576?`${(c/1024).toFixed(1)} KB`:`${(c/1048576).toFixed(1)} MB`:""})]})]}),a.description&&(0,b.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 line-clamp-1",children:a.description})]})]},a._id)})}),(0,b.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:m.length>0?(0,b.jsxs)("span",{children:[m.length," document",1!==m.length&&"s"," ","selected"]}):(0,b.jsx)("span",{className:"text-gray-500 dark:text-gray-400 italic",children:"No documents selected"})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.StyledButton,{intent:"outline",onClick:p,children:"Cancel"}),(0,b.jsx)(e.StyledButton,{intent:"primary",onClick:()=>{l(m),n([]),k()},children:m.length>0?`Generate with ${m.length} document${1!==m.length?"s":""}`:"Generate PDF Only"})]})]})]})})}a.s(["DocumentSelectionModal",()=>k])},582633,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(165004),e=a.i(968177),f=a.i(700760);let g=({tags:a,setTags:d,editTag:e=!0,className:g})=>{let[h,i]=(0,c.useState)(""),[j,k]=(0,c.useState)(null),l=(0,c.useRef)(null),m=b=>{let c=h.trim();if(("Enter"===b.key||","===b.key)&&c){if(b.preventDefault(),null!==j){let b=[...a];b[j]=c,d(b),k(null)}else a.includes(c)||d([...a,c]);i("")}},n=()=>{if(null!==j){let b=[...a],c=h.trim();c?b[j]=c:b.splice(j,1),d(b),k(null)}i("")};return(0,c.useEffect)(()=>{l.current&&(l.current.style.width=`${h.length+1}ch`)},[h]),(0,b.jsxs)("div",{className:(0,f.cn)("flex flex-wrap w-full items-center gap-2 p-2 border-2 rounded-md focus-within:border-blue-500 dark:bg-neutral-800 bg-neutral-50",g),children:[a.map((c,f)=>(0,b.jsx)("div",{className:"relative",children:e&&j===f?(0,b.jsx)("input",{ref:l,type:"text",value:h,onChange:a=>i(a.target.value),onKeyDown:m,onBlur:n,className:"px-2 py-1 text-sm border dark:bg-neutral-950 bg-neutral-200 rounded outline-none",placeholder:"Edit tag...",style:{width:`${h.length+1.2}px`},autoFocus:!0}):(0,b.jsxs)("div",{onClick:()=>{e&&(i(a[f]),k(f),setTimeout(()=>l.current?.focus(),0))},className:"flex items-center gap-2 px-1 pl-2 py-1 text-sm font-medium text-white bg-blue-500 rounded cursor-pointer hover:bg-blue-600",children:[c,(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),d(a.filter(a=>a!==c)),null!==j&&k(null)},className:"text-primary px-1 focus:outline-none bg-primary-base rounded",children:"Ã—"})]})},c)),(0,b.jsx)("input",{type:"text",value:h,onChange:a=>i(a.target.value),onKeyDown:m,className:`flex-grow px-2 py-1 text-sm border-none outline-none  dark:bg-neutral-800 bg-neutral-50 rounded-md ${null!==j?"opacity-0":"opacity-100"}`,placeholder:"Add a tag..."})]})};var h=a.i(992258),i=a.i(633508),j=a.i(104720);function k({isOpen:a,onOpenChange:f,onConfirm:k,primaryContact:l,quoteNumber:m,documentVersion:n,children:o}){let[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(!1);(0,c.useEffect)(()=>{a&&(q([]),s(""))},[a]);let v=async()=>{if(l?.email&&!(p.filter(a=>!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)).length>0)){u(!0);try{let a=[{id:crypto.randomUUID(),name:`${l.firstName} ${l.lastName}`,email:l.email,signerType:"Signer"},...p.map(a=>({id:crypto.randomUUID(),name:a,email:a,signerType:"CC"}))];await k(a,r||void 0),f(!1)}catch(a){console.error("Send failed:",a)}finally{u(!1)}}},w=()=>{f(!1)},x=l?.email&&p.every(a=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a))&&!t;return(0,b.jsxs)(d.Popover,{open:a,onOpenChange:f,children:[(0,b.jsx)(d.PopoverTrigger,{asChild:!0,children:o}),(0,b.jsx)(d.PopoverContent,{align:"end",side:"top",sideOffset:12,className:"w-[550px] p-0 bg-white/95 dark:bg-gray-900/95 backdrop-blur-xl border border-gray-200 dark:border-gray-700 shadow-lg rounded-xl",children:(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.Mail,{className:"h-5 w-5 text-primary"}),(0,b.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Send Quote for Signature"})]}),(0,b.jsx)("button",{onClick:w,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors",children:(0,b.jsx)(i.X,{className:"h-4 w-4"})})]}),(0,b.jsxs)("div",{className:"px-6 py-4 space-y-4",children:[m&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(j.FileText,{className:"h-4 w-4 text-gray-400"}),(0,b.jsxs)(e.Badge,{variant:"outline",className:"text-xs",children:["Quote ",m,n&&` - v${n}`]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"To"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-lg",children:[(0,b.jsx)(h.Mail,{className:"h-4 w-4 text-gray-400"}),(0,b.jsx)("div",{className:"flex-1 text-sm text-gray-900 dark:text-white",children:l?.email?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("span",{className:"font-medium",children:[l.firstName," ",l.lastName]}),(0,b.jsxs)("span",{className:"text-gray-500 dark:text-gray-400",children:[" ","(",l.email,")"]})]}):(0,b.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"No primary contact email"})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"CC Recipients (optional)"}),(0,b.jsx)(g,{tags:p,setTags:q,editTag:!1,className:"min-h-[42px]"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Add email and press Enter"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Message (optional)"}),(0,b.jsx)("textarea",{placeholder:"Add a message to your email...",value:r,onChange:a=>s(a.target.value),className:"w-full min-h-[80px] px-3 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-primary/50 resize-y"})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[(0,b.jsxs)("button",{onClick:w,disabled:t,className:`group inline-flex items-center gap-2 text-sm font-semibold transition-all duration-200 px-4 py-2 rounded-lg ring-1 shadow-sm hover:shadow-md backdrop-blur-sm text-gray-600 hover:text-gray-700 bg-white hover:bg-gray-50 ring-gray-200 hover:ring-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:bg-gray-900 dark:hover:bg-gray-800 dark:ring-gray-700 dark:hover:ring-gray-600 ${t?"opacity-50 cursor-not-allowed":""}`,children:["Cancel",!t&&(0,b.jsx)("span",{"aria-hidden":"true",className:"group-hover:translate-x-1 transition-transform duration-200",children:"â†’"})]}),(0,b.jsxs)("button",{onClick:v,disabled:!x,className:`group inline-flex items-center gap-2 text-sm font-semibold transition-all duration-200 px-4 py-2 rounded-lg ring-1 shadow-sm hover:shadow-md backdrop-blur-sm text-primary hover:text-primary/80 bg-primary/10 hover:bg-primary/15 ring-primary/30 hover:ring-primary/40 ${!x?"opacity-50 cursor-not-allowed":""}`,children:[(0,b.jsx)(h.Mail,{className:"h-4 w-4"}),t?"Sending...":"Send",!t&&(0,b.jsx)("span",{"aria-hidden":"true",className:"group-hover:translate-x-1 transition-transform duration-200",children:"â†’"})]})]})]})})]})}a.s(["SendEmailPopover",()=>k],582633)},817683,a=>{"use strict";var b=a.i(187924),c=a.i(763544);function d({status:a,events:d}){return(0,b.jsx)(c.StatusProgressBar,{status:a,steps:[{id:"Sent",name:"Sent",order:1},{id:"Viewed",name:"Viewed",order:2},{id:"Signed",name:"Signed",order:3},{id:"Completed",name:"Completed",order:4}],events:d,failureStatuses:["Declined","Revoked","Expired"],successStatuses:["Completed"]})}a.s(["SignatureProgressBar",()=>d])},184464,a=>a.a(async(b,c)=>{try{var d=a.i(187924),e=a.i(50944);a.i(511241);var f=a.i(296373),g=a.i(130487),h=a.i(968177),i=a.i(592552),j=a.i(948217),k=a.i(539524),l=a.i(629353),m=a.i(104720),n=a.i(992258),o=a.i(284505),p=a.i(177156),q=a.i(790166),r=a.i(267900),s=a.i(321161),t=a.i(824569),u=a.i(296101),v=a.i(533441),w=a.i(591965),x=a.i(641710),y=a.i(911300),z=a.i(360031),A=a.i(120267),B=a.i(192978),C=a.i(572131),D=a.i(399686),E=a.i(582633),F=a.i(817683),G=a.i(216371),H=a.i(527415),I=a.i(763544),J=b([A,B]);[A,B]=J.then?(await J)():J;let L=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),M=a=>{switch(a){case"draft":return"Draft";case"sent":return"Sent";case"approved":return"Approved";case"declined":return"Declined";case"expired":return"Expired";default:return a}};function K(){var b,c;let J=(0,e.useRouter)(),K=(0,e.useParams)(),N=(0,l.useToast)(),O=(0,f.useConvex)(),P=K.quoteId,Q=(0,f.useQuery)(g.api.quotes.get,{id:P}),R=(0,f.useQuery)(g.api.clients.get,Q?.clientId?{id:Q.clientId}:"skip"),S=(0,f.useQuery)(g.api.projects.get,Q?.projectId?{id:Q.projectId}:"skip"),T=(0,f.useQuery)(g.api.quoteLineItems.listByQuote,{quoteId:P}),U=(0,f.useQuery)(g.api.organizations.get,{}),V=(0,f.useQuery)(g.api.documents.getLatest,Q?{documentType:"quote",documentId:Q._id}:"skip"),W=(0,f.useQuery)(g.api.documents.getAllVersions,Q?{documentType:"quote",documentId:Q._id}:"skip"),X=(0,f.useQuery)(g.api.clientContacts.getPrimaryContact,Q?.clientId?{clientId:Q.clientId}:"skip"),Y=(0,f.useQuery)(g.api.clientContacts.listByClient,Q?.clientId?{clientId:Q.clientId}:"skip"),Z=(0,f.useQuery)(g.api.clientProperties.getPrimaryProperty,Q?.clientId?{clientId:Q.clientId}:"skip"),$=(0,f.useQuery)(g.api.documents.getAllDocumentsWithSignatures,Q?{documentType:"quote",documentId:Q._id}:"skip"),_=(0,f.useMutation)(g.api.quotes.update),aa=(0,f.useMutation)(g.api.documents.generateUploadUrl),ab=(0,f.useMutation)(g.api.documents.create),ac=(0,f.useAction)(g.api.boldsignActions.sendDocumentForSignature),[ad,ae]=(0,C.useState)(!1),[af,ag]=(0,C.useState)({terms:"",clientMessage:"",validUntil:void 0}),[ah,ai]=(0,C.useState)(null),[aj,ak]=(0,C.useState)(!1),[al,am]=(0,C.useState)(!1),[an,ao]=(0,C.useState)(!1),ap=(0,C.useMemo)(()=>ah&&W?W.find(a=>a._id===ah):V,[ah,W,V]),aq=(0,f.useQuery)(g.api.documents.getDocumentUrl,ap?{id:ap._id}:"skip");(0,C.useEffect)(()=>{Q&&ag({terms:Q.terms||"",clientMessage:Q.clientMessage||"",validUntil:Q.validUntil})},[Q]);let ar=(0,C.useMemo)(()=>!!Q&&((af.terms||"")!==(Q.terms||"")||(af.clientMessage||"")!==(Q.clientMessage||"")||(af.validUntil||void 0)!==(Q.validUntil||void 0)),[af,Q]),as=async()=>{if(!Q)return;let a={};if((af.terms||"")!==(Q.terms||"")&&(a.terms=af.terms||void 0),(af.clientMessage||"")!==(Q.clientMessage||"")&&(a.clientMessage=af.clientMessage||void 0),(af.validUntil||void 0)!==(Q.validUntil||void 0)&&(a.validUntil=af.validUntil),0===Object.keys(a).length)return void ae(!1);try{await _({id:P,...a}),N.success("Quote Updated","Your changes have been saved."),ae(!1)}catch(b){let a=b instanceof Error?b.message:"Failed to save changes";N.error("Error",a)}},at=async a=>{try{await _({id:P,status:a}),N.success("Quote Updated",`Status changed to ${M(a)}`)}catch(b){let a=b instanceof Error?b.message:"Failed to update status";N.error("Error",a)}};if(void 0===Q)return(0,d.jsx)("div",{className:"min-h-screen flex-1 md:min-h-min",children:(0,d.jsxs)("div",{className:"relative bg-linear-to-br from-background via-muted/30 to-muted/60 dark:from-background dark:via-muted/20 dark:to-muted/40 min-h-screen rounded-xl",children:[(0,d.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_20%,rgba(120,119,198,0.08),transparent_50%)] rounded-xl"}),(0,d.jsx)("div",{className:"relative px-6 pt-8 pb-20",children:(0,d.jsxs)("div",{className:"animate-pulse space-y-8",children:[(0,d.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/3"}),(0,d.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-8",children:[(0,d.jsxs)("div",{className:"xl:col-span-3 space-y-8",children:[(0,d.jsx)("div",{className:"h-64 bg-gray-200 dark:bg-gray-700 rounded"}),(0,d.jsx)("div",{className:"h-96 bg-gray-200 dark:bg-gray-700 rounded"})]}),(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded"}),(0,d.jsx)("div",{className:"h-64 bg-gray-200 dark:bg-gray-700 rounded"})]})]})]})})]})});if(null===Q)return(0,d.jsx)("div",{className:"min-h-screen flex-1 md:min-h-min",children:(0,d.jsxs)("div",{className:"relative bg-linear-to-br from-background via-muted/30 to-muted/60 dark:from-background dark:via-muted/20 dark:to-muted/40 min-h-screen rounded-xl",children:[(0,d.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_20%,rgba(120,119,198,0.08),transparent_50%)] rounded-xl"}),(0,d.jsxs)("div",{className:"relative px-6 pt-8 pb-20 flex flex-col items-center justify-center h-96 space-y-4",children:[(0,d.jsx)("div",{className:"text-6xl",children:"ðŸ“„"}),(0,d.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Quote Not Found"}),(0,d.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-center",children:"The quote you're looking for doesn't exist or you don't have permission to view it."}),(0,d.jsx)(k.Button,{onClick:()=>J.push("/quotes"),children:"Back to Quotes"})]})]})});let au=(b=Q.status,c=Q.validUntil,"expired"===b||c&&c<Date.now()?"expired":b),av=async(b=[])=>{try{if(!Q||!T)return;let c=N.loading("Generating PDF",b.length>0?`Merging with ${b.length} document${1!==b.length?"s":""}â€¦`:"Rendering and uploadingâ€¦"),e=(0,d.jsx)(B.default,{quote:Q,client:R?{companyName:R.companyName,industry:R.industry}:void 0,items:T,organization:U?{name:U.name,logoUrl:U.logoUrl||void 0,address:U.address||void 0,phone:U.phone||void 0,email:U.email||void 0}:void 0}),f=await (0,A.pdf)(e).toBlob(),h=f;if(b.length>0)try{let{PDFDocument:c}=await a.A(561133),d=await O.query(g.api.organizationDocuments.getDocumentUrls,{ids:b});console.log("Fetched document URLs:",d);let e=await c.create(),i=await c.load(await f.arrayBuffer()),j=await e.copyPages(i,i.getPageIndices());for(let a of(j.forEach(a=>e.addPage(a)),console.log(`Added ${j.length} pages from quote PDF`),d))try{if(!a.url){console.warn(`No URL found for document ${a.id}`);continue}let b=await fetch(a.url);if(!b.ok){console.warn(`Failed to fetch PDF for document ${a.id}, status: ${b.status}`);continue}let d=await b.arrayBuffer(),f=await c.load(d),g=await e.copyPages(f,f.getPageIndices());g.forEach(a=>e.addPage(a)),console.log(`Successfully merged document ${a.id} (${g.length} pages)`)}catch(b){console.error(`Error processing document ${a.id}:`,b);continue}let k=await e.save();h=new Blob([k],{type:"application/pdf"}),console.log(`Merged PDF created with ${e.getPageCount()} total pages`)}catch(a){console.error("PDF merge error:",a),N.error("Merge failed","Failed to merge documents. Using quote only."),h=f}let i=await aa({}),j=await fetch(i,{method:"POST",headers:{"Content-Type":"application/pdf"},body:h});if(!j.ok)throw Error("Failed to upload PDF");let{storageId:k}=await j.json();await ab({documentType:"quote",documentId:Q._id,storageId:k}),N.removeToast(c),N.success("PDF generated",b.length>0?`Quote PDF with ${b.length} appended document${1!==b.length?"s":""} is ready.`:"Your quote PDF is ready.")}catch(b){console.error(b);let a=b instanceof Error?b.message:"Unknown error";N.error("PDF generation failed",a)}},aw=async()=>{if(aq)try{let a=await fetch(aq);if(!a.ok)throw Error("Failed to fetch PDF");let b=await a.blob(),c=URL.createObjectURL(b),d=document.createElement("a");d.href=c;let e=ap?.version?`-v${ap.version}`:"";d.download=`Quote-${Q?.quoteNumber||Q?._id.slice(-6)||"document"}${e}.pdf`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c)}catch(b){console.error(b);let a=b instanceof Error?b.message:"Unknown error";N.error("Download failed",a)}},ax=async(a,b)=>{if(!aq||!V)return void N.error("No PDF","Generate a PDF first");try{let c=a.filter(a=>"Signer"===a.signerType||"CC"===a.signerType);await ac({quoteId:P,documentId:V._id,recipients:c,documentUrl:aq,message:b}),N.success("Sent!","Quote sent for signature via BoldSign"),ao(!1)}catch(b){let a=b instanceof Error?b.message:"Unknown error";N.error("Send failed",a)}};return(0,d.jsxs)("div",{className:"min-h-screen flex-1 md:min-h-min",children:[(0,d.jsxs)("div",{className:"relative min-h-screen rounded-xl",children:[(0,d.jsx)("div",{className:"rounded-xl"}),(0,d.jsx)("div",{className:"relative px-6 pt-8 pb-20",children:(0,d.jsxs)("div",{className:"mx-auto",children:[(0,d.jsx)("div",{className:"mb-8",children:(0,d.jsxs)("div",{className:"flex items-center gap-8",children:[(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsx)("div",{className:"flex items-center justify-center w-12 h-12 rounded-lg bg-blue-100 dark:bg-blue-900/30 shrink-0",children:(0,d.jsx)(m.FileText,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:["Quote ",Q.quoteNumber||`#${Q._id.slice(-6)}`]}),(0,d.jsx)("p",{className:"text-muted-foreground text-sm",children:Q.title||S?.title||"Untitled Quote"})]})]}),(0,d.jsx)("div",{className:"flex-1",children:(0,d.jsx)(I.StatusProgressBar,{status:au,steps:[{id:"draft",name:"Draft",order:1},{id:"sent",name:"Sent",order:2},{id:"approved",name:"Approved",order:3}],events:[...Q._creationTime?[{type:"draft",timestamp:Q._creationTime}]:[],...Q.sentAt?[{type:"sent",timestamp:Q.sentAt}]:[],...Q.approvedAt?[{type:"approved",timestamp:Q.approvedAt}]:[],...Q.declinedAt?[{type:"declined",timestamp:Q.declinedAt}]:[]],failureStatuses:["declined","expired"],successStatuses:["approved"]})})]})}),(0,d.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-8",children:[(0,d.jsxs)("div",{className:"xl:col-span-3 space-y-8",children:[(0,d.jsx)("div",{className:"bg-card dark:bg-card backdrop-blur-md border border-border dark:border-border rounded-xl shadow-lg dark:shadow-black/50 ring-1 ring-border/30 dark:ring-border/50",children:(0,d.jsxs)(i.Card,{className:"bg-transparent border-none shadow-none ring-0",children:[(0,d.jsx)(i.CardHeader,{children:(0,d.jsxs)(i.CardTitle,{className:"flex items-center justify-between text-xl",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(r.Building2,{className:"h-5 w-5"}),"Client and Project Details"]}),(0,d.jsxs)("div",{className:"flex gap-2",children:[S&&(0,d.jsxs)(k.Button,{intent:"outline",size:"sm",onClick:()=>J.push(`/projects/${S._id}`),children:[(0,d.jsx)(u.FolderOpen,{className:"h-4 w-4 mr-1"}),"View Project"]}),R&&(0,d.jsxs)(k.Button,{intent:"outline",size:"sm",onClick:()=>J.push(`/clients/${R._id}`),children:[(0,d.jsx)(t.Edit,{className:"h-4 w-4 mr-1"}),"View Client"]})]})]})}),(0,d.jsx)(i.CardContent,{children:(0,d.jsxs)("div",{className:"space-y-8",children:[R?(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 pb-4",children:(0,d.jsxs)("div",{className:"flex items-start justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:R.companyName}),(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:R.industry||"No industry specified"}),R.companyDescription&&(0,d.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-2",children:R.companyDescription})]}),R.status&&(0,d.jsx)(h.Badge,{variant:"active"===R.status?"default":"outline",children:R.status})]})}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[(0,d.jsx)(n.Mail,{className:"h-4 w-4"}),"Primary Contact"]}),X?(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[X.firstName," ",X.lastName]}),X.jobTitle&&(0,d.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:X.jobTitle}),X.email&&(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:(0,d.jsx)("a",{href:`mailto:${X.email}`,className:"hover:text-blue-600 dark:hover:text-blue-400",children:X.email})}),X.phone&&(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:(0,d.jsx)("a",{href:`tel:${X.phone}`,className:"hover:text-blue-600 dark:hover:text-blue-400",children:X.phone})}),X.department&&(0,d.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:X.department})]}):(0,d.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No primary contact set"}),Y&&Y.length>1&&(0,d.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-3",children:["+",Y.length-1," additional contact",Y.length>2?"s":""]})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[(0,d.jsx)(r.Building2,{className:"h-4 w-4"}),"Primary Location"]}),Z?(0,d.jsxs)("div",{className:"space-y-2",children:[Z.propertyName&&(0,d.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:Z.propertyName}),(0,d.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,d.jsx)("p",{children:Z.streetAddress}),(0,d.jsxs)("p",{children:[Z.city,","," ",Z.state," ",Z.zipCode]}),Z.country&&(0,d.jsx)("p",{children:Z.country})]}),Z.propertyType&&(0,d.jsx)(h.Badge,{variant:"outline",className:"text-xs",children:Z.propertyType}),Z.squareFootage&&(0,d.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:[Z.squareFootage.toLocaleString()," ","sq ft"]})]}):(0,d.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No property address set"})]})]}),(R.category||R.clientSize||R.priorityLevel)&&(0,d.jsx)("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,d.jsxs)("div",{className:"flex flex-wrap gap-2",children:[R.category&&(0,d.jsx)(h.Badge,{variant:"secondary",className:"text-xs",children:R.category}),R.clientSize&&(0,d.jsx)(h.Badge,{variant:"secondary",className:"text-xs",children:R.clientSize}),R.priorityLevel&&(0,d.jsxs)(h.Badge,{variant:"urgent"===R.priorityLevel||"high"===R.priorityLevel?"destructive":"secondary",className:"text-xs",children:[R.priorityLevel," priority"]})]})})]}):(0,d.jsxs)("div",{className:"p-6 border-2 border-dashed border-gray-300 dark:border-white/20 rounded-lg text-center",children:[(0,d.jsx)(r.Building2,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,d.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Client information not available"})]}),S&&(0,d.jsxs)("div",{className:"pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,d.jsxs)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,d.jsx)(u.FolderOpen,{className:"h-4 w-4"}),"Associated Project"]}),S.status&&(0,d.jsx)(h.Badge,{variant:"in-progress"===S.status?"default":"completed"===S.status?"secondary":"outline",children:S.status})]}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-base font-medium text-gray-900 dark:text-white",children:S.title}),S.projectNumber&&(0,d.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:["Project #",S.projectNumber]})]}),S.description&&(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:S.description}),(0,d.jsxs)("div",{className:"flex flex-wrap gap-4 text-xs text-gray-500 dark:text-gray-500",children:[S.startDate&&(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)(x.Clock,{className:"h-3 w-3"}),(0,d.jsxs)("span",{children:["Start:"," ",new Date(S.startDate).toLocaleDateString()]})]}),S.endDate&&(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)(x.Clock,{className:"h-3 w-3"}),(0,d.jsxs)("span",{children:["End:"," ",new Date(S.endDate).toLocaleDateString()]})]}),S.projectType&&(0,d.jsx)(h.Badge,{variant:"outline",className:"text-xs",children:S.projectType})]})]})]})]})})]})}),$&&$.length>0&&(0,d.jsx)("div",{className:"bg-card dark:bg-card backdrop-blur-md border border-border dark:border-border rounded-xl shadow-lg dark:shadow-black/50 ring-1 ring-border/30 dark:ring-border/50",children:(0,d.jsxs)(i.Card,{className:"bg-transparent border-none shadow-none ring-0",children:[(0,d.jsx)(i.CardHeader,{children:(0,d.jsxs)(i.CardTitle,{className:"flex items-center gap-2 text-xl",children:[(0,d.jsx)(m.FileText,{className:"h-5 w-5"}),"Signature Status"]})}),(0,d.jsx)(i.CardContent,{children:(0,d.jsx)(G.default,{items:$.map(a=>{let b=a.boldsign.completedAt||a.boldsign.declinedAt||a.boldsign.revokedAt||a.boldsign.expiredAt||a.boldsign.signedAt||a.boldsign.viewedAt||a.boldsign.sentAt||a.generatedAt,c="Completed"===a.boldsign.status?"default":"Declined"===a.boldsign.status||"Revoked"===a.boldsign.status||"Expired"===a.boldsign.status?"destructive":"secondary",e=new Date(b).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return{title:`Version ${a.version} - ${a.boldsign.status} - ${e}`,content:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3 pb-3 border-b border-gray-200 dark:border-gray-700",children:[(0,d.jsxs)(h.Badge,{variant:"outline",className:"text-xs",children:["v",a.version]}),(0,d.jsx)(h.Badge,{variant:c,className:"text-xs",children:a.boldsign.status}),(0,d.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-auto",children:["Last updated: ",e]})]}),(0,d.jsx)(F.SignatureProgressBar,{status:a.boldsign.status,events:[{type:"Sent",timestamp:a.boldsign.sentAt},{type:"Viewed",timestamp:a.boldsign.viewedAt},{type:"Signed",timestamp:a.boldsign.signedAt},{type:a.boldsign.status,timestamp:a.boldsign.completedAt||a.boldsign.declinedAt||a.boldsign.revokedAt||a.boldsign.expiredAt}]}),(0,d.jsxs)("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,d.jsx)("p",{className:"font-medium mb-3 text-sm text-gray-900 dark:text-white",children:"Sent to:"}),(0,d.jsx)("ul",{className:"space-y-2",children:a.boldsign.sentTo.map((a,b)=>(0,d.jsxs)("li",{className:"flex items-center justify-between text-sm",children:[(0,d.jsxs)("span",{className:"text-gray-700 dark:text-gray-300",children:[(0,d.jsx)("span",{className:"font-medium",children:a.name})," ",(0,d.jsxs)("span",{className:"text-gray-500 dark:text-gray-400",children:["(",a.email,")"]})]}),(0,d.jsx)(h.Badge,{variant:"outline",className:"text-xs",children:a.signerType})]},b))})]})]})}})})})]})}),(0,d.jsx)("div",{className:"bg-card dark:bg-card backdrop-blur-md border border-border dark:border-border rounded-xl shadow-lg dark:shadow-black/50 ring-1 ring-border/30 dark:ring-border/50",children:(0,d.jsxs)(i.Card,{className:"bg-transparent border-none shadow-none ring-0",children:[(0,d.jsxs)(i.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,d.jsxs)(i.CardTitle,{className:"flex items-center gap-2 text-xl",children:[(0,d.jsx)(q.DollarSign,{className:"h-5 w-5"}),"Line Items"]}),(0,d.jsxs)(k.Button,{intent:"outline",size:"sm",onPress:()=>J.push(`/quotes/${P}/quoteLineEditor`),children:[(0,d.jsx)(s.Settings,{className:"h-4 w-4 mr-2"}),"Edit Line Items"]})]}),(0,d.jsx)(i.CardContent,{children:T&&T.length>0?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"overflow-hidden rounded-lg border",children:(0,d.jsxs)(j.Table,{children:[(0,d.jsx)(j.TableHeader,{className:"bg-muted",children:(0,d.jsxs)(j.TableRow,{children:[(0,d.jsx)(j.TableHead,{children:"Description"}),(0,d.jsx)(j.TableHead,{className:"text-center",children:"Qty"}),(0,d.jsx)(j.TableHead,{className:"text-center",children:"Unit"}),(0,d.jsx)(j.TableHead,{className:"text-right",children:"Rate"}),(0,d.jsx)(j.TableHead,{className:"text-right",children:"Amount"})]})}),(0,d.jsx)(j.TableBody,{children:T.map(a=>(0,d.jsxs)(j.TableRow,{children:[(0,d.jsx)(j.TableCell,{className:"font-medium",children:a.description}),(0,d.jsx)(j.TableCell,{className:"text-center",children:a.quantity}),(0,d.jsx)(j.TableCell,{className:"text-center",children:a.unit||"item"}),(0,d.jsx)(j.TableCell,{className:"text-right",children:L(a.rate)}),(0,d.jsx)(j.TableCell,{className:"text-right font-medium",children:L(a.amount)})]},a._id))})]})}),(0,d.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,d.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,d.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Subtotal:"}),(0,d.jsx)("span",{className:"font-medium",children:L(Q.subtotal)})]}),Q.discountEnabled&&Q.discountAmount&&(0,d.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,d.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Discount:"}),(0,d.jsxs)("span",{className:"font-medium text-red-600 dark:text-red-400",children:["-","percentage"===Q.discountType?`${Q.discountAmount}%`:L(Q.discountAmount)]})]}),Q.taxEnabled&&Q.taxAmount&&(0,d.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,d.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Tax:"}),(0,d.jsx)("span",{className:"font-medium",children:L(Q.taxAmount)})]}),(0,d.jsx)("div",{className:"border-t pt-2",children:(0,d.jsxs)("div",{className:"flex justify-between text-lg font-bold",children:[(0,d.jsx)("span",{children:"Total:"}),(0,d.jsx)("span",{children:L(Q.total)})]})})]})]}):(0,d.jsxs)("div",{className:"p-8 border-2 border-dashed border-gray-300 dark:border-white/20 rounded-lg text-center",children:[(0,d.jsx)(y.ClipboardList,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,d.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No line items added yet"})]})})]})}),(0,d.jsx)("div",{className:"bg-card dark:bg-card backdrop-blur-md border border-border dark:border-border rounded-xl shadow-lg dark:shadow-black/50 ring-1 ring-border/30 dark:ring-border/50",children:(0,d.jsxs)(i.Card,{className:"bg-transparent border-none shadow-none ring-0",children:[(0,d.jsx)(i.CardHeader,{children:(0,d.jsxs)(i.CardTitle,{className:"flex items-center justify-between text-xl",children:[(0,d.jsx)("span",{children:"Terms & Conditions"}),ad?(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(k.Button,{intent:"outline",size:"sm",onClick:()=>{Q&&ag({terms:Q.terms||"",clientMessage:Q.clientMessage||"",validUntil:Q.validUntil})},children:"Cancel"}),(0,d.jsx)(k.Button,{size:"sm",onClick:as,isDisabled:!ar,children:"Save"})]}):(0,d.jsx)(k.Button,{intent:"outline",size:"sm",onClick:()=>ae(!0),children:(0,d.jsx)(t.Edit,{className:"h-4 w-4"})})]})}),(0,d.jsx)(i.CardContent,{children:ad?(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("textarea",{className:"w-full min-h-[100px] px-3 py-2 bg-gray-50 dark:bg-white/5 border border-gray-300 dark:border-white/10 rounded-md text-gray-900 dark:text-white",placeholder:"Enter terms",value:af.terms,onChange:a=>ag(b=>({...b,terms:a.target.value}))}),(0,d.jsx)("textarea",{className:"w-full min-h-[80px] px-3 py-2 bg-gray-50 dark:bg-white/5 border border-gray-300 dark:border-white/10 rounded-md text-gray-900 dark:text-white",placeholder:"Message to client (optional)",value:af.clientMessage,onChange:a=>ag(b=>({...b,clientMessage:a.target.value}))})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:Q.terms||"No terms specified"}),Q.clientMessage&&(0,d.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-white/10",children:[(0,d.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Message to Client:"}),(0,d.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:Q.clientMessage})]})]})})]})})]}),(0,d.jsx)("div",{className:"xl:col-span-1",children:(0,d.jsxs)("div",{className:"sticky top-24 space-y-6",children:[(0,d.jsx)("div",{className:"bg-card dark:bg-card backdrop-blur-md border border-border dark:border-border rounded-xl shadow-lg dark:shadow-black/50 ring-1 ring-border/30 dark:ring-border/50",children:(0,d.jsxs)(i.Card,{className:"bg-transparent border-none shadow-none ring-0",children:[(0,d.jsx)(i.CardHeader,{children:(0,d.jsx)(i.CardTitle,{className:"text-lg",children:"Quote Details"})}),(0,d.jsxs)(i.CardContent,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Created:"}),(0,d.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:new Date(Q._creationTime).toLocaleDateString()})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Status:"}),(0,d.jsx)(h.Badge,{variant:(a=>{switch(a){case"approved":return"default";case"sent":return"secondary";case"declined":case"expired":return"destructive";default:return"outline"}})(au),children:M(au)})]}),(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Valid Until:"}),ad?(0,d.jsx)("input",{type:"date",className:"w-40 h-9 px-2 py-1 bg-gray-50 dark:bg-white/5 border border-gray-300 dark:border-white/10 rounded-md text-gray-900 dark:text-white",value:af.validUntil?new Date(af.validUntil).toISOString().slice(0,10):"",onChange:a=>ag(b=>({...b,validUntil:a.target.value?new Date(a.target.value).getTime():void 0}))}):(0,d.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:Q.validUntil?new Date(Q.validUntil).toLocaleDateString():"â€”"})]}),Q.sentAt&&(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sent:"}),(0,d.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:new Date(Q.sentAt).toLocaleDateString()})]}),Q.approvedAt&&(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Approved:"}),(0,d.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:new Date(Q.approvedAt).toLocaleDateString()})]})]})]})}),(0,d.jsx)("div",{className:"bg-card dark:bg-card backdrop-blur-md border border-border dark:border-border rounded-xl shadow-lg dark:shadow-black/50 ring-1 ring-border/30 dark:ring-border/50",children:(0,d.jsxs)(i.Card,{className:"bg-transparent border-none shadow-none ring-0",children:[(0,d.jsxs)(i.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(i.CardTitle,{className:"text-lg",children:"Generated PDF"}),ap&&(0,d.jsxs)(h.Badge,{variant:"outline",className:"text-xs",children:["v",ap.version]})]}),(0,d.jsx)(m.FileText,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})]}),(0,d.jsx)(i.CardContent,{children:(0,d.jsx)("div",{className:"text-center py-6",children:aq?(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("div",{className:"h-48 bg-gray-50 dark:bg-gray-800 rounded-lg border border-slate-200 dark:border-slate-700 overflow-hidden",children:(0,d.jsx)("iframe",{src:aq,className:"w-full h-full",title:"PDF Preview",style:{border:"none"}})}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)("a",{href:aq,target:"_blank",rel:"noopener noreferrer",className:"flex-1",children:(0,d.jsxs)(k.Button,{intent:"outline",size:"sm",className:"w-full",children:[(0,d.jsx)(p.Eye,{className:"h-4 w-4 mr-2"}),"View"]})}),(0,d.jsxs)(k.Button,{intent:"outline",size:"sm",className:"w-full flex-1",onClick:aw,children:[(0,d.jsx)(o.Download,{className:"h-4 w-4 mr-2"}),"Download"]})]}),W&&W.length>1&&(0,d.jsxs)("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700",children:[(0,d.jsxs)(k.Button,{intent:"outline",size:"sm",className:"w-full",onClick:()=>ak(!aj),children:[(0,d.jsx)(w.History,{className:"h-4 w-4 mr-2"}),aj?"Hide":"Show"," ","Version History (",W.length,")"]}),aj&&(0,d.jsx)("div",{className:"mt-3 space-y-2 max-h-48 overflow-y-auto",children:W.map(a=>(0,d.jsx)("button",{onClick:()=>{ai(a._id===V?._id?null:a._id)},className:`w-full text-left px-3 py-2 rounded-md text-sm transition-colors ${ah===a._id||!ah&&a._id===V?._id?"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800":"bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(x.Clock,{className:"h-3 w-3 text-gray-400"}),(0,d.jsxs)("span",{className:"font-medium",children:["Version ",a.version]}),a._id===V?._id&&(0,d.jsx)(h.Badge,{variant:"default",className:"text-xs",children:"Latest"})]}),(0,d.jsxs)("span",{className:"text-xs text-gray-500",children:[new Date(a.generatedAt).toLocaleDateString()," ",new Date(a.generatedAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})},a._id))})]})]}):(0,d.jsxs)("div",{children:[(0,d.jsx)(m.FileText,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"No PDF generated yet"}),(0,d.jsxs)(k.Button,{intent:"outline",size:"sm",onClick:()=>am(!0),children:[(0,d.jsx)(m.FileText,{className:"h-4 w-4 mr-2"}),"Generate PDF"]})]})})})]})})]})})]})]})}),(0,d.jsx)("div",{className:"px-6 mb-8",children:(0,d.jsx)(H.MentionSection,{entityType:"quote",entityId:P,entityName:Q?.title||`Quote #${Q?.quoteNumber||P.slice(-6)}`})})]}),(0,d.jsx)(z.StickyFormFooter,{hasUnsavedChanges:ar,isEditing:ad,buttons:[...(()=>{if(!Q)return null;switch(Q.status){case"draft":return(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(k.Button,{size:"sm",onClick:()=>at("sent"),children:"Send Quote"}),(0,d.jsxs)(k.Button,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>at("approved"),children:[(0,d.jsx)(v.Check,{className:"h-4 w-4 mr-1"})," Mark Approved"]})]});case"sent":return(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsxs)(k.Button,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>at("approved"),children:[(0,d.jsx)(v.Check,{className:"h-4 w-4 mr-1"})," Approve"]}),(0,d.jsx)(k.Button,{size:"sm",intent:"outline",onClick:()=>at("declined"),children:"Decline"}),(0,d.jsx)(k.Button,{size:"sm",intent:"outline",onClick:()=>at("draft"),children:"Revert to Draft"})]});case"approved":case"declined":return(0,d.jsx)(k.Button,{size:"sm",intent:"outline",onClick:()=>at("sent"),children:"Reopen (Sent)"});case"expired":return(0,d.jsx)(k.Button,{size:"sm",intent:"outline",onClick:()=>at("draft"),children:"Reopen (Draft)"});default:return null}})()?[{label:Q?.status==="draft"?"Mark as Sent":Q?.status==="sent"?"Approve":Q?.status==="approved"?"Reopen (Sent)":Q?.status==="expired"?"Reopen (Draft)":"Update Status",intent:Q?.status==="draft"?"primary":Q?.status==="sent"?"success":"outline",icon:Q?.status==="draft"?(0,d.jsx)(n.Mail,{className:"h-4 w-4"}):Q?.status==="sent"?(0,d.jsx)(v.Check,{className:"h-4 w-4"}):(0,d.jsx)(t.Edit,{className:"h-4 w-4"}),onClick:()=>{Q?.status==="draft"?at("sent"):Q?.status==="sent"?at("approved"):Q?.status==="approved"?at("sent"):Q?.status==="expired"&&at("draft")},position:"left"}]:[],{label:"Send to Client",intent:"outline",icon:(0,d.jsx)(n.Mail,{className:"h-4 w-4"}),onClick:()=>ao(!0),position:"right"},{label:"Generate PDF",intent:"outline",icon:(0,d.jsx)(m.FileText,{className:"h-4 w-4"}),onClick:()=>am(!0),position:"right"}],fullWidth:!0}),(0,d.jsx)(D.DocumentSelectionModal,{isOpen:al,onClose:()=>am(!1),onConfirm:a=>av(a)}),(0,d.jsx)(E.SendEmailPopover,{isOpen:an,onOpenChange:ao,onConfirm:ax,primaryContact:X,quoteNumber:Q?.quoteNumber||Q?._id.slice(-6),documentVersion:V?.version,children:(0,d.jsx)("div",{className:"fixed bottom-4 right-6 pointer-events-none"})})]})}a.s(["default",()=>K]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=_beb11878._.js.map