module.exports=[438236,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944);a.i(511241);var e=a.i(296373),f=a.i(130487),g=a.i(629353),h=a.i(968177),i=a.i(592552),j=a.i(948217),k=a.i(539524),l=a.i(757215),m=a.i(928503),n=a.i(468106),o=a.i(104720),p=a.i(400210),q=a.i(915618),r=a.i(170106);let s=(0,r.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var t=a.i(781560);let u=(0,r.default)("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var v=a.i(633508),w=a.i(177156),x=a.i(165004),y=a.i(883497),z=a.i(587532);let A=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(a);function B({onSelect:a,disabled:d=!1}){let[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)(""),l=(0,e.useQuery)(f.api.skus.list),n=c.default.useMemo(()=>{if(!l)return[];if(!i.trim())return l;let a=i.toLowerCase();return l.filter(b=>b.name.toLowerCase().includes(a)||b.unit.toLowerCase().includes(a))},[l,i]);return(0,b.jsxs)(x.Popover,{open:g,onOpenChange:h,children:[(0,b.jsx)(x.PopoverTrigger,{asChild:!0,children:(0,b.jsx)(k.Button,{intent:"outline",size:"sq-sm",isDisabled:d,"aria-label":"Select SKU",className:"shrink-0",children:(0,b.jsx)(y.Package,{className:"h-4 w-4"})})}),(0,b.jsx)(x.PopoverContent,{className:"w-[400px] p-0 bg-white dark:bg-gray-900 border border-border shadow-xl opacity-100",align:"start",style:{backgroundColor:"var(--background)",opacity:1},children:(0,b.jsxs)("div",{className:"flex flex-col bg-white dark:bg-gray-900",children:[(0,b.jsx)("div",{className:"p-3 border-b border-border bg-white dark:bg-gray-900",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(z.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(m.Input,{placeholder:"Search SKUs...",value:i,onChange:a=>j(a.target.value),className:"pl-9 bg-background dark:bg-background"})]})}),(0,b.jsx)("div",{className:"max-h-[300px] overflow-y-auto bg-white dark:bg-gray-900",children:void 0===l?(0,b.jsx)("div",{className:"p-4 text-center text-sm text-muted-foreground bg-white dark:bg-gray-900",children:"Loading SKUs..."}):0===n.length?(0,b.jsx)("div",{className:"p-4 text-center text-sm text-muted-foreground bg-white dark:bg-gray-900",children:i?"No SKUs found matching your search":"No SKUs available"}):(0,b.jsx)("div",{className:"divide-y divide-border bg-white dark:bg-gray-900",children:n.map(c=>{let d;return(0,b.jsx)("button",{onClick:()=>{a(c),h(!1),j("")},className:"w-full px-4 py-3 text-left bg-white dark:bg-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors focus:outline-none focus:bg-gray-100 dark:focus:bg-gray-800",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-sm text-foreground truncate",children:c.name}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:c.unit}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"â€¢"}),(0,b.jsx)("span",{className:"text-xs font-medium text-foreground",children:A(c.rate)}),void 0!==c.cost&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"â€¢"}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Cost: ",A(c.cost)]})]})]})]}),void 0!==c.cost&&c.rate>0&&(d=(c.rate-c.cost)/c.rate*100,(0,b.jsx)("div",{className:"shrink-0",children:(0,b.jsxs)("span",{className:`text-xs font-medium ${d>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[d.toFixed(1),"% margin"]})}))]})},c._id)})})})]})})]})}let C=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(a);function D(){let a=(0,d.useRouter)(),r=(0,d.useParams)(),t=(0,g.useToast)(),x=r.quoteId,y=(0,e.useQuery)(f.api.quotes.get,{id:x}),z=(0,e.useQuery)(f.api.clients.get,y?.clientId?{id:y.clientId}:"skip"),A=(0,e.useQuery)(f.api.projects.get,y?.projectId?{id:y.projectId}:"skip"),B=(0,e.useQuery)(f.api.quoteLineItems.listByQuote,{quoteId:x}),D=(0,e.useMutation)(f.api.quotes.update),F=(0,e.useMutation)(f.api.quoteLineItems.create),G=(0,e.useMutation)(f.api.quoteLineItems.update),H=(0,e.useMutation)(f.api.quoteLineItems.remove),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)({showQuantities:!0,showUnitPrices:!0,showLineItemTotals:!0,showTotals:!0});(0,c.useEffect)(()=>{y?.pdfSettings&&L({showQuantities:y.pdfSettings.showQuantities??!0,showUnitPrices:y.pdfSettings.showUnitPrices??!0,showLineItemTotals:y.pdfSettings.showLineItemTotals??!0,showTotals:y.pdfSettings.showTotals??!0})},[y]);let[M,N]=(0,c.useState)({enabled:!1,amount:0,type:"percentage"}),[O,P]=(0,c.useState)({enabled:!1,rate:0});(0,c.useEffect)(()=>{y&&(N({enabled:y.discountEnabled||!1,amount:y.discountAmount||0,type:y.discountType||"percentage"}),P({enabled:y.taxEnabled||!1,rate:y.taxRate||0}))},[y]);let Q=(0,c.useMemo)(()=>B?B.map(a=>({...a,isNew:!1})).sort((a,b)=>a.sortOrder-b.sortOrder):[],[B]),R=(0,c.useMemo)(()=>{if(0===Q.length)return{subtotal:0,discountAmount:0,afterDiscount:0,taxAmount:0,total:0,totalCosts:0,margin:0,marginPercentage:0};let a=Q.reduce((a,b)=>a+b.amount,0),b=Q.reduce((a,b)=>a+(b.cost?b.quantity*b.cost:0),0),c=M.enabled?"percentage"===M.type?a*M.amount/100:M.amount:0,d=a-c,e=O.enabled?d*O.rate/100:0,f=a-b;return{subtotal:a,discountAmount:c,afterDiscount:d,taxAmount:e,total:d+e,totalCosts:b,margin:f,marginPercentage:a>0?f/a*100:0}},[Q,M,O]);if(void 0===y)return(0,b.jsx)("div",{className:"relative px-6 pt-8 pb-20",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-8",children:[(0,b.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/3"}),(0,b.jsx)("div",{className:"h-96 bg-gray-200 dark:bg-gray-700 rounded"})]})});if(null===y)return(0,b.jsxs)("div",{className:"relative px-6 pt-8 pb-20 flex flex-col items-center justify-center h-96 space-y-4",children:[(0,b.jsx)("div",{className:"text-6xl",children:"ðŸ“„"}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Quote Not Found"}),(0,b.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-center",children:"The quote you're looking for doesn't exist or you don't have permission to view it."}),(0,b.jsx)(k.Button,{onClick:()=>a.push("/quotes"),children:"Back to Quotes"})]});let S=async()=>{let a=Q.length;try{await F({quoteId:x,description:"New Item",quantity:1,unit:"hour",rate:0,cost:0,sortOrder:a}),t.success("Line Item Added","You can now edit the line item details.")}catch(a){console.error("Failed to add line item:",a),t.error("Error","Failed to add line item. Please try again.")}},T=async(a,b)=>{try{await G({id:a,...b})}catch(a){console.error("Failed to update line item:",a),t.error("Error","Failed to update line item. Please try again.")}},U=async a=>{try{await H({id:a})}catch(a){console.error("Failed to delete line item:",a),t.error("Error","Failed to delete line item. Please try again.")}},V=async()=>{try{await D({id:x,subtotal:R.subtotal,total:R.total,discountEnabled:M.enabled,discountAmount:M.enabled?M.amount:void 0,discountType:M.enabled?M.type:void 0,taxEnabled:O.enabled,taxRate:O.enabled?O.rate:void 0,taxAmount:O.enabled?R.taxAmount:void 0,pdfSettings:{showQuantities:K.showQuantities,showUnitPrices:K.showUnitPrices,showLineItemTotals:K.showLineItemTotals,showTotals:K.showTotals}}),J(!1),t.success("Quote Saved","Quote has been successfully updated!"),a.push(`/quotes/${x}`)}catch(a){console.error("Failed to save quote:",a),t.error("Error","Failed to save quote. Please try again.")}},W=(a,b)=>{L(c=>({...c,[a]:b})),J(!0)};return(0,b.jsx)("div",{className:"relative px-6 pt-8 pb-20",children:(0,b.jsxs)("div",{className:"mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(k.Button,{intent:"outline",size:"sq-sm",onPress:()=>{I?confirm("You have unsaved changes. Are you sure you want to leave?")&&a.push(`/quotes/${x}`):a.push(`/quotes/${x}`)},"aria-label":"Go back",children:(0,b.jsx)(p.ArrowLeft,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"flex items-center justify-center w-12 h-12 rounded-lg bg-blue-100 dark:bg-blue-900/30",children:(0,b.jsx)(o.FileText,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Quote Line Editor"}),(0,b.jsx)(h.Badge,{variant:(a=>{switch(a){case"approved":return"default";case"sent":return"secondary";case"declined":case"expired":return"destructive";default:return"outline"}})(y.status),children:(a=>{switch(a){case"draft":return"Draft";case"sent":return"Sent";case"approved":return"Approved";case"declined":return"Declined";case"expired":return"Expired";default:return a}})(y.status)})]}),(0,b.jsxs)("p",{className:"text-muted-foreground text-sm mt-1",children:[y.quoteNumber||`#${y._id.slice(-6)}`," â€¢"," ",z?.companyName||"Unknown Client"," â€¢"," ",A?.title||"No Project"]})]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-3",children:(0,b.jsx)(l.StyledButton,{intent:"primary",size:"sm",onClick:V,disabled:!I,icon:(0,b.jsx)(s,{className:"h-4 w-4"}),label:"Save Changes"})})]}),I&&(0,b.jsxs)("div",{className:"mb-6 flex items-center gap-2.5 px-4 py-2.5 rounded-lg bg-yellow-100 dark:bg-yellow-900/40 border-2 border-yellow-400 dark:border-yellow-600 shrink-0 shadow-md animate-pulse",children:[(0,b.jsx)("div",{className:"w-2.5 h-2.5 bg-yellow-500 rounded-full shrink-0 animate-pulse"}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-yellow-900 dark:text-yellow-100 leading-tight",children:"Unsaved changes"}),(0,b.jsx)("p",{className:"text-xs font-medium text-yellow-800 dark:text-yellow-200 leading-tight",children:"Save or cancel your changes"})]})]}),(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsx)("div",{children:(0,b.jsx)("div",{className:"bg-card dark:bg-card backdrop-blur-md border border-border dark:border-border rounded-xl shadow-lg dark:shadow-black/50 ring-1 ring-border/30 dark:ring-border/50",children:(0,b.jsxs)(i.Card,{className:"bg-transparent border-none shadow-none ring-0",children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)(i.CardTitle,{className:"flex items-center gap-2 text-xl",children:[(0,b.jsx)(o.FileText,{className:"h-5 w-5"}),"Line Items Configuration"]})}),(0,b.jsxs)(i.CardContent,{children:[(0,b.jsx)("div",{className:"overflow-hidden rounded-lg border",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{className:"bg-muted sticky top-0 z-10",children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{className:"w-[30%]",children:"Description"}),(0,b.jsx)(j.TableHead,{className:"w-[10%] text-center",children:"Qty"}),(0,b.jsx)(j.TableHead,{className:"w-[10%] text-center",children:"Unit"}),(0,b.jsx)(j.TableHead,{className:"w-[12%] text-right",children:"Rate"}),(0,b.jsx)(j.TableHead,{className:"w-[12%] text-right",children:(0,b.jsxs)("div",{className:"flex flex-col items-end",children:[(0,b.jsx)("span",{children:"Cost"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground font-normal",children:"per unit"})]})}),(0,b.jsx)(j.TableHead,{className:"w-[12%] text-right",children:"Amount"}),(0,b.jsx)(j.TableHead,{className:"w-[10%] text-center",children:"Margin"}),(0,b.jsx)(j.TableHead,{className:"w-[4%]",children:"Actions"})]})}),(0,b.jsx)(j.TableBody,{children:Q.map(a=>(0,b.jsx)(E,{item:a,onUpdate:T,onDelete:()=>U(a._id)},a._id))})]})}),(0,b.jsx)("div",{className:"mt-6 pt-4 border-t border-border",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:0===Q.length?"No line items yet. Add your first item to get started.":`${Q.length} line item${1!==Q.length?"s":""} configured`}),(0,b.jsxs)(k.Button,{intent:"outline",size:"sm",onPress:S,children:[(0,b.jsx)(q.Plus,{className:"h-4 w-4 mr-2"}),"Add Line Item"]})]})})]})]})})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,b.jsx)("div",{className:"bg-card dark:bg-card backdrop-blur-md border border-border dark:border-border rounded-xl shadow-lg dark:shadow-black/50 ring-1 ring-border/30 dark:ring-border/50",children:(0,b.jsxs)(i.Card,{className:"bg-transparent border-none shadow-none ring-0",children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsxs)(i.CardTitle,{className:"flex items-center gap-2 text-lg",children:[(0,b.jsx)(w.Eye,{className:"h-5 w-5"}),"Client view"]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Adjust what your client will see on this quote. To change the default for all future quotes, visit the PDF Style."})]}),(0,b.jsx)(i.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(n.Checkbox,{id:"quantities",checked:K.showQuantities,onCheckedChange:a=>W("showQuantities",!!a)}),(0,b.jsx)("label",{htmlFor:"quantities",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Quantities"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(n.Checkbox,{id:"unitPrices",checked:K.showUnitPrices,onCheckedChange:a=>W("showUnitPrices",!!a)}),(0,b.jsx)("label",{htmlFor:"unitPrices",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Unit prices"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(n.Checkbox,{id:"lineItemTotals",checked:K.showLineItemTotals,onCheckedChange:a=>W("showLineItemTotals",!!a)}),(0,b.jsx)("label",{htmlFor:"lineItemTotals",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Line item totals"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(n.Checkbox,{id:"totals",checked:K.showTotals,onCheckedChange:a=>W("showTotals",!!a)}),(0,b.jsx)("label",{htmlFor:"totals",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Totals"})]})]})})]})}),(0,b.jsx)("div",{className:"bg-card dark:bg-card backdrop-blur-md border border-border dark:border-border rounded-xl shadow-lg dark:shadow-black/50 ring-1 ring-border/30 dark:ring-border/50",children:(0,b.jsxs)(i.Card,{className:"bg-transparent border-none shadow-none ring-0",children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)(i.CardTitle,{className:"flex items-center gap-2 text-lg",children:[(0,b.jsx)(u,{className:"h-5 w-5"}),"Quote Summary"]})}),(0,b.jsx)(i.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Subtotal:"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:C(R.subtotal)})]}),M.enabled?(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Discount:"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"flex items-center border border-gray-200 dark:border-gray-700 rounded-md overflow-hidden",children:[(0,b.jsx)(m.Input,{type:"number",value:M.amount,onChange:a=>{N(b=>({...b,amount:parseFloat(a.target.value)||0})),J(!0)},className:"w-20 text-right h-8 text-sm border-0 rounded-none focus:ring-0 focus:border-0",min:"0",step:"0.01"}),(0,b.jsxs)("select",{value:M.type,onChange:a=>{N(b=>({...b,type:a.target.value})),J(!0)},className:"text-sm border-0 bg-background px-2 py-2 h-8 rounded-none focus:ring-0 focus:border-0 cursor-pointer",children:[(0,b.jsx)("option",{value:"percentage",children:"%"}),(0,b.jsx)("option",{value:"fixed",children:"$"})]})]}),(0,b.jsxs)("span",{className:"text-sm font-medium text-red-600 dark:text-red-400 min-w-[60px] text-right",children:["-",C(R.discountAmount)]}),(0,b.jsx)(k.Button,{intent:"outline",size:"sq-sm",onPress:()=>{N({enabled:!1,amount:0,type:"percentage"}),J(!0)},"aria-label":"Remove discount",className:"text-red-500 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:(0,b.jsx)(v.X,{className:"h-3 w-3"})})]})]}):(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Discount:"}),(0,b.jsx)(k.Button,{intent:"outline",size:"sm",onPress:()=>{N({enabled:!0,amount:0,type:"percentage"}),J(!0)},className:"text-green-600 dark:text-green-400 border-green-200 dark:border-green-800 hover:bg-green-50 dark:hover:bg-green-900/20",children:"Add Discount"})]}),O.enabled?(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Tax:"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"flex items-center border border-gray-200 dark:border-gray-700 rounded-md overflow-hidden",children:[(0,b.jsx)(m.Input,{type:"number",value:O.rate,onChange:a=>{P(b=>({...b,rate:parseFloat(a.target.value)||0})),J(!0)},className:"w-20 text-right h-8 text-sm border-0 rounded-none focus:ring-0 focus:border-0",min:"0",step:"0.01",max:"100"}),(0,b.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400 px-2 py-2 h-8 flex items-center bg-gray-50 dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700",children:"%"})]}),(0,b.jsx)("span",{className:"text-sm font-medium min-w-[60px] text-right",children:C(R.taxAmount)}),(0,b.jsx)(k.Button,{intent:"outline",size:"sq-sm",onPress:()=>{P({enabled:!1,rate:0}),J(!0)},"aria-label":"Remove tax",className:"text-red-500 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:(0,b.jsx)(v.X,{className:"h-3 w-3"})})]})]}):(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Tax:"}),(0,b.jsx)(k.Button,{intent:"outline",size:"sm",onPress:()=>{P({enabled:!0,rate:0}),J(!0)},className:"text-green-600 dark:text-green-400 border-green-200 dark:border-green-800 hover:bg-green-50 dark:hover:bg-green-900/20",children:"Add Tax"})]}),(0,b.jsx)("div",{className:"border-t pt-3",children:(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-lg font-bold",children:"Total:"}),(0,b.jsx)("span",{className:"text-lg font-bold text-primary",children:C(R.total)})]})}),(0,b.jsxs)("div",{className:"border-t pt-3 space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Costs:"}),(0,b.jsx)("span",{className:"text-sm font-medium text-red-600 dark:text-red-400",children:C(R.totalCosts)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Estimated margin:"}),(0,b.jsxs)("span",{className:`text-sm font-medium ${R.margin>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[C(R.margin)," (",R.marginPercentage.toFixed(1),"%)"]})]})]})]})})]})})]})]})]})})}function E({item:a,onUpdate:d,onDelete:e}){let f,g,h,[i,l]=(0,c.useState)(a),[n,o]=(0,c.useState)(!1);c.default.useEffect(()=>{l(a)},[a]);let p=(a,b)=>{l(c=>({...c,[a]:b}))},q=async b=>{if(i[b]!==a[b]){o(!0);try{let c={[b]:i[b]};await d(a._id,c)}finally{o(!1)}}},r=async b=>{let c={description:b.name,unit:b.unit,rate:b.rate,cost:b.cost||0};l(a=>({...a,...c})),o(!0);try{await d(a._id,c)}finally{o(!1)}};return(0,b.jsxs)(j.TableRow,{className:`hover:bg-muted/30 ${n?"opacity-60":""}`,children:[(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(m.Input,{value:i.description,onChange:a=>p("description",a.target.value),onBlur:()=>q("description"),placeholder:"Enter description...",className:"flex-1",disabled:n}),(0,b.jsx)(B,{onSelect:r,disabled:n})]})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(m.Input,{type:"number",value:i.quantity,onChange:a=>p("quantity",parseInt(a.target.value)||0),onBlur:()=>q("quantity"),className:"w-full text-center",min:"0",disabled:n})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(m.Input,{value:i.unit,onChange:a=>p("unit",a.target.value),onBlur:()=>q("unit"),className:"w-full text-center",placeholder:"hour",disabled:n})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(m.Input,{type:"number",value:i.rate,onChange:a=>p("rate",parseFloat(a.target.value)||0),onBlur:()=>q("rate"),className:"w-full text-right",min:"0",step:"0.01",disabled:n})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(m.Input,{type:"number",value:i.cost||0,onChange:a=>p("cost",parseFloat(a.target.value)||0),onBlur:()=>q("cost"),className:"w-full text-right",min:"0",step:"0.01",placeholder:"0.00",disabled:n})}),(0,b.jsx)(j.TableCell,{className:"text-right font-medium",children:n?(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"Saving..."}):C(i.quantity*i.rate)}),(0,b.jsx)(j.TableCell,{className:"text-center",children:(f=i.quantity*i.rate,g=i.quantity*(i.cost||0),h=f>0?(f-g)/f*100:0,(0,b.jsxs)("span",{className:`text-xs font-medium ${h>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[h.toFixed(1),"%"]}))}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)("div",{className:"flex gap-1",children:(0,b.jsx)(k.Button,{intent:"outline",size:"sq-sm",onPress:e,"aria-label":"Delete",isDisabled:n,children:(0,b.jsx)(t.Trash2,{className:"h-3 w-3"})})})})]})}a.s(["default",()=>D],438236)}];

//# sourceMappingURL=apps_web_src_app_%28workspace%29_quotes_%5BquoteId%5D_quoteLineEditor_page_tsx_ab1ff8bf._.js.map