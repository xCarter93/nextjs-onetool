module.exports=[125633,a=>{"use strict";var b=a.i(187924),c=a.i(572131);a.i(511241);var d=a.i(296373),e=a.i(130487),f=a.i(928503),g=a.i(539524),h=a.i(592552),i=a.i(948217),j=a.i(968177),k=a.i(478788),l=a.i(452308),m=a.i(613749),n=a.i(50522),o=a.i(501199),p=a.i(641710),q=a.i(452495),r=a.i(781560),s=a.i(816201),t=a.i(741616),u=a.i(957064),v=a.i(50944),w=a.i(564361);a.i(501786);var x=a.i(757215),y=a.i(58812),z=a.i(272266),A=a.i(892984),B=a.i(700760);let C=[{id:"draft",name:"Draft",description:"Being prepared"},{id:"sent",name:"Sent",description:"Awaiting payment"},{id:"paid",name:"Paid",description:"Payment received"},{id:"overdue",name:"Overdue",description:"Past due date"},{id:"cancelled",name:"Cancelled",description:"Voided invoices"}],D=(a,b)=>{if("sent"===a&&b<Date.now())return"destructive";switch(a){case"paid":return"default";case"sent":return"secondary";case"cancelled":return"destructive";default:return"outline"}},E=(a,b)=>{if("sent"===a&&b<Date.now())return"Overdue";switch(a){case"draft":return"Draft";case"sent":return"Sent";case"paid":return"Paid";case"overdue":return"Overdue";case"cancelled":return"Cancelled";default:return a}},F=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),G=(a,c)=>[{accessorKey:"invoiceNumber",header:"Invoice",cell:({row:a})=>(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium text-foreground",children:a.original.invoiceNumber}),(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:a.original.projectName||"No project"})]})},{accessorKey:"clientName",header:"Client",cell:({row:a})=>(0,b.jsx)("span",{className:"text-foreground",children:a.original.clientName})},{accessorKey:"total",header:"Amount",cell:({row:a})=>(0,b.jsx)("span",{className:"text-foreground font-medium",children:F(a.original.total)})},{accessorKey:"status",header:"Status",cell:({row:a})=>(0,b.jsx)(j.Badge,{variant:D(a.original.status,a.original.dueDate),children:E(a.original.status,a.original.dueDate)})},{accessorKey:"issuedDate",header:"Issued",cell:({row:a})=>{let c=new Date(a.original.issuedDate);return(0,b.jsx)("span",{className:"text-foreground",children:c.toLocaleDateString()})}},{accessorKey:"dueDate",header:"Due Date",cell:({row:a})=>{let c=new Date(a.original.dueDate),d=c<new Date&&"paid"!==a.original.status;return(0,b.jsx)("span",{className:`text-foreground ${d?"text-destructive font-medium":""}`,children:c.toLocaleDateString()})}},{id:"actions",header:"",cell:({row:d})=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(g.Button,{intent:"outline",size:"sq-sm",onPress:()=>a.push(`/invoices/${d.original._id}`),"aria-label":`View invoice ${d.original.invoiceNumber}`,children:(0,b.jsx)(q.ExternalLink,{className:"size-4"})}),(0,b.jsx)(g.Button,{intent:"outline",size:"sq-sm",onPress:()=>c(d.original._id,d.original.invoiceNumber),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950","aria-label":`Delete invoice ${d.original.invoiceNumber}`,children:(0,b.jsx)(r.Trash2,{className:"size-4"})})]})}];function H(){let a=(0,v.useRouter)(),[j,r]=(0,c.useState)("table"),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(null),L=(0,d.useMutation)(e.api.invoices.remove),M=(0,d.useMutation)(e.api.invoices.update),[N,O]=(0,c.useState)([]),P=(0,d.useQuery)(e.api.invoices.list,{}),Q=(0,d.useQuery)(e.api.clients.list,{}),R=(0,d.useQuery)(e.api.projects.list,{}),S=c.default.useMemo(()=>P||[],[P]),T=c.default.useMemo(()=>Q||[],[Q]),U=c.default.useMemo(()=>R||[],[R]),V=c.default.useMemo(()=>S.map(a=>{let b=T.find(b=>b._id===a.clientId),c=U.find(b=>b._id===a.projectId);return{...a,clientName:b?.companyName||"Unknown Client",projectName:c?.title}}),[S,T,U]),[W,X]=c.default.useState([]),[Y,Z]=c.default.useState([]),[$,_]=c.default.useState(""),aa=c.default.useMemo(()=>{let a=new Map;return V.forEach(b=>{let c="sent"===b.status&&b.dueDate<Date.now()?"overdue":b.status;a.set(b._id,c)}),a},[V]);c.default.useEffect(()=>{V&&0!==V.length?O(V.map(a=>{let b="sent"===a.status&&a.dueDate<Date.now()?"overdue":a.status;return{id:a._id,name:a.projectName||"No project",column:b,status:b,clientName:a.clientName,total:a.total,invoiceNumber:a.invoiceNumber,dueDate:a.dueDate,issuedDate:a.issuedDate}})):O([])},[V]);let ab=(a,b)=>{K({id:a,name:b}),I(!0)},ac=async()=>{if(J)try{await L({id:J.id}),I(!1),K(null)}catch(a){console.error("Failed to delete invoice:",a)}},ad=c.default.useCallback(a=>{O(a);let b=a.find(a=>{let b=aa.get(a.id);return b&&b!==a.column});b&&("sent"===b.column||"overdue"===b.column?M({id:b.id,status:"sent"}).catch(a=>{console.error("Failed to update invoice status:",a)}):M({id:b.id,status:b.column}).catch(a=>{console.error("Failed to update invoice status:",a)}))},[aa,M]),ae=(0,k.useReactTable)({data:V,columns:G(a,ab),state:{sorting:W,columnFilters:Y,globalFilter:$,pagination:{pageIndex:0,pageSize:10}},onSortingChange:X,onColumnFiltersChange:Z,getCoreRowModel:(0,l.getCoreRowModel)(),getSortedRowModel:(0,l.getSortedRowModel)(),getFilteredRowModel:(0,l.getFilteredRowModel)(),getPaginationRowModel:(0,l.getPaginationRowModel)()});c.default.useEffect(()=>{ae.setPageSize(10)},[10,ae]);let af=c.default.useMemo(()=>V.filter(a=>"draft"===a.status||"sent"===a.status).length,[V]),ag=c.default.useMemo(()=>V.filter(a=>"paid"===a.status).reduce((a,b)=>a+b.total,0),[V]),ah=void 0===P||void 0===Q||void 0===R,ai=!ah&&0===V.length;return(0,b.jsxs)("div",{className:"relative p-6 space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-1.5 h-6 bg-linear-to-b from-primary to-primary/60 rounded-full"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Invoices"}),(0,b.jsx)("p",{className:"text-muted-foreground text-sm",children:"Manage your invoices and track payments"})]})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)(h.Card,{className:"group relative backdrop-blur-md overflow-hidden ring-1 ring-border/20 dark:ring-border/40",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-linear-to-br from-white/10 via-white/5 to-transparent dark:from-white/5 dark:via-white/2 dark:to-transparent rounded-2xl"}),(0,b.jsxs)(h.CardHeader,{className:"relative z-10",children:[(0,b.jsxs)(h.CardTitle,{className:"flex items-center gap-2 text-base",children:[(0,b.jsx)(o.Receipt,{className:"size-4"})," Total Invoices"]}),(0,b.jsx)(h.CardDescription,{children:"All invoices in your workspace"})]}),(0,b.jsx)(h.CardContent,{className:"relative z-10",children:(0,b.jsx)("div",{className:"text-3xl font-semibold",children:ah?(0,b.jsx)("div",{className:"h-9 w-12 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}):V.length})})]}),(0,b.jsxs)(h.Card,{className:"group relative backdrop-blur-md overflow-hidden ring-1 ring-border/20 dark:ring-border/40",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-linear-to-br from-white/10 via-white/5 to-transparent dark:from-white/5 dark:via-white/2 dark:to-transparent rounded-2xl"}),(0,b.jsxs)(h.CardHeader,{className:"relative z-10",children:[(0,b.jsxs)(h.CardTitle,{className:"flex items-center gap-2 text-base",children:[(0,b.jsx)(p.Clock,{className:"size-4"})," Open Invoices"]}),(0,b.jsx)(h.CardDescription,{children:"Unpaid and draft invoices"})]}),(0,b.jsx)(h.CardContent,{className:"relative z-10",children:(0,b.jsx)("div",{className:"text-3xl font-semibold",children:ah?(0,b.jsx)("div",{className:"h-9 w-12 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}):af})})]}),(0,b.jsxs)(h.Card,{className:"group relative backdrop-blur-md overflow-hidden ring-1 ring-border/20 dark:ring-border/40",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-linear-to-br from-white/10 via-white/5 to-transparent dark:from-white/5 dark:via-white/2 dark:to-transparent rounded-2xl"}),(0,b.jsxs)(h.CardHeader,{className:"relative z-10",children:[(0,b.jsxs)(h.CardTitle,{className:"flex items-center gap-2 text-base",children:[(0,b.jsx)(s.CheckCircle,{className:"size-4"})," Paid Value"]}),(0,b.jsx)(h.CardDescription,{children:"Total value of paid invoices"})]}),(0,b.jsx)(h.CardContent,{className:"relative z-10",children:(0,b.jsx)("div",{className:"text-3xl font-semibold",children:ah?(0,b.jsx)("div",{className:"h-9 w-20 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}):F(ag)})})]})]}),(0,b.jsxs)(h.Card,{className:"group relative backdrop-blur-md overflow-hidden ring-1 ring-border/20 dark:ring-border/40",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-linear-to-br from-white/10 via-white/5 to-transparent dark:from-white/5 dark:via-white/2 dark:to-transparent rounded-2xl"}),(0,b.jsxs)(h.CardHeader,{className:"relative z-10 flex flex-col gap-2 border-b",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.CardTitle,{children:"Invoices"}),(0,b.jsx)(h.CardDescription,{children:"Search, sort, and browse your invoices"})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,b.jsx)(f.Input,{placeholder:"Search invoices...",value:$,onChange:a=>_(a.target.value),className:"w-full md:w-96"}),(0,b.jsxs)(A.ButtonGroup,{children:[(0,b.jsxs)("button",{onClick:()=>r("table"),"aria-pressed":"table"===j,"aria-label":"Table view",className:(0,B.cn)("inline-flex items-center gap-2 font-semibold transition-all duration-200 text-xs px-3 py-1.5 ring-1 shadow-sm hover:shadow-md backdrop-blur-sm","table"===j?"text-primary hover:text-primary/80 bg-primary/10 hover:bg-primary/15 ring-primary/30 hover:ring-primary/40":"text-gray-600 hover:text-gray-700 bg-transparent hover:bg-gray-50 ring-transparent hover:ring-gray-200 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-800 dark:hover:ring-gray-700"),children:[(0,b.jsx)(t.TableProperties,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Table"})]}),(0,b.jsxs)("button",{onClick:()=>r("kanban"),"aria-pressed":"kanban"===j,"aria-label":"Kanban view",className:(0,B.cn)("inline-flex items-center gap-2 font-semibold transition-all duration-200 text-xs px-3 py-1.5 ring-1 shadow-sm hover:shadow-md backdrop-blur-sm","kanban"===j?"text-primary hover:text-primary/80 bg-primary/10 hover:bg-primary/15 ring-primary/30 hover:ring-primary/40":"text-gray-600 hover:text-gray-700 bg-transparent hover:bg-gray-50 ring-transparent hover:ring-gray-200 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-800 dark:hover:ring-gray-700"),children:[(0,b.jsx)(u.LayoutGrid,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Kanban"})]})]})]})]}),(0,b.jsx)(h.CardContent,{className:"relative z-10 px-0",children:ai?(0,b.jsxs)("div",{className:"px-6 py-12 text-center",children:[(0,b.jsx)("div",{className:"mx-auto mb-4 flex h-24 w-24 items-center justify-center rounded-full bg-muted",children:(0,b.jsx)(o.Receipt,{className:"h-12 w-12 text-muted-foreground"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No invoices yet"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-6 max-w-sm mx-auto",children:"Create invoices from approved quotes on the Projects page to get started tracking payments and revenue."})]}):"kanban"===j?(0,b.jsx)("div",{className:"px-2 py-6 h-[calc(100vh-28rem)]",children:(0,b.jsx)(z.KanbanProvider,{columns:C,data:N,onDataChange:ad,children:c=>{let d=N.filter(a=>a.column===c.id);return(0,b.jsxs)(z.KanbanBoard,{id:c.id,className:"bg-card/60 flex flex-col",children:[(0,b.jsxs)(z.KanbanHeader,{className:"flex items-center justify-between border-b bg-muted/30 shrink-0",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-sm text-foreground",children:c.name}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:c.description})]}),(0,b.jsx)(y.StyledBadge,{variant:"outline",children:d.length})]}),(0,b.jsx)(z.KanbanCards,{id:c.id,children:c=>(0,b.jsx)(z.KanbanCard,{id:c.id,name:c.name,column:c.column,children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-foreground",children:c.invoiceNumber}),(0,b.jsx)(y.StyledBadge,{variant:D(c.status,c.dueDate),children:E(c.status,c.dueDate)})]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:c.name}),(0,b.jsx)("div",{className:"flex items-center justify-between text-xs",children:(0,b.jsxs)("span",{className:"text-muted-foreground",children:["Client: ",c.clientName]})}),(0,b.jsxs)("div",{className:"flex flex-col gap-1 text-xs border-t border-border/50 pt-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Issued:"}),(0,b.jsx)("span",{className:"text-foreground",children:new Date(c.issuedDate).toLocaleDateString()})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Due:"}),(0,b.jsx)("span",{className:(0,B.cn)("text-foreground",c.dueDate<Date.now()&&"paid"!==c.status&&"text-red-600 font-medium"),children:new Date(c.dueDate).toLocaleDateString()})]})]}),(0,b.jsx)("div",{className:"flex items-center justify-between text-xs border-t border-border/50 pt-2",children:(0,b.jsx)("span",{className:"font-semibold text-foreground text-base",children:F(c.total)})}),(0,b.jsx)("div",{className:"pt-2 border-t border-border/50",children:(0,b.jsx)(x.StyledButton,{intent:"outline",size:"sm",icon:(0,b.jsx)(q.ExternalLink,{className:"h-3.5 w-3.5"}),label:"View Invoice",showArrow:!1,onClick:b=>{b?.stopPropagation(),a.push(`/invoices/${c.id}`)},className:"w-full justify-center"})})]})},c.id)})]},c.id)}})}):(0,b.jsxs)("div",{className:"px-6",children:[(0,b.jsx)("div",{className:"overflow-hidden rounded-lg border",children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{className:"bg-muted sticky top-0 z-10",children:ae.getHeaderGroups().map(a=>(0,b.jsx)(i.TableRow,{children:a.headers.map(a=>(0,b.jsx)(i.TableHead,{children:a.isPlaceholder?null:(0,k.flexRender)(a.column.columnDef.header,a.getContext())},a.id))},a.id))}),(0,b.jsx)(i.TableBody,{children:ah?Array.from({length:5}).map((c,d)=>(0,b.jsx)(i.TableRow,{children:Array.from({length:G(a,ab).length}).map((a,c)=>(0,b.jsx)(i.TableCell,{children:(0,b.jsx)("div",{className:"h-4 rounded bg-gray-200 dark:bg-gray-700 animate-pulse"})},c))},d)):ae.getRowModel().rows?.length?ae.getRowModel().rows.map(a=>(0,b.jsx)(i.TableRow,{"data-state":a.getIsSelected()&&"selected",children:a.getVisibleCells().map(a=>(0,b.jsx)(i.TableCell,{children:(0,k.flexRender)(a.column.columnDef.cell,a.getContext())},a.id))},a.id)):(0,b.jsx)(i.TableRow,{children:(0,b.jsx)(i.TableCell,{colSpan:G(a,ab).length,className:"h-24 text-center",children:"No invoices match your search."})})})]})}),(0,b.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,b.jsxs)("div",{className:"text-muted-foreground text-sm",children:[ae.getFilteredRowModel().rows.length," of ",V.length," ","invoices"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(g.Button,{intent:"outline",size:"sq-sm",onPress:()=>ae.previousPage(),isDisabled:!ae.getCanPreviousPage(),"aria-label":"Previous page",children:(0,b.jsx)(m.ChevronLeft,{className:"size-4"})}),(0,b.jsxs)("div",{className:"text-sm font-medium",children:["Page ",ae.getState().pagination?.pageIndex+1," of"," ",ae.getPageCount()]}),(0,b.jsx)(g.Button,{intent:"outline",size:"sq-sm",onPress:()=>ae.nextPage(),isDisabled:!ae.getCanNextPage(),"aria-label":"Next page",children:(0,b.jsx)(n.ChevronRight,{className:"size-4"})})]})]})]})})]}),J&&(0,b.jsx)(w.default,{isOpen:H,onClose:()=>I(!1),onConfirm:ac,title:"Delete Invoice",itemName:J.name,itemType:"Invoice"})]})}a.s(["default",()=>H])}];

//# sourceMappingURL=apps_web_src_app_%28workspace%29_invoices_page_tsx_c8907329._.js.map