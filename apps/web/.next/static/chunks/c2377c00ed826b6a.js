(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,407107,e=>{"use strict";var r=e.i(843476),t=e.i(271645),a=e.i(152088);let n=(0,t.forwardRef)(({label:e,onClick:t,intent:n="outline",size:s="md",icon:i,isLoading:o=!1,disabled:d=!1,type:l="button",className:c="",showArrow:g=!0,children:h,...x},m)=>{let y=(0,a.cn)("group inline-flex items-center gap-2 font-semibold transition-all duration-200 rounded-lg ring-1 shadow-sm hover:shadow-md backdrop-blur-sm",{sm:"text-xs px-3 py-1.5",md:"text-sm px-4 py-2",lg:"text-base px-5 py-2.5"}[s],{primary:"text-primary hover:text-primary/80 bg-primary/10 hover:bg-primary/15 ring-primary/30 hover:ring-primary/40",success:"text-green-600 hover:text-green-700 bg-green-50 hover:bg-green-100 ring-green-200 hover:ring-green-300 dark:text-green-400 dark:hover:text-green-300 dark:bg-green-950 dark:hover:bg-green-900 dark:ring-green-800 dark:hover:ring-green-700",destructive:"text-red-600 hover:text-red-700 bg-red-50 hover:bg-red-100 ring-red-200 hover:ring-red-300 dark:text-red-400 dark:hover:text-red-300 dark:bg-red-950 dark:hover:bg-red-900 dark:ring-red-800 dark:hover:ring-red-700",warning:"text-amber-600 hover:text-amber-700 bg-amber-50 hover:bg-amber-100 ring-amber-200 hover:ring-amber-300 dark:text-amber-400 dark:hover:text-amber-300 dark:bg-amber-950 dark:hover:bg-amber-900 dark:ring-amber-800 dark:hover:ring-amber-700",secondary:"text-gray-600 hover:text-gray-700 bg-gray-50 hover:bg-gray-100 ring-gray-200 hover:ring-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:bg-gray-800 dark:hover:bg-gray-700 dark:ring-gray-700 dark:hover:ring-gray-600",outline:"text-gray-600 hover:text-gray-700 bg-white hover:bg-gray-50 ring-gray-200 hover:ring-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:bg-gray-900 dark:hover:bg-gray-800 dark:ring-gray-700 dark:hover:ring-gray-600",plain:"text-gray-600 hover:text-gray-700 bg-transparent hover:bg-gray-50 ring-transparent hover:ring-gray-200 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:bg-gray-800 dark:hover:ring-gray-700"}[n]),p=d||o,u=o?"Loading...":e||h;return(0,r.jsxs)("button",{ref:m,onClick:t,disabled:p,type:l,className:(0,a.cn)(y,p&&"opacity-50 cursor-not-allowed",c),...x,children:[i&&(0,r.jsx)("span",{className:"shrink-0",children:i}),u,!o&&g&&(0,r.jsx)("span",{"aria-hidden":"true",className:"group-hover:translate-x-1 transition-transform duration-200",children:"â†’"})]})});n.displayName="StyledButton",e.s(["StyledButton",0,n])},930351,e=>{"use strict";var r=e.i(843476),t=e.i(271645),a=e.i(618566),n=e.i(407107);function s(){let e=(0,a.useSearchParams)(),s=(0,a.useParams)(),i=s?.token,o=e.get("session_id"),[d,l]=(0,t.useState)(null),[c,g]=(0,t.useState)(!0),[h,x]=(0,t.useState)(null),[m,y]=(0,t.useState)(!1),[p,u]=(0,t.useState)(!1),v=(0,t.useMemo)(()=>d?.invoice.total?`$${(d.invoice.total||0).toFixed(2)}`:"$0.00",[d]);(0,t.useEffect)(()=>{(async()=>{if(i)try{let e=await fetch(`/api/pay/invoice?token=${encodeURIComponent(i)}`,{cache:"no-store"}),r=await e.json();if(!e.ok)throw Error(r?.error||"Invoice not found");l(r),"paid"===r.invoice.status&&u(!0)}catch(e){x(e instanceof Error?e.message:"Unable to load invoice details.")}finally{g(!1)}})()},[i]),(0,t.useEffect)(()=>{(async()=>{if(o&&d&&!p&&i){y(!0);try{let e=await fetch("/api/pay/confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:i,sessionId:o})}),r=await e.json();e.ok&&"paid"===r.status?u(!0):e.ok||x(r?.error||"Payment confirmation failed.")}catch(e){x(e instanceof Error?e.message:"Payment confirmation failed.")}finally{y(!1)}}})()},[d,p,o,i]);let b=async()=>{x(null),g(!0);try{let e=await fetch("/api/pay/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:i})}),r=await e.json();if(!e.ok||!r?.url)throw Error(r?.error||"Unable to start checkout.");window.location.href=r.url}catch(e){x(e instanceof Error?e.message:"Unable to start checkout.")}finally{g(!1)}};return(0,r.jsx)("div",{className:"min-h-screen bg-slate-50 text-slate-900",children:(0,r.jsxs)("div",{className:"mx-auto max-w-2xl px-6 py-12",children:[(0,r.jsxs)("div",{className:"mb-8 text-center",children:[(0,r.jsx)("h1",{className:"text-3xl font-semibold tracking-tight text-slate-900",children:"Invoice Payment"}),(0,r.jsx)("p",{className:"text-sm text-slate-500",children:"Secure checkout powered by Stripe"})]}),(0,r.jsx)("div",{className:"rounded-xl border border-slate-200 bg-white p-6 shadow-sm",children:c?(0,r.jsx)("p",{className:"text-slate-500",children:"Loading invoice..."}):h?(0,r.jsx)("p",{className:"text-red-600",children:h}):d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Invoice"}),(0,r.jsx)("p",{className:"text-lg font-semibold text-slate-900",children:d.invoice.invoiceNumber??"Invoice"}),d.org?.name&&(0,r.jsx)("p",{className:"text-sm text-slate-500",children:d.org.name})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Amount Due"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:v})]})]}),(0,r.jsxs)("div",{className:"mt-6 space-y-2 text-sm text-slate-600",children:[(0,r.jsxs)("p",{children:["Status:"," ",(0,r.jsx)("span",{className:"font-medium text-slate-900",children:p||"paid"===d.invoice.status?"Paid":"Unpaid"})]}),d.invoice.dueDate&&(0,r.jsxs)("p",{children:["Due date:"," ",(0,r.jsx)("span",{className:"font-medium text-slate-900",children:new Date(d.invoice.dueDate).toLocaleDateString()})]})]}),(0,r.jsx)("div",{className:"mt-8",children:p?(0,r.jsx)("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 px-4 py-3 text-emerald-900",children:"Payment received. Thank you!"}):(0,r.jsx)(n.StyledButton,{size:"md",intent:"primary",className:"w-full justify-center",onClick:b,disabled:c||m,showArrow:!1,children:c?"Starting checkout...":"Pay securely with Stripe"})}),m&&(0,r.jsx)("p",{className:"mt-3 text-xs text-slate-500",children:"Confirming payment..."})]}):(0,r.jsx)("p",{className:"text-slate-600",children:"Invoice not found."})})]})})}e.s(["default",()=>s])}]);