(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,743608,e=>{"use strict";var t,a=e.i(843476),s=e.i(618566);e.i(250711);var r=e.i(982045),i=e.i(283164),n=e.i(361922),l=e.i(890042),o=e.i(271645);let c=o.forwardRef(function({title:e,titleId:t,...a},s){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},a),e?o.createElement("title",{id:t},e):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}),d=o.forwardRef(function({title:e,titleId:t,...a},s){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},a),e?o.createElement("title",{id:t},e):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"}))});var m=e.i(643531),u=e.i(49789);e.i(900175);var x=e.i(428055),h=e.i(829164),p=e.i(985902),g=e.i(610012),y=e.i(493843);let f=o.forwardRef(function({title:e,titleId:t,...a},s){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},a),e?o.createElement("title",{id:t},e):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 21h19.5m-18-18v18m10.5-18v18m6-13.5V21M6.75 6.75h.75m-.75 3h.75m-.75 3h.75m3-6h.75m-.75 3h.75m-.75 3h.75M6.75 21v-3.375c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21M3 3h12m-.75 4.5H21m-3.75 3.75h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Z"}))}),j=o.forwardRef(function({title:e,titleId:t,...a},s){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},a),e?o.createElement("title",{id:t},e):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))});var b=e.i(979259),N=e.i(460759),v=e.i(787906),w=e.i(427217);let k=o.forwardRef(function({title:e,titleId:t,...a},s){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},a),e?o.createElement("title",{id:t},e):null,o.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))});function C({clientId:e,properties:t,onChange:s}){let l=(0,n.useToast)(),c=(0,r.useMutation)(i.api.clientProperties.create),d=(0,r.useMutation)(i.api.clientProperties.update),m=(0,r.useMutation)(i.api.clientProperties.remove),[u,g]=(0,o.useState)(null),[y,b]=(0,o.useState)([]),[N,v]=(0,o.useState)(1),w=(0,o.useMemo)(()=>{let e=t.map(e=>({...e,isNew:!1}));return console.log("allProperties useMemo:",{savedItems:e.map(e=>({id:e._id,name:e.streetAddress,isNew:e.isNew})),localProperties:y.map(e=>({id:e._id,name:e.streetAddress,isNew:e.isNew}))}),[...e,...y]},[t,y]),k=async t=>{if(console.log("handleSaveProperty called with:",{propertyId:t._id,propertyIdType:typeof t._id,isNew:t.isNew}),t.isNew||"string"==typeof t._id&&t._id.startsWith("temp-")){console.log("Creating new property...");try{await c({clientId:e,streetAddress:t.streetAddress||"Address Required",city:t.city||"City Required",state:t.state||"State Required",zipCode:t.zipCode||"ZIP Required",country:t.country,description:t.description,isPrimary:t.isPrimary}),b(e=>e.filter(e=>e._id!==t._id)),g(null),s?.(),l.success("Property Saved","Property has been successfully saved!")}catch(e){console.error("Failed to save property:",e),l.error("Error","Failed to save property. Please try again.")}}else{console.log("Updating existing property with ID:",t._id);try{await d({id:t._id,streetAddress:t.streetAddress,city:t.city,state:t.state,zipCode:t.zipCode,country:t.country,description:t.description,isPrimary:t.isPrimary}),g(null),s?.(),l.success("Property Updated","Property has been successfully updated!")}catch(e){console.error("Failed to save property:",e),l.error("Error","Failed to save property. Please try again.")}}},C=async e=>{if("string"==typeof e&&e.startsWith("temp-"))b(t=>t.filter(t=>t._id!==e)),u===e&&g(null),l.success("Property Deleted","Unsaved property has been removed.");else try{await m({id:e}),s?.(),l.success("Property Deleted","Property has been successfully deleted.")}catch(e){console.error("Failed to delete property:",e),l.error("Error","Failed to delete property. Please try again.")}};return(0,a.jsxs)(x.StyledCard,{children:[(0,a.jsxs)(x.StyledCardHeader,{className:"flex flex-row items-center justify-between pb-6",children:[(0,a.jsx)(x.StyledCardTitle,{className:"text-xl",children:"Properties"}),(0,a.jsxs)(p.Button,{intent:"outline",size:"sm",onPress:()=>{let e=`temp-${N}`,t={_id:e,streetAddress:"",city:"",state:"",zipCode:"",country:"",description:"",isPrimary:!1,isNew:!0};b(e=>[...e,t]),g(e),v(e=>e+1)},children:[(0,a.jsx)(j,{className:"h-4 w-4 mr-2"}),"New Property"]})]}),(0,a.jsx)(x.StyledCardContent,{children:w&&w.length>0?(0,a.jsx)("div",{className:"overflow-hidden rounded-lg border",children:(0,a.jsxs)(h.Table,{children:[(0,a.jsx)(h.TableHeader,{children:(0,a.jsxs)(h.TableRow,{children:[(0,a.jsx)(h.TableHead,{className:"w-[40%]",children:"Address"}),(0,a.jsx)(h.TableHead,{className:"w-[20%]",children:"City"}),(0,a.jsx)(h.TableHead,{className:"w-[15%]",children:"State"}),(0,a.jsx)(h.TableHead,{className:"w-[15%]",children:"ZIP"}),(0,a.jsx)(h.TableHead,{className:"w-[5%]",children:"Primary"}),(0,a.jsx)(h.TableHead,{className:"w-[5%]",children:"Actions"})]})}),(0,a.jsx)(h.TableBody,{children:w.map(e=>(0,a.jsx)(T,{property:e,isEditing:u===e._id,onEdit:()=>{var t;console.log("handleEditProperty called with:",{id:t=e._id,idType:typeof t,property:w.find(e=>e._id===t)}),g(t)},onSave:k,onCancel:()=>g(null),onDelete:()=>C(e._id)},e._id))})]})}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center mb-4",children:(0,a.jsx)(f,{className:"h-8 w-8 text-gray-400"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No properties"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"No properties have been added for this client yet."})]})})]})}function T({property:e,isEditing:t,onEdit:s,onSave:r,onCancel:i,onDelete:n}){let[l,c]=(0,o.useState)(e);o.default.useEffect(()=>{t&&c(e)},[t,e]);let d=(e,t)=>{c(a=>({...a,[e]:t}))};return t?(0,a.jsxs)(h.TableRow,{className:`bg-blue-50/50 dark:bg-blue-900/10 border-l-4 border-l-blue-500 ${e.isNew?"bg-yellow-50/50 dark:bg-yellow-900/10":""}`,children:[(0,a.jsx)(h.TableCell,{children:(0,a.jsx)(g.Input,{value:l.streetAddress,onChange:e=>d("streetAddress",e.target.value),placeholder:"Street address...",className:"w-full"})}),(0,a.jsx)(h.TableCell,{children:(0,a.jsx)(g.Input,{value:l.city,onChange:e=>d("city",e.target.value),placeholder:"City...",className:"w-full"})}),(0,a.jsx)(h.TableCell,{children:(0,a.jsx)(g.Input,{value:l.state,onChange:e=>d("state",e.target.value),placeholder:"State...",className:"w-full"})}),(0,a.jsx)(h.TableCell,{children:(0,a.jsx)(g.Input,{value:l.zipCode,onChange:e=>d("zipCode",e.target.value),placeholder:"ZIP...",className:"w-full"})}),(0,a.jsx)(h.TableCell,{children:(0,a.jsx)(y.Checkbox,{checked:l.isPrimary,onCheckedChange:e=>d("isPrimary",!!e)})}),(0,a.jsx)(h.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(p.Button,{intent:"outline",size:"sq-sm",onPress:()=>{console.log("PropertyRow handleSave called with:",{propertyId:l._id,propertyIdType:typeof l._id,isNew:l.isNew,originalPropertyId:e._id,originalPropertyIdType:typeof e._id}),r(l)},"aria-label":"Save",children:(0,a.jsx)(v.CheckIcon,{className:"h-3 w-3"})}),(0,a.jsx)(p.Button,{intent:"outline",size:"sq-sm",onPress:i,"aria-label":"Cancel",children:(0,a.jsx)(w.XMarkIcon,{className:"h-3 w-3"})})]})})]}):(0,a.jsxs)(h.TableRow,{className:`hover:bg-muted/50 ${e.isNew?"bg-yellow-50/30 dark:bg-yellow-900/20 border-l-4 border-l-yellow-400":""}`,children:[(0,a.jsx)(h.TableCell,{className:"font-medium",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:e.streetAddress}),e.isNew&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300",children:"Unsaved"})]})}),(0,a.jsx)(h.TableCell,{children:e.city}),(0,a.jsx)(h.TableCell,{children:e.state}),(0,a.jsx)(h.TableCell,{children:e.zipCode}),(0,a.jsx)(h.TableCell,{children:e.isPrimary&&(0,a.jsx)(k,{className:"h-4 w-4 text-yellow-400"})}),(0,a.jsx)(h.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(p.Button,{intent:"outline",size:"sq-sm",onPress:s,"aria-label":"Edit",children:(0,a.jsx)(b.PencilIcon,{className:"h-3 w-3"})}),(0,a.jsx)(p.Button,{intent:"outline",size:"sq-sm",onPress:n,"aria-label":"Delete",children:(0,a.jsx)(N.TrashIcon,{className:"h-3 w-3"})})]})})]})}function S({clientId:e,contacts:t,onChange:s}){let l=(0,n.useToast)(),c=(0,r.useMutation)(i.api.clientContacts.create),m=(0,r.useMutation)(i.api.clientContacts.update),u=(0,r.useMutation)(i.api.clientContacts.remove),[g,y]=(0,o.useState)(null),[f,b]=(0,o.useState)([]),[N,v]=(0,o.useState)(1),w=(0,o.useMemo)(()=>{let e=t.map(e=>({...e,isNew:!1}));return console.log("allContacts useMemo:",{savedItems:e.map(e=>({id:e._id,name:`${e.firstName} ${e.lastName}`,isNew:e.isNew})),localContacts:f.map(e=>({id:e._id,name:`${e.firstName} ${e.lastName}`,isNew:e.isNew}))}),[...e,...f]},[t,f]),k=async t=>{if(console.log("handleSaveContact called with:",{contactId:t._id,contactIdType:typeof t._id,isNew:t.isNew,contactName:`${t.firstName} ${t.lastName}`}),t.isNew||"string"==typeof t._id&&t._id.startsWith("temp-")){console.log("Creating new contact...");try{await c({clientId:e,firstName:t.firstName||"First Name Required",lastName:t.lastName||"Last Name Required",email:t.email,phone:t.phone,jobTitle:t.jobTitle,role:t.role,isPrimary:t.isPrimary}),b(e=>e.filter(e=>e._id!==t._id)),y(null),s?.(),l.success("Contact Saved","Contact has been successfully saved!")}catch(e){console.error("Failed to save contact:",e),l.error("Error","Failed to save contact. Please try again.")}}else{console.log("Updating existing contact with ID:",t._id);try{await m({id:t._id,firstName:t.firstName,lastName:t.lastName,email:t.email,phone:t.phone,jobTitle:t.jobTitle,role:t.role,isPrimary:t.isPrimary}),y(null),s?.(),l.success("Contact Updated","Contact has been successfully updated!")}catch(e){console.error("Failed to save contact:",e),l.error("Error","Failed to save contact. Please try again.")}}},C=async e=>{if("string"==typeof e&&e.startsWith("temp-"))b(t=>t.filter(t=>t._id!==e)),g===e&&y(null),l.success("Contact Deleted","Unsaved contact has been removed.");else try{await u({id:e}),s?.(),l.success("Contact Deleted","Contact has been successfully deleted.")}catch(e){console.error("Failed to delete contact:",e),l.error("Error","Failed to delete contact. Please try again.")}};return(0,a.jsxs)(x.StyledCard,{children:[(0,a.jsxs)(x.StyledCardHeader,{className:"flex flex-row items-center justify-between pb-6",children:[(0,a.jsx)(x.StyledCardTitle,{className:"text-xl",children:"Contacts"}),(0,a.jsxs)(p.Button,{intent:"outline",size:"sm",onPress:()=>{let e=`temp-${N}`,t={_id:e,firstName:"",lastName:"",email:"",phone:"",jobTitle:"",role:"",isPrimary:!1,isNew:!0};b(e=>[...e,t]),y(e),v(e=>e+1)},children:[(0,a.jsx)(j,{className:"h-4 w-4 mr-2"}),"New Contact"]})]}),(0,a.jsx)(x.StyledCardContent,{children:w&&w.length>0?(0,a.jsx)("div",{className:"overflow-hidden rounded-lg border",children:(0,a.jsxs)(h.Table,{children:[(0,a.jsx)(h.TableHeader,{children:(0,a.jsxs)(h.TableRow,{children:[(0,a.jsx)(h.TableHead,{className:"w-[25%]",children:"Name"}),(0,a.jsx)(h.TableHead,{className:"w-[25%]",children:"Job Title"}),(0,a.jsx)(h.TableHead,{className:"w-[20%]",children:"Phone"}),(0,a.jsx)(h.TableHead,{className:"w-[20%]",children:"Email"}),(0,a.jsx)(h.TableHead,{className:"w-[5%]",children:"Primary"}),(0,a.jsx)(h.TableHead,{className:"w-[5%]",children:"Actions"})]})}),(0,a.jsx)(h.TableBody,{children:w.map(e=>(0,a.jsx)(E,{contact:e,isEditing:g===e._id,onEdit:()=>{var t;console.log("handleEditContact called with:",{id:t=e._id,idType:typeof t,contact:w.find(e=>e._id===t)}),y(t)},onSave:k,onCancel:()=>y(null),onDelete:()=>C(e._id)},e._id))})]})}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center mb-4",children:(0,a.jsx)(d,{className:"h-8 w-8 text-gray-400"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No contacts"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"No contacts have been added for this client yet."})]})})]})}function E({contact:e,isEditing:t,onEdit:s,onSave:r,onCancel:i,onDelete:n}){let[l,c]=(0,o.useState)(e);o.default.useEffect(()=>{t&&c(e)},[t,e]);let d=(e,t)=>{c(a=>({...a,[e]:t}))};return t?(0,a.jsxs)(h.TableRow,{className:`bg-blue-50/50 dark:bg-blue-900/10 border-l-4 border-l-blue-500 ${e.isNew?"bg-yellow-50/50 dark:bg-yellow-900/10":""}`,children:[(0,a.jsx)(h.TableCell,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.Input,{value:l.firstName,onChange:e=>d("firstName",e.target.value),placeholder:"First name...",className:"w-full"}),(0,a.jsx)(g.Input,{value:l.lastName,onChange:e=>d("lastName",e.target.value),placeholder:"Last name...",className:"w-full"})]})}),(0,a.jsx)(h.TableCell,{children:(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)(g.Input,{value:l.jobTitle||"",onChange:e=>d("jobTitle",e.target.value),placeholder:"Job title...",className:"w-full"})})}),(0,a.jsx)(h.TableCell,{children:(0,a.jsx)(g.Input,{value:l.phone||"",onChange:e=>d("phone",e.target.value),placeholder:"Phone...",className:"w-full"})}),(0,a.jsx)(h.TableCell,{children:(0,a.jsx)(g.Input,{value:l.email||"",onChange:e=>d("email",e.target.value),placeholder:"Email...",className:"w-full",type:"email"})}),(0,a.jsx)(h.TableCell,{children:(0,a.jsx)(y.Checkbox,{checked:l.isPrimary,onCheckedChange:e=>d("isPrimary",!!e)})}),(0,a.jsx)(h.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(p.Button,{intent:"outline",size:"sq-sm",onPress:()=>{console.log("ContactRow handleSave called with:",{contactId:l._id,contactIdType:typeof l._id,isNew:l.isNew,originalContactId:e._id,originalContactIdType:typeof e._id}),r(l)},"aria-label":"Save",children:(0,a.jsx)(v.CheckIcon,{className:"h-3 w-3"})}),(0,a.jsx)(p.Button,{intent:"outline",size:"sq-sm",onPress:i,"aria-label":"Cancel",children:(0,a.jsx)(w.XMarkIcon,{className:"h-3 w-3"})})]})})]}):(0,a.jsxs)(h.TableRow,{className:`hover:bg-muted/50 ${e.isNew?"bg-yellow-50/30 dark:bg-yellow-900/20 border-l-4 border-l-yellow-400":""}`,children:[(0,a.jsx)(h.TableCell,{className:"font-medium",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{children:[e.firstName," ",e.lastName]}),e.isNew&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300",children:"Unsaved"})]})}),(0,a.jsx)(h.TableCell,{children:(0,a.jsx)("div",{children:e.jobTitle&&(0,a.jsx)("p",{className:"font-medium",children:e.jobTitle})})}),(0,a.jsx)(h.TableCell,{children:e.phone||"—"}),(0,a.jsx)(h.TableCell,{children:e.email||"—"}),(0,a.jsx)(h.TableCell,{children:e.isPrimary&&(0,a.jsx)(k,{className:"h-4 w-4 text-yellow-400"})}),(0,a.jsx)(h.TableCell,{children:(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(p.Button,{intent:"outline",size:"sq-sm",onPress:s,"aria-label":"Edit",children:(0,a.jsx)(b.PencilIcon,{className:"h-3 w-3"})}),(0,a.jsx)(p.Button,{intent:"outline",size:"sq-sm",onPress:n,"aria-label":"Delete",children:(0,a.jsx)(N.TrashIcon,{className:"h-3 w-3"})})]})})]})}var _=e.i(499398),A=e.i(374294);let{entries:L,setPrototypeOf:I,isFrozen:D,getPrototypeOf:P,getOwnPropertyDescriptor:M}=Object,{freeze:R,seal:O,create:z}=Object,{apply:B,construct:H}="undefined"!=typeof Reflect&&Reflect;R||(R=function(e){return e}),O||(O=function(e){return e}),B||(B=function(e,t){for(var a=arguments.length,s=Array(a>2?a-2:0),r=2;r<a;r++)s[r-2]=arguments[r];return e.apply(t,s)}),H||(H=function(e){for(var t=arguments.length,a=Array(t>1?t-1:0),s=1;s<t;s++)a[s-1]=arguments[s];return new e(...a)});let U=et(Array.prototype.forEach),F=et(Array.prototype.lastIndexOf),W=et(Array.prototype.pop),$=et(Array.prototype.push),q=et(Array.prototype.splice),G=et(String.prototype.toLowerCase),V=et(String.prototype.toString),Y=et(String.prototype.match),Q=et(String.prototype.replace),Z=et(String.prototype.indexOf),X=et(String.prototype.trim),K=et(Object.prototype.hasOwnProperty),J=et(RegExp.prototype.test),ee=(t=TypeError,function(){for(var e=arguments.length,a=Array(e),s=0;s<e;s++)a[s]=arguments[s];return H(t,a)});function et(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var a=arguments.length,s=Array(a>1?a-1:0),r=1;r<a;r++)s[r-1]=arguments[r];return B(e,t,s)}}function ea(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:G;I&&I(e,null);let s=t.length;for(;s--;){let r=t[s];if("string"==typeof r){let e=a(r);e!==r&&(D(t)||(t[s]=e),r=e)}e[r]=!0}return e}function es(e){let t=z(null);for(let[a,s]of L(e))K(e,a)&&(Array.isArray(s)?t[a]=function(e){for(let t=0;t<e.length;t++)K(e,t)||(e[t]=null);return e}(s):s&&"object"==typeof s&&s.constructor===Object?t[a]=es(s):t[a]=s);return t}function er(e,t){for(;null!==e;){let a=M(e,t);if(a){if(a.get)return et(a.get);if("function"==typeof a.value)return et(a.value)}e=P(e)}return function(){return null}}let ei=R(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),en=R(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),el=R(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),eo=R(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ec=R(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),ed=R(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),em=R(["#text"]),eu=R(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ex=R(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),eh=R(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ep=R(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),eg=O(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ey=O(/<%[\w\W]*|[\w\W]*%>/gm),ef=O(/\$\{[\w\W]*/gm),ej=O(/^data-[\-\w.\u00B7-\uFFFF]+$/),eb=O(/^aria-[\-\w]+$/),eN=O(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ev=O(/^(?:\w+script|data):/i),ew=O(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ek=O(/^html$/i);var eC=Object.freeze({__proto__:null,ARIA_ATTR:eb,ATTR_WHITESPACE:ew,CUSTOM_ELEMENT:O(/^[a-z][.\w]*(-[.\w]+)+$/i),DATA_ATTR:ej,DOCTYPE_NAME:ek,ERB_EXPR:ey,IS_ALLOWED_URI:eN,IS_SCRIPT_OR_DATA:ev,MUSTACHE_EXPR:eg,TMPLIT_EXPR:ef});let eT=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let a=null,s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(a=t.getAttribute(s));let r="dompurify"+(a?"#"+a:"");try{return e.createPolicy(r,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+r+" could not be created."),null}},eS=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};var eE=function e(){let t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,s=t=>e(t);if(s.version="3.3.1",s.removed=[],!a||!a.document||9!==a.document.nodeType||!a.Element)return s.isSupported=!1,s;let{document:r}=a,i=r,n=i.currentScript,{DocumentFragment:l,HTMLTemplateElement:o,Node:c,Element:d,NodeFilter:m,NamedNodeMap:u=a.NamedNodeMap||a.MozNamedAttrMap,HTMLFormElement:x,DOMParser:h,trustedTypes:p}=a,g=d.prototype,y=er(g,"cloneNode"),f=er(g,"remove"),j=er(g,"nextSibling"),b=er(g,"childNodes"),N=er(g,"parentNode");if("function"==typeof o){let e=r.createElement("template");e.content&&e.content.ownerDocument&&(r=e.content.ownerDocument)}let v="",{implementation:w,createNodeIterator:k,createDocumentFragment:C,getElementsByTagName:T}=r,{importNode:S}=i,E=eS();s.isSupported="function"==typeof L&&"function"==typeof N&&w&&void 0!==w.createHTMLDocument;let{MUSTACHE_EXPR:_,ERB_EXPR:A,TMPLIT_EXPR:I,DATA_ATTR:D,ARIA_ATTR:P,IS_SCRIPT_OR_DATA:M,ATTR_WHITESPACE:O,CUSTOM_ELEMENT:B}=eC,{IS_ALLOWED_URI:H}=eC,et=null,eg=ea({},[...ei,...en,...el,...ec,...em]),ey=null,ef=ea({},[...eu,...ex,...eh,...ep]),ej=Object.seal(z(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),eb=null,ev=null,ew=Object.seal(z(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}})),eE=!0,e_=!0,eA=!1,eL=!0,eI=!1,eD=!0,eP=!1,eM=!1,eR=!1,eO=!1,ez=!1,eB=!1,eH=!0,eU=!1,eF=!0,eW=!1,e$={},eq=null,eG=ea({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),eV=null,eY=ea({},["audio","video","img","source","image","track"]),eQ=null,eZ=ea({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),eX="http://www.w3.org/1998/Math/MathML",eK="http://www.w3.org/2000/svg",eJ="http://www.w3.org/1999/xhtml",e0=eJ,e2=!1,e1=null,e4=ea({},[eX,eK,eJ],V),e5=ea({},["mi","mo","mn","ms","mtext"]),e3=ea({},["annotation-xml"]),e6=ea({},["title","style","font","a","script"]),e9=null,e8=["application/xhtml+xml","text/html"],e7=null,te=null,tt=r.createElement("form"),ta=function(e){return e instanceof RegExp||e instanceof Function},ts=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!te||te!==e){if(e&&"object"==typeof e||(e={}),e=es(e),e7="application/xhtml+xml"===(e9=-1===e8.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE)?V:G,et=K(e,"ALLOWED_TAGS")?ea({},e.ALLOWED_TAGS,e7):eg,ey=K(e,"ALLOWED_ATTR")?ea({},e.ALLOWED_ATTR,e7):ef,e1=K(e,"ALLOWED_NAMESPACES")?ea({},e.ALLOWED_NAMESPACES,V):e4,eQ=K(e,"ADD_URI_SAFE_ATTR")?ea(es(eZ),e.ADD_URI_SAFE_ATTR,e7):eZ,eV=K(e,"ADD_DATA_URI_TAGS")?ea(es(eY),e.ADD_DATA_URI_TAGS,e7):eY,eq=K(e,"FORBID_CONTENTS")?ea({},e.FORBID_CONTENTS,e7):eG,eb=K(e,"FORBID_TAGS")?ea({},e.FORBID_TAGS,e7):es({}),ev=K(e,"FORBID_ATTR")?ea({},e.FORBID_ATTR,e7):es({}),e$=!!K(e,"USE_PROFILES")&&e.USE_PROFILES,eE=!1!==e.ALLOW_ARIA_ATTR,e_=!1!==e.ALLOW_DATA_ATTR,eA=e.ALLOW_UNKNOWN_PROTOCOLS||!1,eL=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,eI=e.SAFE_FOR_TEMPLATES||!1,eD=!1!==e.SAFE_FOR_XML,eP=e.WHOLE_DOCUMENT||!1,eO=e.RETURN_DOM||!1,ez=e.RETURN_DOM_FRAGMENT||!1,eB=e.RETURN_TRUSTED_TYPE||!1,eR=e.FORCE_BODY||!1,eH=!1!==e.SANITIZE_DOM,eU=e.SANITIZE_NAMED_PROPS||!1,eF=!1!==e.KEEP_CONTENT,eW=e.IN_PLACE||!1,H=e.ALLOWED_URI_REGEXP||eN,e0=e.NAMESPACE||eJ,e5=e.MATHML_TEXT_INTEGRATION_POINTS||e5,e3=e.HTML_INTEGRATION_POINTS||e3,ej=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ta(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ej.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ta(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ej.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(ej.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),eI&&(e_=!1),ez&&(eO=!0),e$&&(et=ea({},em),ey=[],!0===e$.html&&(ea(et,ei),ea(ey,eu)),!0===e$.svg&&(ea(et,en),ea(ey,ex),ea(ey,ep)),!0===e$.svgFilters&&(ea(et,el),ea(ey,ex),ea(ey,ep)),!0===e$.mathMl&&(ea(et,ec),ea(ey,eh),ea(ey,ep))),e.ADD_TAGS&&("function"==typeof e.ADD_TAGS?ew.tagCheck=e.ADD_TAGS:(et===eg&&(et=es(et)),ea(et,e.ADD_TAGS,e7))),e.ADD_ATTR&&("function"==typeof e.ADD_ATTR?ew.attributeCheck=e.ADD_ATTR:(ey===ef&&(ey=es(ey)),ea(ey,e.ADD_ATTR,e7))),e.ADD_URI_SAFE_ATTR&&ea(eQ,e.ADD_URI_SAFE_ATTR,e7),e.FORBID_CONTENTS&&(eq===eG&&(eq=es(eq)),ea(eq,e.FORBID_CONTENTS,e7)),e.ADD_FORBID_CONTENTS&&(eq===eG&&(eq=es(eq)),ea(eq,e.ADD_FORBID_CONTENTS,e7)),eF&&(et["#text"]=!0),eP&&ea(et,["html","head","body"]),et.table&&(ea(et,["tbody"]),delete eb.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw ee('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw ee('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');v=(t=e.TRUSTED_TYPES_POLICY).createHTML("")}else void 0===t&&(t=eT(p,n)),null!==t&&"string"==typeof v&&(v=t.createHTML(""));R&&R(e),te=e}},tr=ea({},[...en,...el,...eo]),ti=ea({},[...ec,...ed]),tn=function(e){let t=N(e);t&&t.tagName||(t={namespaceURI:e0,tagName:"template"});let a=G(e.tagName),s=G(t.tagName);return!!e1[e.namespaceURI]&&(e.namespaceURI===eK?t.namespaceURI===eJ?"svg"===a:t.namespaceURI===eX?"svg"===a&&("annotation-xml"===s||e5[s]):!!tr[a]:e.namespaceURI===eX?t.namespaceURI===eJ?"math"===a:t.namespaceURI===eK?"math"===a&&e3[s]:!!ti[a]:e.namespaceURI===eJ?(t.namespaceURI!==eK||!!e3[s])&&(t.namespaceURI!==eX||!!e5[s])&&!ti[a]&&(e6[a]||!tr[a]):"application/xhtml+xml"===e9&&!!e1[e.namespaceURI])},tl=function(e){$(s.removed,{element:e});try{N(e).removeChild(e)}catch(t){f(e)}},to=function(e,t){try{$(s.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){$(s.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(eO||ez)try{tl(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},tc=function(e){let a=null,s=null;if(eR)e="<remove></remove>"+e;else{let t=Y(e,/^[\r\n\t ]+/);s=t&&t[0]}"application/xhtml+xml"===e9&&e0===eJ&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");let i=t?t.createHTML(e):e;if(e0===eJ)try{a=new h().parseFromString(i,e9)}catch(e){}if(!a||!a.documentElement){a=w.createDocument(e0,"template",null);try{a.documentElement.innerHTML=e2?v:i}catch(e){}}let n=a.body||a.documentElement;return(e&&s&&n.insertBefore(r.createTextNode(s),n.childNodes[0]||null),e0===eJ)?T.call(a,eP?"html":"body")[0]:eP?a.documentElement:n},td=function(e){return k.call(e.ownerDocument||e,e,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null)},tm=function(e){return e instanceof x&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof u)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},tu=function(e){return"function"==typeof c&&e instanceof c};function tx(e,t,a){U(e,e=>{e.call(s,t,a,te)})}let th=function(e){let t=null;if(tx(E.beforeSanitizeElements,e,null),tm(e))return tl(e),!0;let a=e7(e.nodeName);if(tx(E.uponSanitizeElement,e,{tagName:a,allowedTags:et}),eD&&e.hasChildNodes()&&!tu(e.firstElementChild)&&J(/<[/\w!]/g,e.innerHTML)&&J(/<[/\w!]/g,e.textContent)||7===e.nodeType||eD&&8===e.nodeType&&J(/<[/\w]/g,e.data))return tl(e),!0;if(!(ew.tagCheck instanceof Function&&ew.tagCheck(a))&&(!et[a]||eb[a])){if(!eb[a]&&tg(a)&&(ej.tagNameCheck instanceof RegExp&&J(ej.tagNameCheck,a)||ej.tagNameCheck instanceof Function&&ej.tagNameCheck(a)))return!1;if(eF&&!eq[a]){let t=N(e)||e.parentNode,a=b(e)||e.childNodes;if(a&&t){let s=a.length;for(let r=s-1;r>=0;--r){let s=y(a[r],!0);s.__removalCount=(e.__removalCount||0)+1,t.insertBefore(s,j(e))}}}return tl(e),!0}return e instanceof d&&!tn(e)||("noscript"===a||"noembed"===a||"noframes"===a)&&J(/<\/no(script|embed|frames)/i,e.innerHTML)?(tl(e),!0):(eI&&3===e.nodeType&&(t=e.textContent,U([_,A,I],e=>{t=Q(t,e," ")}),e.textContent!==t&&($(s.removed,{element:e.cloneNode()}),e.textContent=t)),tx(E.afterSanitizeElements,e,null),!1)},tp=function(e,t,a){if(eH&&("id"===t||"name"===t)&&(a in r||a in tt))return!1;if(e_&&!ev[t]&&J(D,t));else if(eE&&J(P,t));else if(ew.attributeCheck instanceof Function&&ew.attributeCheck(t,e));else if(!ey[t]||ev[t]){if(!(tg(e)&&(ej.tagNameCheck instanceof RegExp&&J(ej.tagNameCheck,e)||ej.tagNameCheck instanceof Function&&ej.tagNameCheck(e))&&(ej.attributeNameCheck instanceof RegExp&&J(ej.attributeNameCheck,t)||ej.attributeNameCheck instanceof Function&&ej.attributeNameCheck(t,e))||"is"===t&&ej.allowCustomizedBuiltInElements&&(ej.tagNameCheck instanceof RegExp&&J(ej.tagNameCheck,a)||ej.tagNameCheck instanceof Function&&ej.tagNameCheck(a))))return!1}else if(eQ[t]);else if(J(H,Q(a,O,"")));else if(("src"===t||"xlink:href"===t||"href"===t)&&"script"!==e&&0===Z(a,"data:")&&eV[e]);else if(eA&&!J(M,Q(a,O,"")));else if(a)return!1;return!0},tg=function(e){return"annotation-xml"!==e&&Y(e,B)},ty=function(e){tx(E.beforeSanitizeAttributes,e,null);let{attributes:a}=e;if(!a||tm(e))return;let r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ey,forceKeepAttr:void 0},i=a.length;for(;i--;){let{name:n,namespaceURI:l,value:o}=a[i],c=e7(n),d="value"===n?o:X(o);if(r.attrName=c,r.attrValue=d,r.keepAttr=!0,r.forceKeepAttr=void 0,tx(E.uponSanitizeAttribute,e,r),d=r.attrValue,eU&&("id"===c||"name"===c)&&(to(n,e),d="user-content-"+d),eD&&J(/((--!?|])>)|<\/(style|title|textarea)/i,d)||"attributename"===c&&Y(d,"href")){to(n,e);continue}if(r.forceKeepAttr)continue;if(!r.keepAttr||!eL&&J(/\/>/i,d)){to(n,e);continue}eI&&U([_,A,I],e=>{d=Q(d,e," ")});let m=e7(e.nodeName);if(!tp(m,c,d)){to(n,e);continue}if(t&&"object"==typeof p&&"function"==typeof p.getAttributeType)if(l);else switch(p.getAttributeType(m,c)){case"TrustedHTML":d=t.createHTML(d);break;case"TrustedScriptURL":d=t.createScriptURL(d)}if(d!==o)try{l?e.setAttributeNS(l,n,d):e.setAttribute(n,d),tm(e)?tl(e):W(s.removed)}catch(t){to(n,e)}}tx(E.afterSanitizeAttributes,e,null)},tf=function e(t){let a=null,s=td(t);for(tx(E.beforeSanitizeShadowDOM,t,null);a=s.nextNode();)tx(E.uponSanitizeShadowNode,a,null),th(a),ty(a),a.content instanceof l&&e(a.content);tx(E.afterSanitizeShadowDOM,t,null)};return s.sanitize=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,n=null,o=null,d=null;if((e2=!e)&&(e="<!-->"),"string"!=typeof e&&!tu(e))if("function"==typeof e.toString){if("string"!=typeof(e=e.toString()))throw ee("dirty is not a string, aborting")}else throw ee("toString is not a function");if(!s.isSupported)return e;if(eM||ts(a),s.removed=[],"string"==typeof e&&(eW=!1),eW){if(e.nodeName){let t=e7(e.nodeName);if(!et[t]||eb[t])throw ee("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof c)1===(n=(r=tc("<!---->")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===n.nodeName||"HTML"===n.nodeName?r=n:r.appendChild(n);else{if(!eO&&!eI&&!eP&&-1===e.indexOf("<"))return t&&eB?t.createHTML(e):e;if(!(r=tc(e)))return eO?null:eB?v:""}r&&eR&&tl(r.firstChild);let m=td(eW?e:r);for(;o=m.nextNode();)th(o),ty(o),o.content instanceof l&&tf(o.content);if(eW)return e;if(eO){if(ez)for(d=C.call(r.ownerDocument);r.firstChild;)d.appendChild(r.firstChild);else d=r;return(ey.shadowroot||ey.shadowrootmode)&&(d=S.call(i,d,!0)),d}let u=eP?r.outerHTML:r.innerHTML;return eP&&et["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&J(ek,r.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+u),eI&&U([_,A,I],e=>{u=Q(u,e," ")}),t&&eB?t.createHTML(u):u},s.setConfig=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ts(e),eM=!0},s.clearConfig=function(){te=null,eM=!1},s.isValidAttribute=function(e,t,a){return te||ts({}),tp(e7(e),e7(t),a)},s.addHook=function(e,t){"function"==typeof t&&$(E[e],t)},s.removeHook=function(e,t){if(void 0!==t){let a=F(E[e],t);return -1===a?void 0:q(E[e],a,1)[0]}return W(E[e])},s.removeHooks=function(e){E[e]=[]},s.removeAllHooks=function(){E=eS()},s}(),e_=e.i(245715),eA=e.i(407107),eL=e.i(541247),eI=e.i(415882),eD=e.i(51738),eP=e.i(680707),eM=e.i(514764),eR=e.i(82735),eO=e.i(440160),ez=e.i(565833),eB=e.i(494913),eH=e.i(152088);function eU({isOpen:e,onOpenChange:t,clientId:s,threadId:l,onComplete:c,mode:d="reply"}){let m=(0,n.useToast)(),[u,x]=(0,o.useState)(""),[h,p]=(0,o.useState)(""),[g,y]=(0,o.useState)(!1),[f,j]=(0,o.useState)(null),b=(0,o.useRef)(null),N=(0,r.useQuery)(i.api.emailMessages.getEmailThread,l?{threadId:l}:"skip"),v=(0,r.useQuery)(i.api.clients.get,{id:s}),w=(0,r.useQuery)(i.api.clientContacts.listByClient,{clientId:s}),k=(0,r.useQuery)(i.api.clientContacts.getPrimaryContact,{clientId:s}),C=(0,r.useQuery)(i.api.users.current,{}),T=(0,r.useQuery)(i.api.organizations.get,{}),S=(0,r.useMutation)(i.api.resend.replyToEmail),E=(0,r.useMutation)(i.api.resend.sendClientEmail),_=f?w?.find(e=>e._id===f):k;(0,o.useEffect)(()=>{k&&!f&&j(k._id)},[k,f]),(0,o.useEffect)(()=>{N&&N.length>0&&b.current?.scrollIntoView({behavior:"smooth"})},[N]),(0,o.useEffect)(()=>{e||(x(""),p(""),j(null))},[e]);let A=async()=>{if(!h.trim())return void m.error("Empty Message","Please enter a message to send");let e="new"===d||!N||0===N.length;if(e&&!u.trim())return void m.error("Subject Required","Please enter a subject for the email");if(!_?.email)return void m.error("No Email","The selected contact doesn't have an email address");y(!0);try{if(e)await E({clientId:s,subject:u.trim(),messageBody:h.trim()}),m.success("Email Sent","Your email has been sent successfully");else{let e=N[N.length-1];await S({emailMessageId:e._id,messageBody:h.trim()}),m.success("Reply Sent","Your reply has been sent successfully")}x(""),p(""),j(null),c?.()}catch(e){console.error("Error sending email:",e),m.error("Send Failed",e instanceof Error?e.message:"Failed to send email")}finally{y(!1)}},L="new"===d||!N||0===N.length;return(0,a.jsx)(e_.Sheet,{open:e,onOpenChange:t,children:(0,a.jsx)(e_.SheetContent,{side:"right",className:"w-full sm:max-w-3xl bg-background",children:(0,a.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",children:[(0,a.jsxs)(e_.SheetHeader,{className:"border-b border-border pb-4 shrink-0",children:[(0,a.jsx)(e_.SheetTitle,{className:"text-2xl font-semibold",children:N&&N.length>0?N[0].subject:"New Email"}),(0,a.jsxs)(e_.SheetDescription,{className:"text-muted-foreground",children:[v?`Conversation with ${v.companyName}`:"Loading...",_&&(0,a.jsxs)("span",{className:"block text-xs mt-1",children:["To: ",_.email]})]})]}),N&&N.length>0&&(0,a.jsx)("div",{className:"flex-1 overflow-y-auto py-6 px-6",children:(0,a.jsxs)("div",{className:"space-y-6",children:[N.map(e=>(0,a.jsx)(eF,{message:e},e._id)),(0,a.jsx)("div",{ref:b})]})}),(!N||0===N.length)&&(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center text-muted-foreground py-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(eM.Send,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"Start a new conversation"})]})}),(0,a.jsx)("div",{className:"border-t border-border shrink-0 bg-background",children:(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[L&&w&&w.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"contact-select",className:"text-sm font-medium text-foreground",children:"Send To"}),(0,a.jsxs)(eD.StyledSelect,{value:f||"",onValueChange:e=>j(e),children:[(0,a.jsx)(eD.StyledSelectTrigger,{id:"contact-select",children:(0,a.jsx)(eP.SelectValue,{placeholder:"Select a contact"})}),(0,a.jsx)(eD.StyledSelectContent,{children:w.map(e=>(0,a.jsx)(eP.SelectItem,{value:e._id,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.firstName," ",e.lastName]}),e.isPrimary&&(0,a.jsx)("span",{className:"text-xs text-primary",children:"(Primary)"}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.email})]})},e._id))})]})]}),L&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"email-subject",className:"text-sm font-medium text-foreground",children:"Subject"}),(0,a.jsx)(eI.StyledInput,{id:"email-subject",value:u,onChange:e=>x(e.target.value),placeholder:"Enter email subject...",disabled:g})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"reply-body",className:"text-sm font-medium text-foreground",children:L?"Message":"Reply to this thread"}),(0,a.jsx)(eL.Textarea,{id:"reply-body",value:h,onChange:e=>p(e.target.value),placeholder:"Type your message here...",className:"min-h-[120px] resize-none",disabled:g}),(0,a.jsx)("div",{className:"flex justify-between items-center text-sm text-muted-foreground",children:(0,a.jsxs)("span",{children:[h.length," characters"]})}),h.trim()&&(0,a.jsxs)("div",{className:"mt-4 p-4 rounded-lg bg-muted/50 border border-border",children:[(0,a.jsx)("div",{className:"flex items-start gap-2 mb-2",children:(0,a.jsx)("div",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Email Preview"})}),(0,a.jsx)("div",{className:"text-sm text-foreground/80 whitespace-pre-wrap font-mono",children:(()=>{if(!h.trim())return"";let e=_&&`${_.firstName||""} ${_.lastName||""}`.trim()||"Client Name",t=C?.name||"Your Name",a=T?.name||"Organization";return`Hi ${e},

${h}

Best regards,
${t}
${a}`})()}),(0,a.jsx)("div",{className:"mt-2 text-xs text-muted-foreground italic",children:"This shows what your recipient will see (greeting and signature are auto-added)"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)(eA.StyledButton,{type:"button",intent:"outline",onClick:()=>{x(""),p(""),j(null),t(!1)},label:"Close",showArrow:!1,disabled:g}),(0,a.jsx)(eA.StyledButton,{type:"button",intent:"primary",onClick:A,isLoading:g,disabled:!h.trim()||L&&!u.trim()||g,label:g?"Sending...":L?"Send Email":"Send Reply",icon:!g&&(0,a.jsx)(eM.Send,{className:"w-4 h-4"}),showArrow:!1})]})]})})]})})})}function eF({message:e}){var t;let s="inbound"===e.direction,n=(0,r.useQuery)(i.api.emailAttachments.listByEmail,e.hasAttachments?{emailMessageId:e._id}:"skip");return(0,a.jsxs)("div",{className:(0,eH.cn)("flex gap-3",s?"flex-row":"flex-row-reverse"),children:[(0,a.jsxs)(ez.Avatar,{className:"w-10 h-10 shrink-0",children:[(0,a.jsx)(ez.AvatarImage,{src:e.senderAvatar||void 0}),(0,a.jsx)(ez.AvatarFallback,{className:(0,eH.cn)(s?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"),children:e.senderName?.[0]||e.fromName[0]})]}),(0,a.jsxs)("div",{className:(0,eH.cn)("flex-1 max-w-[85%] space-y-1"),children:[(0,a.jsxs)("div",{className:(0,eH.cn)("flex items-baseline gap-2",s?"flex-row":"flex-row-reverse"),children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e.senderName||e.fromName}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:(0,eB.formatDistanceToNow)(new Date(e.sentAt),{addSuffix:!0})})]}),(0,a.jsxs)("div",{className:(0,eH.cn)("rounded-lg px-4 py-3 text-sm",s?"bg-muted text-foreground":"bg-primary/10 text-primary ring-1 ring-primary/20 backdrop-blur-sm shadow-sm"),children:[e.htmlBody?(0,a.jsx)("div",{className:"prose prose-sm max-w-none dark:prose-invert [&>*:last-child]:mb-0",dangerouslySetInnerHTML:{__html:(t=e$(e.htmlBody,!0),eE.sanitize(t,{ALLOWED_TAGS:["p","br","b","i","u","strong","em","a","ul","ol","li","span","div"],ALLOWED_ATTR:["href","target","rel","class"]}))}}):(0,a.jsx)("div",{className:"whitespace-pre-wrap [&>*:last-child]:mb-0",children:e$(e.messageBody,!1)}),e.hasAttachments&&n&&n.length>0&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-border/50 space-y-2",children:n.map(e=>(0,a.jsx)(eW,{attachment:e},e._id))})]}),!s&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground text-right",children:["delivered"===e.status&&"✓ Delivered","opened"===e.status&&"✓✓ Opened","sent"===e.status&&"✓ Sent","bounced"===e.status&&"⚠ Bounced"]})]})]})}function eW({attachment:e}){let t=(0,r.useQuery)(i.api.emailAttachments.getDownloadUrl,{attachmentId:e._id});return(0,a.jsxs)("a",{href:t||"#",download:e.filename,className:(0,eH.cn)("flex items-center gap-2 p-2 rounded bg-background/50 hover:bg-background/80 transition-colors",!t&&"opacity-50 cursor-not-allowed"),onClick:e=>{t||e.preventDefault()},children:[(0,a.jsx)(eR.Paperclip,{className:"w-4 h-4"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium truncate",children:e.filename}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:function(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]}(e.size)})]}),(0,a.jsx)(eO.Download,{className:"w-4 h-4 shrink-0"})]})}function e$(e,t=!1){if(t){let t=e;return(t=(t=(t=(t=t.replace(/<div class="gmail_quote[^>]*">[\s\S]*?<\/div>/gi,"")).replace(/<blockquote[^>]*class="gmail_quote"[^>]*>[\s\S]*?<\/blockquote>/gi,"")).replace(/<div[^>]*class="gmail_attr"[^>]*>[\s\S]*?<\/div>/gi,"")).replace(/<div[^>]*class="gmail_signature"[^>]*>[\s\S]*?<\/div>/gi,"")).trim()}{let t=e.split("\n"),a=[],s=!1;for(let e of t){if(e.trim().startsWith(">")||e.match(/^On .+? wrote:$/i)||e.match(/^-{3,}/)){s=!0;break}if("--"===e.trim()||e.match(/^[-_]{2,}$/))break;s||a.push(e)}return a.join("\n").trim()}}var eq=e.i(164407),eG=e.i(271217),eV=e.i(337837),eY=e.i(263488);let eQ=(0,e.i(475254).default)("mail-open",[["path",{d:"M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z",key:"1jhwl8"}],["path",{d:"m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10",key:"1qfld7"}]]);var eZ=e.i(686311),eX=e.i(531278);function eK({clientId:e,children:t}){let[s,n]=(0,o.useState)(!1),[l,c]=(0,o.useState)(!1),[d,m]=(0,o.useState)(),u=(0,r.useQuery)(i.api.emailMessages.listThreadsByClient,{clientId:e});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(eV.Popover,{open:s,onOpenChange:n,children:[(0,a.jsx)(eV.PopoverTrigger,{asChild:!0,children:t}),(0,a.jsx)(eV.PopoverContent,{className:"w-96 p-0 bg-background! backdrop-blur-xl border-border shadow-xl",align:"end",children:(0,a.jsxs)("div",{className:"flex flex-col max-h-[500px]",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-border bg-background",children:(0,a.jsx)("h3",{className:"font-semibold text-sm",children:"Email Threads"})}),(0,a.jsx)("div",{className:"overflow-y-auto bg-background",children:void 0===u?(0,a.jsxs)("div",{className:"px-4 py-8 flex flex-col items-center justify-center gap-3","aria-busy":"true","aria-live":"polite",children:[(0,a.jsx)(eX.Loader2,{className:"w-8 h-8 animate-spin text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Loading email threads..."}),(0,a.jsx)("span",{className:"sr-only",children:"Loading email threads, please wait"})]}):0===u.length?(0,a.jsxs)("div",{className:"px-4 py-8 text-center text-sm text-muted-foreground",children:[(0,a.jsx)(eZ.MessageSquare,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),(0,a.jsx)("p",{children:"No email threads yet"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:"Send an email to start a conversation"})]}):(0,a.jsx)("div",{className:"divide-y divide-border",children:u.map(e=>(0,a.jsx)("button",{onClick:()=>{m(e.threadId),n(!1),c(!0)},className:"w-full px-4 py-3 text-left hover:bg-accent transition-colors",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:(0,eH.cn)("mt-0.5",e.hasUnread?"text-primary":"text-muted-foreground"),children:e.hasUnread?(0,a.jsx)(eY.Mail,{className:"w-4 h-4"}):(0,a.jsx)(eQ,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-baseline justify-between gap-2 mb-1",children:[(0,a.jsx)("h4",{className:(0,eH.cn)("text-sm truncate",e.hasUnread?"font-semibold":"font-medium"),children:e.subject}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground shrink-0",children:(0,eB.formatDistanceToNow)(new Date(e.latestMessageAt),{addSuffix:!0})})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-2",children:e.latestMessage}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.messageCount," ",1===e.messageCount?"message":"messages"]}),e.hasUnread&&(0,a.jsx)("span",{className:"text-xs font-medium text-primary",children:"• New"})]})]})]})},e.threadId))})})]})})]}),(0,a.jsx)(eU,{isOpen:l,onOpenChange:c,clientId:e,threadId:d,mode:d?"reply":"new",onComplete:()=>{c(!1)}})]})}var eJ=e.i(107233),e0=e.i(75505),e2=e.i(350627),e1=e.i(178583),e4=e.i(191741),e5=e.i(907347);let e3=["lead","prospect","active","inactive","archived"];function e6(e){return e.charAt(0).toUpperCase()+e.slice(1)}function e9(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set"}function e8(e){switch(e){case"lead":case"prospect":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400";case"active":case"paid":case"approved":case"completed":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"sent":case"pending":case"in-progress":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400";case"inactive":case"cancelled":case"overdue":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}}function e7({client:e,clientId:t,isEditing:r,onEditClick:i,statusValue:l,onStatusChange:o,emailCount:c,projects:d,quotes:m,invoices:u,tasks:x,onTaskSheetOpen:h}){let g=(0,s.useRouter)(),y=(0,n.useToast)();return(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("div",{className:"flex items-start justify-between gap-6 mb-6",children:(0,a.jsxs)("div",{className:"flex items-start gap-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-16 h-16 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 dark:from-blue-600 dark:to-blue-700 shrink-0 shadow-md",children:(0,a.jsx)(f,{className:"h-8 w-8 text-white"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-wrap mb-2",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:e.companyName}),r?(0,a.jsxs)(eG.StyledSelect,{value:l,onValueChange:o,children:[(0,a.jsx)(eG.StyledSelectTrigger,{className:"w-auto",children:(0,a.jsx)(eG.SelectValue,{})}),(0,a.jsx)(eG.StyledSelectContent,{children:e3.map(e=>(0,a.jsx)(eG.SelectItem,{value:e,children:e6(e)},e))})]}):(0,a.jsx)(eq.ProminentStatusBadge,{status:e.status,size:"large",showIcon:!0,entityType:"client"})]}),!r&&(0,a.jsxs)("button",{onClick:i,className:"inline-flex items-center gap-2 text-sm text-primary hover:text-primary/80 font-medium transition-colors",children:[(0,a.jsx)(b.PencilIcon,{className:"h-4 w-4"}),"Edit Details"]})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[(0,a.jsx)(eK,{clientId:t,children:(0,a.jsxs)("button",{className:"flex flex-col items-center justify-center p-4 rounded-lg border border-gray-300 dark:border-white/20 bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),(0,a.jsx)("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:c})]}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Messages"})]})}),(0,a.jsxs)(eV.Popover,{children:[(0,a.jsx)(eV.PopoverTrigger,{asChild:!0,children:(0,a.jsxs)("button",{className:"flex flex-col items-center justify-center p-4 rounded-lg border border-gray-300 dark:border-white/20 bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),(0,a.jsx)("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d?.length||0})]}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Projects"})]})}),(0,a.jsxs)(eV.PopoverContent,{className:"w-96 p-0 bg-white dark:bg-gray-900",align:"start",side:"bottom",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-white/10",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Projects"}),(0,a.jsxs)(p.Button,{intent:"outline",size:"sm",onPress:()=>g.push(`/projects/new?clientId=${t}`),children:[(0,a.jsx)(eJ.Plus,{className:"h-4 w-4 mr-2"}),"New"]})]})}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto",children:d&&d.length>0?(0,a.jsx)("div",{className:"p-2",children:d.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-white/5 rounded-lg transition-colors cursor-pointer",onClick:()=>g.push(`/projects/${e._id}`),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,a.jsx)("div",{className:`w-2 h-2 rounded-full shrink-0 ${"completed"===e.status?"bg-green-500":"in-progress"===e.status?"bg-yellow-500":"bg-blue-500"}`}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-sm text-gray-900 dark:text-white truncate",children:e.title}),e.description&&(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:e.description})]})]}),(0,a.jsx)(e5.Badge,{className:e8(e.status),variant:"outline",children:e6(e.status)})]},e._id))}):(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)(e0.FolderOpen,{className:"h-12 w-12 text-gray-400 dark:text-gray-600 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No projects yet"})]})})]})]}),(0,a.jsxs)(eV.Popover,{children:[(0,a.jsx)(eV.PopoverTrigger,{asChild:!0,children:(0,a.jsxs)("button",{className:"flex flex-col items-center justify-center p-4 rounded-lg border border-gray-300 dark:border-white/20 bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 14l6-6m-5.5.5h.01m4.99 5h.01M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16l3.5-2 3.5 2 3.5-2 3.5 2z"})}),(0,a.jsx)("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:m?.length||0})]}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Quotes"})]})}),(0,a.jsxs)(eV.PopoverContent,{className:"w-96 p-0 bg-white dark:bg-gray-900",align:"start",side:"bottom",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-white/10",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Quotes"}),(0,a.jsxs)(p.Button,{intent:"outline",size:"sm",onPress:()=>g.push(`/quotes/new?clientId=${t}`),children:[(0,a.jsx)(eJ.Plus,{className:"h-4 w-4 mr-2"}),"New"]})]})}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto",children:m&&m.length>0?(0,a.jsx)("div",{className:"p-2",children:m.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-white/5 rounded-lg transition-colors cursor-pointer",onClick:()=>g.push(`/quotes/${e._id}`),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500 shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("p",{className:"font-medium text-sm text-gray-900 dark:text-white truncate",children:["Quote #",e.quoteNumber]}),e.title&&(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:e.title})]})]}),(0,a.jsxs)("div",{className:"text-right shrink-0",children:[e.total&&(0,a.jsxs)("p",{className:"font-medium text-sm text-gray-900 dark:text-white",children:["$",e.total.toLocaleString()]}),(0,a.jsx)(e5.Badge,{className:e8(e.status||"draft"),variant:"outline",children:e.status||"draft"})]})]},e._id))}):(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)(e2.Receipt,{className:"h-12 w-12 text-gray-400 dark:text-gray-600 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No quotes yet"})]})})]})]}),(0,a.jsxs)(eV.Popover,{children:[(0,a.jsx)(eV.PopoverTrigger,{asChild:!0,children:(0,a.jsxs)("button",{className:"flex flex-col items-center justify-center p-4 rounded-lg border border-gray-300 dark:border-white/20 bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,a.jsx)("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u?.length||0})]}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Invoices"})]})}),(0,a.jsxs)(eV.PopoverContent,{className:"w-96 p-0 bg-white dark:bg-gray-900",align:"start",side:"bottom",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-white/10",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Invoices"}),(0,a.jsxs)(p.Button,{intent:"outline",size:"sm",onPress:()=>y.info("Create Invoice","Invoice creation functionality coming soon!"),children:[(0,a.jsx)(eJ.Plus,{className:"h-4 w-4 mr-2"}),"New"]})]})}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto",children:u&&u.length>0?(0,a.jsx)("div",{className:"p-2",children:u.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-white/5 rounded-lg transition-colors cursor-pointer",onClick:()=>y.info("View Invoice","Invoice detail page coming soon!"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,a.jsx)("div",{className:`w-2 h-2 rounded-full shrink-0 ${"paid"===e.status?"bg-green-500":"sent"===e.status?"bg-yellow-500":"bg-red-500"}`}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("p",{className:"font-medium text-sm text-gray-900 dark:text-white truncate",children:["Invoice #",e.invoiceNumber]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e9(e._creationTime)})]})]}),(0,a.jsxs)("div",{className:"text-right shrink-0",children:[e.total&&(0,a.jsxs)("p",{className:"font-medium text-sm text-gray-900 dark:text-white",children:["$",e.total.toLocaleString()]}),(0,a.jsx)(e5.Badge,{className:e8(e.status),variant:"outline",children:e.status})]})]},e._id))}):(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)(e1.FileText,{className:"h-12 w-12 text-gray-400 dark:text-gray-600 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No invoices yet"})]})})]})]}),(0,a.jsxs)(eV.Popover,{children:[(0,a.jsx)(eV.PopoverTrigger,{asChild:!0,children:(0,a.jsxs)("button",{className:"flex flex-col items-center justify-center p-4 rounded-lg border border-gray-300 dark:border-white/20 bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),(0,a.jsx)("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:x?.length||0})]}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Tasks"})]})}),(0,a.jsxs)(eV.PopoverContent,{className:"w-96 p-0 bg-white dark:bg-gray-900",align:"end",side:"bottom",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-white/10",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Tasks"}),(0,a.jsxs)(p.Button,{intent:"outline",size:"sm",onPress:h,children:[(0,a.jsx)(eJ.Plus,{className:"h-4 w-4 mr-2"}),"New"]})]})}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto",children:x&&x.length>0?(0,a.jsx)("div",{className:"p-2",children:x.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-white/5 rounded-lg transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,a.jsx)("div",{className:`w-2 h-2 rounded-full shrink-0 ${"completed"===e.status?"bg-green-500":"cancelled"===e.status?"bg-red-500":"bg-yellow-500"}`}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-sm text-gray-900 dark:text-white truncate",children:e.title}),e.date&&(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e9(e.date)})]})]}),(0,a.jsx)(e5.Badge,{className:e8(e.status),variant:"outline",children:e.status})]},e._id))}):(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)(e4.ClipboardList,{className:"h-12 w-12 text-gray-400 dark:text-gray-600 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No tasks yet"})]})})]})]})]})]})}var te=e.i(173554);function tt(e){return e?e.charAt(0).toUpperCase()+e.slice(1):"Not specified"}function ta({client:e,isEditing:t,form:s,onFormChange:r}){var i;return(0,a.jsxs)(x.StyledCard,{children:[(0,a.jsx)(x.StyledCardHeader,{children:(0,a.jsx)(x.StyledCardTitle,{className:"text-xl",children:"About"})}),(0,a.jsx)(x.StyledCardContent,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6",children:[(e.industry||t)&&(0,a.jsxs)("div",{children:[(0,a.jsx)(te.Label,{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block",children:"Industry"}),t?(0,a.jsx)(eI.StyledInput,{value:s.industry,onChange:e=>r("industry",e.target.value),placeholder:"e.g., Technology, Healthcare"}):(0,a.jsx)("p",{className:"text-sm text-gray-900 dark:text-white",children:e.industry})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(te.Label,{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block",children:"Lead Source"}),(0,a.jsx)("p",{className:"text-sm text-gray-900 dark:text-white",children:(i=e.leadSource)?i.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"Not specified"})]}),(e.category||t)&&(0,a.jsxs)("div",{children:[(0,a.jsx)(te.Label,{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block",children:"Category"}),t?(0,a.jsx)(eI.StyledInput,{value:s.category,onChange:e=>r("category",e.target.value),placeholder:"e.g., Enterprise, SMB"}):(0,a.jsx)("p",{className:"text-sm text-gray-900 dark:text-white",children:tt(e.category)})]}),(e.clientSize||t)&&(0,a.jsxs)("div",{children:[(0,a.jsx)(te.Label,{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block",children:"Size"}),t?(0,a.jsx)(eI.StyledInput,{value:s.clientSize,onChange:e=>r("clientSize",e.target.value),placeholder:"e.g., 1-10, 50-200"}):(0,a.jsx)("p",{className:"text-sm text-gray-900 dark:text-white",children:tt(e.clientSize)})]}),(e.priorityLevel||t)&&(0,a.jsxs)("div",{children:[(0,a.jsx)(te.Label,{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block",children:"Priority"}),t?(0,a.jsx)(eI.StyledInput,{value:s.priorityLevel,onChange:e=>r("priorityLevel",e.target.value),placeholder:"e.g., High, Medium, Low"}):(0,a.jsx)("p",{className:"text-sm text-gray-900 dark:text-white",children:tt(e.priorityLevel)})]}),(e.projectDimensions||t)&&(0,a.jsxs)("div",{children:[(0,a.jsx)(te.Label,{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block",children:"Project Dimensions"}),t?(0,a.jsx)(eI.StyledInput,{value:s.projectDimensions,onChange:e=>r("projectDimensions",e.target.value),placeholder:"Enter dimensions"}):(0,a.jsx)("p",{className:"text-sm text-gray-900 dark:text-white",children:e.projectDimensions})]})]}),(e.companyDescription||t)&&(0,a.jsxs)("div",{className:"pt-4 border-t border-gray-200 dark:border-white/10",children:[(0,a.jsx)(te.Label,{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block",children:"Company Description"}),t?(0,a.jsx)(eL.Textarea,{value:s.companyDescription,onChange:e=>r("companyDescription",e.target.value),placeholder:"Brief description of the company and what they do...",className:"w-full",rows:3}):(0,a.jsx)("p",{className:"text-sm text-gray-900 dark:text-white whitespace-pre-wrap",children:e.companyDescription})]})]})})]})}var ts=e.i(664659),tr=e.i(399219),tr=tr;function ti({client:e,primaryContact:t,isEditing:s,form:r,onFormChange:i,clientEmails:l,invoices:c}){var m;let u,h;(0,n.useToast)();let[p,g]=(0,o.useState)(!1);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(x.StyledCard,{children:[(0,a.jsx)(x.StyledCardHeader,{children:(0,a.jsx)(x.StyledCardTitle,{className:"text-lg",children:"Contact Info"})}),(0,a.jsx)(x.StyledCardContent,{className:"space-y-4",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Primary contact"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.firstName," ",t.lastName]}),(0,a.jsx)(k,{className:"h-4 w-4 text-yellow-400"})]})]}),t.jobTitle&&(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Job Title"}),(0,a.jsx)("span",{className:"text-sm text-gray-900 dark:text-white text-right",children:t.jobTitle})]}),t.phone&&(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Phone"}),(0,a.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:(m=t.phone)?m:""})]}),t.email&&(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Email"}),(0,a.jsx)("span",{className:"text-sm text-gray-900 dark:text-white text-right break-all",children:t.email})]})]}),(0,a.jsx)("div",{className:"pt-4 border-t border-gray-200 dark:border-white/10",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Communication Preference"}),s?(0,a.jsx)("div",{className:"flex-1 max-w-[180px]",children:(0,a.jsxs)(eG.StyledSelect,{value:r.communicationPreference,onValueChange:e=>i("communicationPreference",e),children:[(0,a.jsx)(eG.StyledSelectTrigger,{className:"h-8",children:(0,a.jsx)(eG.SelectValue,{placeholder:"Select"})}),(0,a.jsxs)(eG.StyledSelectContent,{children:[(0,a.jsx)(eG.SelectItem,{value:"email",children:"Email only"}),(0,a.jsx)(eG.SelectItem,{value:"phone",children:"Phone calls for urgent matters"}),(0,a.jsx)(eG.SelectItem,{value:"both",children:"Both email and phone"})]})]})}):(0,a.jsx)("span",{className:"text-sm text-gray-900 dark:text-white text-right",children:function(e){if(!e)return"Not specified";switch(e){case"email":return"Email only";case"phone":return"Phone calls for urgent matters";case"both":return"Both email and phone";default:return e}}(e.communicationPreference)})]})})]}):(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"No primary contact set"})})})]}),(0,a.jsxs)(x.StyledCard,{children:[(0,a.jsx)(x.StyledCardHeader,{children:(0,a.jsx)(x.StyledCardTitle,{className:"text-lg",children:"Last client communication"})}),(0,a.jsx)(x.StyledCardContent,{children:l&&l.length>0?(h="inbound"===(u=l[0]).direction,(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"flex items-start justify-between gap-2",children:(0,a.jsxs)("div",{className:"flex items-start gap-2 flex-1 min-w-0",children:[(0,a.jsx)("div",{className:`w-2 h-2 rounded-full shrink-0 mt-1.5 ${h?"bg-blue-500":"delivered"===u.status||"opened"===u.status?"bg-green-500":"sent"===u.status?"bg-blue-500":"bg-red-500"}`}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 mb-1",children:(0,a.jsx)("span",{className:`text-xs font-medium px-2 py-0.5 rounded ${h?"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400":"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400"}`,children:h?"Inbound":"Outbound"})}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:u.subject}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["From:"," ",(0,a.jsx)("span",{className:"font-medium",children:u.fromName})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:new Date(u.sentAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})})]})]})}),!h&&(0,a.jsxs)("div",{className:"flex items-center gap-1.5 pl-4",children:["opened"===u.status&&(0,a.jsxs)("span",{className:"text-xs text-purple-600 dark:text-purple-400 flex items-center gap-1",children:[(0,a.jsxs)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Opened"]}),"delivered"===u.status&&(0,a.jsxs)("span",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1",children:[(0,a.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"Delivered"]}),"sent"===u.status&&(0,a.jsxs)("span",{className:"text-xs text-blue-600 dark:text-blue-400 flex items-center gap-1",children:[(0,a.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Sent"]}),"bounced"===u.status&&(0,a.jsxs)("span",{className:"text-xs text-red-600 dark:text-red-400 flex items-center gap-1",children:[(0,a.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Bounced"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:()=>g(!p),className:"flex items-center gap-2 text-xs text-primary hover:text-primary/80 font-medium transition-colors w-full pl-4",children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tr.default,{className:"w-3 h-3"}),"Hide message"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ts.ChevronDown,{className:"w-3 h-3"}),"Show message"]})}),p&&(0,a.jsx)("div",{className:"mt-3 pl-4",children:(0,a.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-3 text-xs text-gray-700 dark:text-gray-300 whitespace-pre-wrap border border-gray-200 dark:border-gray-700",children:u.messageBody||u.textBody||u.messagePreview||"No message content"})})]}),l.length>1&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 italic pl-4 pt-2 border-t border-gray-200 dark:border-gray-700",children:[l.length-1," earlier message",l.length-1!=1?"s":""]})]})):(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:"You haven't sent any client communications yet"})})]}),(0,a.jsxs)(x.StyledCard,{children:[(0,a.jsx)(x.StyledCardHeader,{children:(0,a.jsx)(x.StyledCardTitle,{className:"text-lg",children:"Billing summary"})}),(0,a.jsx)(x.StyledCardContent,{className:"space-y-4",children:c&&c.length>0?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total invoices"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:c.length})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total billed"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["$",c.reduce((e,t)=>e+t.total,0).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Outstanding"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["$",c.filter(e=>"paid"!==e.status).reduce((e,t)=>e+t.total,0).toLocaleString()]})]})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center text-center py-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center mb-3",children:(0,a.jsx)(d,{className:"h-6 w-6 text-gray-400"})}),(0,a.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"No billing history"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This client hasn't been billed yet"})]})})]})]})}function tn({isEditing:e,notes:t,onNotesChange:s}){return(0,a.jsxs)(x.StyledCard,{children:[(0,a.jsxs)(x.StyledCardHeader,{children:[(0,a.jsx)(x.StyledCardTitle,{className:"text-lg",children:"Client notes"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Internal notes visible only to your team"})]}),(0,a.jsx)(x.StyledCardContent,{children:e?(0,a.jsx)("textarea",{className:"w-full min-h-[100px] px-3 py-2 bg-gray-50 dark:bg-white/5 border border-gray-300 dark:border-white/10 rounded-md text-gray-900 dark:text-white",value:t,onChange:e=>s(e.target.value)}):t?(0,a.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-4 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-gray-900 dark:text-white whitespace-pre-wrap",children:t})}):(0,a.jsx)("div",{className:"text-center py-6",children:(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:"No notes added for this client yet"})})})]})}var tl=e.i(99211);function to({client:e,isEditing:t,tags:s,onTagsChange:r}){let i=(0,n.useToast)(),[l,c]=(0,o.useState)([]);return(0,o.useEffect)(()=>{c(s?s.split(/,\s*/).filter(Boolean):e.tags||[])},[s,e.tags]),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(x.StyledCard,{children:[(0,a.jsx)(x.StyledCardHeader,{children:(0,a.jsx)(x.StyledCardTitle,{className:"text-xl",children:"Tags"})}),(0,a.jsxs)(x.StyledCardContent,{children:[(0,a.jsx)(tl.StyledTagsInput,{tags:l,setTags:e=>{let t="function"==typeof e?e(l):e;c(t),r(t.join(", "))},onTagAdded:e=>{i.success("Tag Added",`"${e}" has been added to this client.`)},onTagRemoved:e=>{i.success("Tag Removed",`"${e}" has been removed from this client.`)},placeholder:"Type a tag and press Enter or comma...",disabled:!t}),!t&&0===l.length&&(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic mt-3",children:"This client has no tags. Click Edit to add tags."})]})]}),e.servicesNeeded&&e.servicesNeeded.length>0&&(0,a.jsxs)(x.StyledCard,{children:[(0,a.jsx)(x.StyledCardHeader,{children:(0,a.jsx)(x.StyledCardTitle,{className:"text-xl",children:"Services needed"})}),(0,a.jsx)(x.StyledCardContent,{children:(0,a.jsx)("div",{className:"space-y-2",children:e.servicesNeeded.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,a.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:e})]},t))})})]})]})}var tc=e.i(222462);function td(){let e,t=(0,s.useParams)();(0,s.useRouter)();let x=t.clientId,h=(0,n.useToast)(),p=(0,r.useMutation)(i.api.clients.update),[g,y]=(0,o.useState)(!1),[f,j]=(0,o.useState)(!1),[b,N]=(0,o.useState)(!1),[v,w]=(0,o.useState)("new"),[k,T]=(0,o.useState)("details"),[E,L]=(0,o.useState)({industry:"",companyDescription:"",status:"lead",category:"",clientSize:"",priorityLevel:"",projectDimensions:"",communicationPreference:"",tags:"",notes:""}),I=(0,r.useQuery)(i.api.clients.get,{id:x}),D=(0,r.useQuery)(i.api.clientContacts.listByClient,{clientId:x}),P=(0,r.useQuery)(i.api.clientProperties.listByClient,{clientId:x}),M=(0,r.useQuery)(i.api.clientContacts.getPrimaryContact,{clientId:x}),R=(0,r.useQuery)(i.api.quotes.list,{clientId:x}),O=(0,r.useQuery)(i.api.projects.list,{clientId:x}),z=(0,r.useQuery)(i.api.invoices.list,{clientId:x}),B=(0,r.useQuery)(i.api.tasks.list,{clientId:x}),H=(0,r.useQuery)(i.api.emailMessages.listByClient,{clientId:x});(0,o.useEffect)(()=>{I&&L({industry:I.industry||"",companyDescription:I.companyDescription||"",status:I.status,category:I.category||"",clientSize:I.clientSize||"",priorityLevel:I.priorityLevel||"",projectDimensions:I.projectDimensions||"",communicationPreference:I.communicationPreference||"",tags:(I.tags||[]).join(", "),notes:I.notes||""})},[I]);let U=(0,o.useMemo)(()=>!!I&&((E.industry||"")!==(I.industry||"")||(E.companyDescription||"")!==(I.companyDescription||"")||E.status!==I.status||(E.category||"")!==(I.category||"")||(E.clientSize||"")!==(I.clientSize||"")||(E.priorityLevel||"")!==(I.priorityLevel||"")||(E.projectDimensions||"")!==(I.projectDimensions||"")||(E.communicationPreference||"")!==(I.communicationPreference||"")||(E.tags||"")!==(I.tags||[]).join(", ")||(E.notes||"")!==(I.notes||"")),[E,I]),F=async()=>{if(!I)return;let e={};if((E.industry||"")!==(I.industry||"")&&(e.industry=E.industry||void 0),(E.companyDescription||"")!==(I.companyDescription||"")&&(e.companyDescription=E.companyDescription||void 0),E.status!==I.status&&(e.status=E.status),(E.category||"")!==(I.category||"")&&(e.category=E.category||void 0),(E.clientSize||"")!==(I.clientSize||"")&&(e.clientSize=E.clientSize||void 0),(E.priorityLevel||"")!==(I.priorityLevel||"")&&(e.priorityLevel=E.priorityLevel||void 0),(E.projectDimensions||"")!==(I.projectDimensions||"")&&(e.projectDimensions=E.projectDimensions||void 0),(E.communicationPreference||"")!==(I.communicationPreference||"")&&(e.communicationPreference=E.communicationPreference||void 0),(E.tags||"")!==(I.tags||[]).join(", ")&&(e.tags=E.tags?E.tags.split(/,\s*/).filter(Boolean):void 0),(E.notes||"")!==(I.notes||"")&&(e.notes=E.notes||void 0),0===Object.keys(e).length)return void y(!1);try{await p({id:x,...e}),h.success("Client Updated","Your changes have been saved."),y(!1)}catch(t){let e=t instanceof Error?t.message:"Failed to save changes";h.error("Error",e)}};return void 0===I||void 0===D||void 0===P||void 0===M||void 0===R||void 0===O||void 0===z||void 0===B||void 0===H?(0,a.jsx)("div",{className:"relative px-6 pt-8 pb-20",children:(0,a.jsx)("div",{className:"mx-auto",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(l.Skeleton,{className:"h-12 w-64"}),(0,a.jsx)(l.Skeleton,{className:"h-32 w-full"}),(0,a.jsx)(l.Skeleton,{className:"h-64 w-full"}),(0,a.jsx)(l.Skeleton,{className:"h-64 w-full"})]})})}):I?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"relative min-h-screen p-6 pb-20",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(e7,{client:I,clientId:x,isEditing:g,onEditClick:()=>y(!0),statusValue:E.status,onStatusChange:e=>L(t=>({...t,status:e})),emailCount:H?.length||0,projects:O,quotes:R,invoices:z,tasks:B,onTaskSheetOpen:()=>j(!0)}),(0,a.jsxs)(tc.StyledTabs,{value:k,onValueChange:T,children:[(0,a.jsxs)(tc.StyledTabsList,{children:[(0,a.jsx)(tc.StyledTabsTrigger,{value:"details",children:"Client Details"}),(0,a.jsx)(tc.StyledTabsTrigger,{value:"properties",children:"Properties & Contacts"}),(0,a.jsx)(tc.StyledTabsTrigger,{value:"communication",children:"Internal Team Communication"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-6",children:[(0,a.jsxs)("div",{className:"xl:col-span-3",children:[(0,a.jsxs)(tc.StyledTabsContent,{value:"details",className:"space-y-6 mt-0",children:[(0,a.jsx)(ta,{client:I,isEditing:g,form:{industry:E.industry,companyDescription:E.companyDescription,category:E.category,clientSize:E.clientSize,priorityLevel:E.priorityLevel,projectDimensions:E.projectDimensions},onFormChange:(e,t)=>L(a=>({...a,[e]:t}))}),(0,a.jsx)(to,{client:I,isEditing:g,tags:E.tags,onTagsChange:e=>L(t=>({...t,tags:e}))}),(0,a.jsx)(tn,{isEditing:g,notes:E.notes,onNotesChange:e=>L(t=>({...t,notes:e}))})]}),(0,a.jsxs)(tc.StyledTabsContent,{value:"properties",className:"space-y-6 mt-0",children:[(0,a.jsx)(C,{clientId:x,properties:P||[],onChange:()=>{}}),(0,a.jsx)(S,{clientId:x,contacts:D||[],onChange:()=>{}})]}),(0,a.jsx)(tc.StyledTabsContent,{value:"communication",className:"mt-0",children:(0,a.jsx)(A.MentionSection,{entityType:"client",entityId:x,entityName:I.companyName})})]}),(0,a.jsx)("div",{className:"xl:col-span-1",children:(0,a.jsx)("div",{className:"sticky top-24",children:(0,a.jsx)(ti,{client:I,primaryContact:M,isEditing:g,form:{communicationPreference:E.communicationPreference},onFormChange:(e,t)=>L(a=>({...a,[e]:t})),clientEmails:H,invoices:z})})})]})]})]})}),(0,a.jsx)(eU,{isOpen:b,onOpenChange:N,clientId:x,mode:v,onComplete:()=>{N(!1)}}),(0,a.jsx)(u.StickyFormFooter,{buttons:((e=[]).push({label:"Save",onClick:F,intent:"primary",disabled:!U,icon:(0,a.jsx)(m.Check,{className:"h-4 w-4"})}),g&&e.push({label:"Cancel",onClick:()=>{y(!1),L({industry:I?.industry||"",companyDescription:I?.companyDescription||"",status:I?.status||"lead",category:I?.category||"",clientSize:I?.clientSize||"",priorityLevel:I?.priorityLevel||"",projectDimensions:I?.projectDimensions||"",communicationPreference:I?.communicationPreference||"",tags:(I?.tags||[]).join(", "),notes:I?.notes||""})},intent:"outline"}),M?.email&&!g&&e.push({label:"Send Email",onClick:()=>{w("new"),N(!0)},intent:"secondary",icon:(0,a.jsx)(d,{className:"h-4 w-4"}),position:"right"}),e),hasUnsavedChanges:U,isEditing:g}),(0,a.jsx)(_.TaskSheet,{isOpen:f,onOpenChange:j,initialValues:{clientId:x}})]}):(0,a.jsx)("div",{className:"relative px-6 pt-8 pb-20",children:(0,a.jsx)("div",{className:"mx-auto",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-lg flex items-center justify-center mb-4",children:(0,a.jsx)(c,{className:"h-8 w-8 text-red-600 dark:text-red-400"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Client not found"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"The client you're looking for doesn't exist or you don't have permission to view it."})]})})})}e.s(["default",()=>td],743608)}]);